2025-03-19 16:59:25,116 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-19 16:59:25,118 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-19 16:59:25,119 - INFO - Started reloader process [3664] using WatchFiles
2025-03-19 16:59:26,982 - INFO - Started server process [9340]
2025-03-19 16:59:26,984 - INFO - Waiting for application startup.
2025-03-19 16:59:26,997 - INFO - Application startup complete.
2025-03-19 16:59:38,514 - INFO - MUSEEEEEEEE2: False
2025-03-19 16:59:38,584 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-19 16:59:38,592 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-19 16:59:38,603 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-19 17:00:26,556 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:00:26,627 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:00:28,741 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:00:28,819 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-19 17:00:28,824 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:00:28,825 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:00:28,825 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:00:28,894 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:00:28,959 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-19 17:00:28,965 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-19 17:00:28,970 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-19 17:00:29,071 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-19 17:00:31,844 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:00:31,855 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:00:35,119 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:00:35,131 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:07:19,436 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:07:19,445 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:07:28,626 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:07:28,633 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:07:32,425 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:07:32,482 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:07:56,564 - INFO - Shutting down
2025-03-19 17:07:56,672 - INFO - Waiting for application shutdown.
2025-03-19 17:07:56,673 - INFO - Monitoring task cancelled. Exiting...
2025-03-19 17:07:56,673 - INFO - Application shutdown complete.
2025-03-19 17:07:56,674 - INFO - Finished server process [9340]
2025-03-19 17:07:56,784 - INFO - Stopping reloader process [3664]
2025-03-19 17:08:03,294 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-19 17:08:03,295 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-19 17:08:03,296 - INFO - Started reloader process [21292] using WatchFiles
2025-03-19 17:08:05,203 - INFO - Started server process [3604]
2025-03-19 17:08:05,206 - INFO - Waiting for application startup.
2025-03-19 17:08:05,219 - INFO - Application startup complete.
2025-03-19 17:08:59,630 - INFO - 1 change detected
2025-03-19 17:08:59,631 - WARNING - WatchFiles detected changes in 'auth.py'. Reloading...
2025-03-19 17:09:26,257 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:09:26,432 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:09:26,545 - INFO - Shutting down
2025-03-19 17:09:26,651 - INFO - Waiting for application shutdown.
2025-03-19 17:09:26,652 - INFO - Monitoring task cancelled. Exiting...
2025-03-19 17:09:26,652 - INFO - Application shutdown complete.
2025-03-19 17:09:26,653 - INFO - Finished server process [3604]
2025-03-19 17:09:27,231 - INFO - 2 changes detected
2025-03-19 17:09:27,231 - WARNING - WatchFiles detected changes in 'auth.py'. Reloading...
2025-03-19 17:09:28,854 - INFO - 6 changes detected
2025-03-19 17:09:30,018 - INFO - 1 change detected
2025-03-19 17:09:30,371 - INFO - 1 change detected
2025-03-19 17:09:30,729 - INFO - 1 change detected
2025-03-19 17:09:31,085 - INFO - 1 change detected
2025-03-19 17:09:31,442 - INFO - 1 change detected
2025-03-19 17:09:31,800 - INFO - 1 change detected
2025-03-19 17:09:32,158 - INFO - 1 change detected
2025-03-19 17:09:32,520 - INFO - 1 change detected
2025-03-19 17:09:32,879 - INFO - 1 change detected
2025-03-19 17:09:33,238 - INFO - 1 change detected
2025-03-19 17:09:33,597 - INFO - 1 change detected
2025-03-19 17:09:33,958 - INFO - 1 change detected
2025-03-19 17:09:34,320 - INFO - 1 change detected
2025-03-19 17:09:34,678 - INFO - 1 change detected
2025-03-19 17:09:35,033 - INFO - 1 change detected
2025-03-19 17:09:35,392 - INFO - 1 change detected
2025-03-19 17:09:35,750 - INFO - 1 change detected
2025-03-19 17:09:36,111 - INFO - 1 change detected
2025-03-19 17:09:36,470 - INFO - 1 change detected
2025-03-19 17:09:36,829 - INFO - 1 change detected
2025-03-19 17:09:37,192 - INFO - 1 change detected
2025-03-19 17:09:37,555 - INFO - 1 change detected
2025-03-19 17:09:37,914 - INFO - 1 change detected
2025-03-19 17:09:38,272 - INFO - 1 change detected
2025-03-19 17:09:38,633 - INFO - 1 change detected
2025-03-19 17:09:38,997 - INFO - 1 change detected
2025-03-19 17:09:39,354 - INFO - 1 change detected
2025-03-19 17:09:39,717 - INFO - 1 change detected
2025-03-19 17:09:40,075 - INFO - 1 change detected
2025-03-19 17:09:40,434 - INFO - 1 change detected
2025-03-19 17:09:40,792 - INFO - 1 change detected
2025-03-19 17:09:41,154 - INFO - 1 change detected
2025-03-19 17:09:41,520 - INFO - 1 change detected
2025-03-19 17:09:41,881 - INFO - 1 change detected
2025-03-19 17:09:42,240 - INFO - 1 change detected
2025-03-19 17:09:42,600 - INFO - 1 change detected
2025-03-19 17:09:42,959 - INFO - 1 change detected
2025-03-19 17:09:43,316 - INFO - 1 change detected
2025-03-19 17:09:43,677 - INFO - 1 change detected
2025-03-19 17:09:44,035 - INFO - 1 change detected
2025-03-19 17:09:44,392 - INFO - 1 change detected
2025-03-19 17:09:44,748 - INFO - 1 change detected
2025-03-19 17:09:45,108 - INFO - 1 change detected
2025-03-19 17:09:45,464 - INFO - 1 change detected
2025-03-19 17:09:45,822 - INFO - 1 change detected
2025-03-19 17:09:46,180 - INFO - 1 change detected
2025-03-19 17:09:46,534 - INFO - 1 change detected
2025-03-19 17:09:46,892 - INFO - 1 change detected
2025-03-19 17:09:47,250 - INFO - 1 change detected
2025-03-19 17:09:47,610 - INFO - 1 change detected
2025-03-19 17:09:47,967 - INFO - 1 change detected
2025-03-19 17:09:48,326 - INFO - 1 change detected
2025-03-19 17:09:48,685 - INFO - 1 change detected
2025-03-19 17:09:49,046 - INFO - 1 change detected
2025-03-19 17:09:49,407 - INFO - 1 change detected
2025-03-19 17:09:49,764 - INFO - 1 change detected
2025-03-19 17:09:50,129 - INFO - 1 change detected
2025-03-19 17:09:50,490 - INFO - 1 change detected
2025-03-19 17:09:50,847 - INFO - 1 change detected
2025-03-19 17:09:51,205 - INFO - 1 change detected
2025-03-19 17:09:51,563 - INFO - 1 change detected
2025-03-19 17:09:51,919 - INFO - 1 change detected
2025-03-19 17:09:52,280 - INFO - 1 change detected
2025-03-19 17:09:52,643 - INFO - 1 change detected
2025-03-19 17:09:53,003 - INFO - 1 change detected
2025-03-19 17:09:53,362 - INFO - 1 change detected
2025-03-19 17:09:53,722 - INFO - 1 change detected
2025-03-19 17:09:54,078 - INFO - 1 change detected
2025-03-19 17:09:54,440 - INFO - 1 change detected
2025-03-19 17:09:54,803 - INFO - 1 change detected
2025-03-19 17:09:55,163 - INFO - 1 change detected
2025-03-19 17:09:55,521 - INFO - 1 change detected
2025-03-19 17:09:55,877 - INFO - 1 change detected
2025-03-19 17:09:56,234 - INFO - 1 change detected
2025-03-19 17:09:56,591 - INFO - 1 change detected
2025-03-19 17:09:56,947 - INFO - 1 change detected
2025-03-19 17:09:57,301 - INFO - 1 change detected
2025-03-19 17:09:57,659 - INFO - 1 change detected
2025-03-19 17:09:58,019 - INFO - 1 change detected
2025-03-19 17:09:58,376 - INFO - 1 change detected
2025-03-19 17:09:58,734 - INFO - 1 change detected
2025-03-19 17:09:59,091 - INFO - 1 change detected
2025-03-19 17:09:59,451 - INFO - 1 change detected
2025-03-19 17:09:59,810 - INFO - 1 change detected
2025-03-19 17:10:00,169 - INFO - 1 change detected
2025-03-19 17:10:00,531 - INFO - 1 change detected
2025-03-19 17:10:00,892 - INFO - 1 change detected
2025-03-19 17:10:01,250 - INFO - 1 change detected
2025-03-19 17:10:01,609 - INFO - 1 change detected
2025-03-19 17:10:01,968 - INFO - 1 change detected
2025-03-19 17:10:02,328 - INFO - 1 change detected
2025-03-19 17:10:02,685 - INFO - 1 change detected
2025-03-19 17:10:03,044 - INFO - 1 change detected
2025-03-19 17:10:03,402 - INFO - 1 change detected
2025-03-19 17:10:03,763 - INFO - 1 change detected
2025-03-19 17:10:04,118 - INFO - 1 change detected
2025-03-19 17:10:04,477 - INFO - 1 change detected
2025-03-19 17:10:04,838 - INFO - 1 change detected
2025-03-19 17:10:05,196 - INFO - 1 change detected
2025-03-19 17:10:05,554 - INFO - 1 change detected
2025-03-19 17:10:05,910 - INFO - 1 change detected
2025-03-19 17:10:06,269 - INFO - 1 change detected
2025-03-19 17:10:06,627 - INFO - 1 change detected
2025-03-19 17:10:06,981 - INFO - 1 change detected
2025-03-19 17:10:07,337 - INFO - 1 change detected
2025-03-19 17:10:07,692 - INFO - 1 change detected
2025-03-19 17:10:08,046 - INFO - 1 change detected
2025-03-19 17:10:08,555 - INFO - 1 change detected
2025-03-19 17:10:08,917 - INFO - 1 change detected
2025-03-19 17:10:09,271 - INFO - 1 change detected
2025-03-19 17:10:09,631 - INFO - 1 change detected
2025-03-19 17:10:09,991 - INFO - 1 change detected
2025-03-19 17:10:10,352 - INFO - 1 change detected
2025-03-19 17:10:10,709 - INFO - 1 change detected
2025-03-19 17:10:11,068 - INFO - 1 change detected
2025-03-19 17:10:11,427 - INFO - 1 change detected
2025-03-19 17:10:11,785 - INFO - 1 change detected
2025-03-19 17:10:12,142 - INFO - 1 change detected
2025-03-19 17:10:12,500 - INFO - 1 change detected
2025-03-19 17:10:12,859 - INFO - 1 change detected
2025-03-19 17:10:13,218 - INFO - 1 change detected
2025-03-19 17:10:13,576 - INFO - 1 change detected
2025-03-19 17:10:13,934 - INFO - 1 change detected
2025-03-19 17:10:14,294 - INFO - 1 change detected
2025-03-19 17:10:14,650 - INFO - 1 change detected
2025-03-19 17:10:15,010 - INFO - 1 change detected
2025-03-19 17:10:15,372 - INFO - 1 change detected
2025-03-19 17:10:15,735 - INFO - 1 change detected
2025-03-19 17:10:16,095 - INFO - 1 change detected
2025-03-19 17:10:16,453 - INFO - 1 change detected
2025-03-19 17:10:16,811 - INFO - 1 change detected
2025-03-19 17:10:17,171 - INFO - 1 change detected
2025-03-19 17:10:17,531 - INFO - 1 change detected
2025-03-19 17:10:17,888 - INFO - 1 change detected
2025-03-19 17:10:18,248 - INFO - 1 change detected
2025-03-19 17:10:18,604 - INFO - 1 change detected
2025-03-19 17:10:18,961 - INFO - 1 change detected
2025-03-19 17:10:19,320 - INFO - 1 change detected
2025-03-19 17:10:19,678 - INFO - 1 change detected
2025-03-19 17:10:20,036 - INFO - 1 change detected
2025-03-19 17:10:20,394 - INFO - 1 change detected
2025-03-19 17:10:20,752 - INFO - 1 change detected
2025-03-19 17:10:21,109 - INFO - 1 change detected
2025-03-19 17:10:21,470 - INFO - 1 change detected
2025-03-19 17:10:21,827 - INFO - 1 change detected
2025-03-19 17:10:22,185 - INFO - 1 change detected
2025-03-19 17:10:22,542 - INFO - 1 change detected
2025-03-19 17:10:22,903 - INFO - 1 change detected
2025-03-19 17:10:23,259 - INFO - 1 change detected
2025-03-19 17:10:23,618 - INFO - 1 change detected
2025-03-19 17:10:23,973 - INFO - 1 change detected
2025-03-19 17:10:24,336 - INFO - 1 change detected
2025-03-19 17:10:24,694 - INFO - 1 change detected
2025-03-19 17:10:25,049 - INFO - 1 change detected
2025-03-19 17:10:25,408 - INFO - 1 change detected
2025-03-19 17:10:25,762 - INFO - 1 change detected
2025-03-19 17:10:26,117 - INFO - 1 change detected
2025-03-19 17:10:26,472 - INFO - 1 change detected
2025-03-19 17:10:26,829 - INFO - 1 change detected
2025-03-19 17:10:27,185 - INFO - 1 change detected
2025-03-19 17:10:27,542 - INFO - 1 change detected
2025-03-19 17:10:27,900 - INFO - 1 change detected
2025-03-19 17:10:28,255 - INFO - 1 change detected
2025-03-19 17:10:28,614 - INFO - 1 change detected
2025-03-19 17:10:28,974 - INFO - 1 change detected
2025-03-19 17:10:29,330 - INFO - 1 change detected
2025-03-19 17:10:29,690 - INFO - 1 change detected
2025-03-19 17:10:30,047 - INFO - 1 change detected
2025-03-19 17:10:30,404 - INFO - 1 change detected
2025-03-19 17:10:30,762 - INFO - 1 change detected
2025-03-19 17:10:31,118 - INFO - 1 change detected
2025-03-19 17:10:31,477 - INFO - 1 change detected
2025-03-19 17:10:31,836 - INFO - 1 change detected
2025-03-19 17:10:32,194 - INFO - 1 change detected
2025-03-19 17:10:32,554 - INFO - 1 change detected
2025-03-19 17:10:32,910 - INFO - 1 change detected
2025-03-19 17:10:33,268 - INFO - 1 change detected
2025-03-19 17:10:33,628 - INFO - 1 change detected
2025-03-19 17:10:33,987 - INFO - 1 change detected
2025-03-19 17:10:34,342 - INFO - 1 change detected
2025-03-19 17:10:34,701 - INFO - 1 change detected
2025-03-19 17:10:35,058 - INFO - 1 change detected
2025-03-19 17:10:35,422 - INFO - 1 change detected
2025-03-19 17:10:35,781 - INFO - 1 change detected
2025-03-19 17:10:36,142 - INFO - 1 change detected
2025-03-19 17:10:36,500 - INFO - 1 change detected
2025-03-19 17:10:36,860 - INFO - 1 change detected
2025-03-19 17:10:37,216 - INFO - 1 change detected
2025-03-19 17:10:37,577 - INFO - 1 change detected
2025-03-19 17:10:37,937 - INFO - 1 change detected
2025-03-19 17:10:38,296 - INFO - 1 change detected
2025-03-19 17:10:38,656 - INFO - 1 change detected
2025-03-19 17:10:39,015 - INFO - 1 change detected
2025-03-19 17:10:39,373 - INFO - 1 change detected
2025-03-19 17:10:39,727 - INFO - 1 change detected
2025-03-19 17:10:40,086 - INFO - 1 change detected
2025-03-19 17:10:40,442 - INFO - 1 change detected
2025-03-19 17:10:40,801 - INFO - 1 change detected
2025-03-19 17:10:41,158 - INFO - 1 change detected
2025-03-19 17:10:41,517 - INFO - 1 change detected
2025-03-19 17:10:41,878 - INFO - 1 change detected
2025-03-19 17:10:42,235 - INFO - 1 change detected
2025-03-19 17:10:42,593 - INFO - 1 change detected
2025-03-19 17:10:42,949 - INFO - 1 change detected
2025-03-19 17:10:43,308 - INFO - 1 change detected
2025-03-19 17:10:43,664 - INFO - 1 change detected
2025-03-19 17:10:44,026 - INFO - 1 change detected
2025-03-19 17:10:44,383 - INFO - 1 change detected
2025-03-19 17:10:44,741 - INFO - 1 change detected
2025-03-19 17:10:45,098 - INFO - 1 change detected
2025-03-19 17:10:45,456 - INFO - 1 change detected
2025-03-19 17:10:45,815 - INFO - 1 change detected
2025-03-19 17:10:46,177 - INFO - 1 change detected
2025-03-19 17:10:46,535 - INFO - 1 change detected
2025-03-19 17:10:46,890 - INFO - 1 change detected
2025-03-19 17:10:47,249 - INFO - 1 change detected
2025-03-19 17:10:47,608 - INFO - 1 change detected
2025-03-19 17:10:47,970 - INFO - 1 change detected
2025-03-19 17:10:48,323 - INFO - 1 change detected
2025-03-19 17:10:48,679 - INFO - 1 change detected
2025-03-19 17:10:49,036 - INFO - 1 change detected
2025-03-19 17:10:49,394 - INFO - 1 change detected
2025-03-19 17:10:49,750 - INFO - 1 change detected
2025-03-19 17:10:50,110 - INFO - 1 change detected
2025-03-19 17:10:50,469 - INFO - 1 change detected
2025-03-19 17:10:50,826 - INFO - 1 change detected
2025-03-19 17:10:51,184 - INFO - 1 change detected
2025-03-19 17:10:51,544 - INFO - 1 change detected
2025-03-19 17:10:51,902 - INFO - 1 change detected
2025-03-19 17:10:52,263 - INFO - 1 change detected
2025-03-19 17:10:52,621 - INFO - 1 change detected
2025-03-19 17:10:52,980 - INFO - 1 change detected
2025-03-19 17:10:53,338 - INFO - 1 change detected
2025-03-19 17:10:53,694 - INFO - 1 change detected
2025-03-19 17:10:54,055 - INFO - 1 change detected
2025-03-19 17:10:54,412 - INFO - 1 change detected
2025-03-19 17:10:54,770 - INFO - 1 change detected
2025-03-19 17:10:55,130 - INFO - 1 change detected
2025-03-19 17:10:55,486 - INFO - 1 change detected
2025-03-19 17:10:55,842 - INFO - 1 change detected
2025-03-19 17:10:56,204 - INFO - 1 change detected
2025-03-19 17:10:56,561 - INFO - 1 change detected
2025-03-19 17:10:56,918 - INFO - 1 change detected
2025-03-19 17:10:57,282 - INFO - 1 change detected
2025-03-19 17:10:57,643 - INFO - 1 change detected
2025-03-19 17:10:58,004 - INFO - 1 change detected
2025-03-19 17:10:58,360 - INFO - 1 change detected
2025-03-19 17:10:58,719 - INFO - 1 change detected
2025-03-19 17:10:59,078 - INFO - 1 change detected
2025-03-19 17:10:59,437 - INFO - 1 change detected
2025-03-19 17:10:59,794 - INFO - 1 change detected
2025-03-19 17:11:00,149 - INFO - 1 change detected
2025-03-19 17:11:00,507 - INFO - 1 change detected
2025-03-19 17:11:00,862 - INFO - 1 change detected
2025-03-19 17:11:01,217 - INFO - 1 change detected
2025-03-19 17:11:01,573 - INFO - 1 change detected
2025-03-19 17:11:01,935 - INFO - 1 change detected
2025-03-19 17:11:02,293 - INFO - 1 change detected
2025-03-19 17:11:02,652 - INFO - 1 change detected
2025-03-19 17:11:03,012 - INFO - 1 change detected
2025-03-19 17:11:03,369 - INFO - 1 change detected
2025-03-19 17:11:03,728 - INFO - 1 change detected
2025-03-19 17:11:04,088 - INFO - 1 change detected
2025-03-19 17:11:04,450 - INFO - 1 change detected
2025-03-19 17:11:04,806 - INFO - 1 change detected
2025-03-19 17:11:05,166 - INFO - 1 change detected
2025-03-19 17:11:05,525 - INFO - 1 change detected
2025-03-19 17:11:05,887 - INFO - 1 change detected
2025-03-19 17:11:06,245 - INFO - 1 change detected
2025-03-19 17:11:06,602 - INFO - 1 change detected
2025-03-19 17:11:06,962 - INFO - 1 change detected
2025-03-19 17:11:07,321 - INFO - 1 change detected
2025-03-19 17:11:07,677 - INFO - 1 change detected
2025-03-19 17:11:08,038 - INFO - 1 change detected
2025-03-19 17:11:08,401 - INFO - 1 change detected
2025-03-19 17:11:08,761 - INFO - 1 change detected
2025-03-19 17:11:09,117 - INFO - 1 change detected
2025-03-19 17:11:09,476 - INFO - 1 change detected
2025-03-19 17:11:09,832 - INFO - 1 change detected
2025-03-19 17:11:10,193 - INFO - 1 change detected
2025-03-19 17:11:10,553 - INFO - 1 change detected
2025-03-19 17:11:10,911 - INFO - 1 change detected
2025-03-19 17:11:11,270 - INFO - 1 change detected
2025-03-19 17:11:11,629 - INFO - 1 change detected
2025-03-19 17:11:11,987 - INFO - 1 change detected
2025-03-19 17:11:12,345 - INFO - 1 change detected
2025-03-19 17:11:12,704 - INFO - 1 change detected
2025-03-19 17:11:13,063 - INFO - 1 change detected
2025-03-19 17:11:13,422 - INFO - 1 change detected
2025-03-19 17:11:13,782 - INFO - 1 change detected
2025-03-19 17:11:14,141 - INFO - 1 change detected
2025-03-19 17:11:14,502 - INFO - 1 change detected
2025-03-19 17:11:14,867 - INFO - 1 change detected
2025-03-19 17:11:15,228 - INFO - 1 change detected
2025-03-19 17:11:15,589 - INFO - 1 change detected
2025-03-19 17:11:15,946 - INFO - 1 change detected
2025-03-19 17:11:16,304 - INFO - 1 change detected
2025-03-19 17:11:16,664 - INFO - 1 change detected
2025-03-19 17:11:17,022 - INFO - 1 change detected
2025-03-19 17:11:17,379 - INFO - 1 change detected
2025-03-19 17:11:17,741 - INFO - 1 change detected
2025-03-19 17:11:18,098 - INFO - 1 change detected
2025-03-19 17:11:18,459 - INFO - 1 change detected
2025-03-19 17:11:18,819 - INFO - 1 change detected
2025-03-19 17:11:19,176 - INFO - 1 change detected
2025-03-19 17:11:19,535 - INFO - 1 change detected
2025-03-19 17:11:19,892 - INFO - 1 change detected
2025-03-19 17:11:20,244 - INFO - 1 change detected
2025-03-19 17:11:20,603 - INFO - 1 change detected
2025-03-19 17:11:20,960 - INFO - 1 change detected
2025-03-19 17:11:21,320 - INFO - 1 change detected
2025-03-19 17:11:21,680 - INFO - 1 change detected
2025-03-19 17:11:22,037 - INFO - 1 change detected
2025-03-19 17:11:22,396 - INFO - 1 change detected
2025-03-19 17:11:22,753 - INFO - 1 change detected
2025-03-19 17:11:23,109 - INFO - 1 change detected
2025-03-19 17:11:23,465 - INFO - 1 change detected
2025-03-19 17:11:23,829 - INFO - 1 change detected
2025-03-19 17:11:24,184 - INFO - 1 change detected
2025-03-19 17:11:24,542 - INFO - 1 change detected
2025-03-19 17:11:24,900 - INFO - 1 change detected
2025-03-19 17:11:25,263 - INFO - 1 change detected
2025-03-19 17:11:25,617 - INFO - 1 change detected
2025-03-19 17:11:25,979 - INFO - 1 change detected
2025-03-19 17:11:26,334 - INFO - 1 change detected
2025-03-19 17:11:26,696 - INFO - 1 change detected
2025-03-19 17:11:27,056 - INFO - 1 change detected
2025-03-19 17:11:27,416 - INFO - 1 change detected
2025-03-19 17:11:27,775 - INFO - 1 change detected
2025-03-19 17:11:28,134 - INFO - 1 change detected
2025-03-19 17:11:28,488 - INFO - 1 change detected
2025-03-19 17:11:28,847 - INFO - 1 change detected
2025-03-19 17:11:29,203 - INFO - 1 change detected
2025-03-19 17:11:29,560 - INFO - 1 change detected
2025-03-19 17:11:29,917 - INFO - 1 change detected
2025-03-19 17:11:30,275 - INFO - 1 change detected
2025-03-19 17:11:30,632 - INFO - 1 change detected
2025-03-19 17:11:30,993 - INFO - 1 change detected
2025-03-19 17:11:31,353 - INFO - 1 change detected
2025-03-19 17:11:31,709 - INFO - 1 change detected
2025-03-19 17:11:32,070 - INFO - 1 change detected
2025-03-19 17:11:32,429 - INFO - 1 change detected
2025-03-19 17:11:32,786 - INFO - 1 change detected
2025-03-19 17:11:33,144 - INFO - 1 change detected
2025-03-19 17:11:33,502 - INFO - 1 change detected
2025-03-19 17:11:33,862 - INFO - 1 change detected
2025-03-19 17:11:34,220 - INFO - 1 change detected
2025-03-19 17:11:34,577 - INFO - 1 change detected
2025-03-19 17:11:34,935 - INFO - 1 change detected
2025-03-19 17:11:35,296 - INFO - 1 change detected
2025-03-19 17:11:35,658 - INFO - 1 change detected
2025-03-19 17:11:36,017 - INFO - 1 change detected
2025-03-19 17:11:36,379 - INFO - 1 change detected
2025-03-19 17:11:36,736 - INFO - 1 change detected
2025-03-19 17:11:37,098 - INFO - 1 change detected
2025-03-19 17:11:37,456 - INFO - 1 change detected
2025-03-19 17:11:37,812 - INFO - 1 change detected
2025-03-19 17:11:38,172 - INFO - 1 change detected
2025-03-19 17:11:38,529 - INFO - 1 change detected
2025-03-19 17:11:38,889 - INFO - 1 change detected
2025-03-19 17:11:39,248 - INFO - 1 change detected
2025-03-19 17:11:39,605 - INFO - 1 change detected
2025-03-19 17:11:39,962 - INFO - 1 change detected
2025-03-19 17:11:40,319 - INFO - 1 change detected
2025-03-19 17:11:40,675 - INFO - 1 change detected
2025-03-19 17:11:41,034 - INFO - 1 change detected
2025-03-19 17:11:41,396 - INFO - 1 change detected
2025-03-19 17:11:41,757 - INFO - 1 change detected
2025-03-19 17:11:42,117 - INFO - 1 change detected
2025-03-19 17:11:42,479 - INFO - 1 change detected
2025-03-19 17:11:42,838 - INFO - 1 change detected
2025-03-19 17:11:43,196 - INFO - 1 change detected
2025-03-19 17:11:43,555 - INFO - 1 change detected
2025-03-19 17:11:43,915 - INFO - 1 change detected
2025-03-19 17:11:44,277 - INFO - 1 change detected
2025-03-19 17:11:44,633 - INFO - 1 change detected
2025-03-19 17:11:44,991 - INFO - 1 change detected
2025-03-19 17:11:45,353 - INFO - 1 change detected
2025-03-19 17:11:45,714 - INFO - 1 change detected
2025-03-19 17:11:46,073 - INFO - 1 change detected
2025-03-19 17:11:46,429 - INFO - 1 change detected
2025-03-19 17:11:46,787 - INFO - 1 change detected
2025-03-19 17:11:47,144 - INFO - 1 change detected
2025-03-19 17:11:47,501 - INFO - 1 change detected
2025-03-19 17:11:47,861 - INFO - 1 change detected
2025-03-19 17:11:48,221 - INFO - 1 change detected
2025-03-19 17:11:48,579 - INFO - 1 change detected
2025-03-19 17:11:48,942 - INFO - 1 change detected
2025-03-19 17:11:49,306 - INFO - 1 change detected
2025-03-19 17:11:49,664 - INFO - 1 change detected
2025-03-19 17:11:50,025 - INFO - 1 change detected
2025-03-19 17:11:50,388 - INFO - 1 change detected
2025-03-19 17:11:50,750 - INFO - 1 change detected
2025-03-19 17:11:51,114 - INFO - 1 change detected
2025-03-19 17:11:51,478 - INFO - 1 change detected
2025-03-19 17:11:51,839 - INFO - 1 change detected
2025-03-19 17:11:52,203 - INFO - 1 change detected
2025-03-19 17:11:52,563 - INFO - 1 change detected
2025-03-19 17:11:52,923 - INFO - 1 change detected
2025-03-19 17:11:53,287 - INFO - 1 change detected
2025-03-19 17:11:53,643 - INFO - 1 change detected
2025-03-19 17:11:54,002 - INFO - 1 change detected
2025-03-19 17:11:54,358 - INFO - 1 change detected
2025-03-19 17:11:54,721 - INFO - 1 change detected
2025-03-19 17:11:55,078 - INFO - 1 change detected
2025-03-19 17:11:55,439 - INFO - 1 change detected
2025-03-19 17:11:55,796 - INFO - 1 change detected
2025-03-19 17:11:56,155 - INFO - 1 change detected
2025-03-19 17:11:56,512 - INFO - 1 change detected
2025-03-19 17:11:56,874 - INFO - 1 change detected
2025-03-19 17:11:57,233 - INFO - 1 change detected
2025-03-19 17:11:57,592 - INFO - 1 change detected
2025-03-19 17:11:57,950 - INFO - 1 change detected
2025-03-19 17:11:58,304 - INFO - 1 change detected
2025-03-19 17:11:58,660 - INFO - 1 change detected
2025-03-19 17:11:59,016 - INFO - 1 change detected
2025-03-19 17:11:59,374 - INFO - 1 change detected
2025-03-19 17:11:59,733 - INFO - 1 change detected
2025-03-19 17:12:00,088 - INFO - 1 change detected
2025-03-19 17:12:00,447 - INFO - 1 change detected
2025-03-19 17:12:00,804 - INFO - 1 change detected
2025-03-19 17:12:01,163 - INFO - 1 change detected
2025-03-19 17:12:01,522 - INFO - 1 change detected
2025-03-19 17:12:01,880 - INFO - 1 change detected
2025-03-19 17:12:02,239 - INFO - 1 change detected
2025-03-19 17:12:02,600 - INFO - 1 change detected
2025-03-19 17:12:02,963 - INFO - 1 change detected
2025-03-19 17:12:03,325 - INFO - 1 change detected
2025-03-19 17:12:03,682 - INFO - 1 change detected
2025-03-19 17:12:04,042 - INFO - 1 change detected
2025-03-19 17:12:04,401 - INFO - 1 change detected
2025-03-19 17:12:04,760 - INFO - 1 change detected
2025-03-19 17:12:05,118 - INFO - 1 change detected
2025-03-19 17:12:05,472 - INFO - 1 change detected
2025-03-19 17:12:05,827 - INFO - 1 change detected
2025-03-19 17:12:06,185 - INFO - 1 change detected
2025-03-19 17:12:06,541 - INFO - 1 change detected
2025-03-19 17:12:06,896 - INFO - 1 change detected
2025-03-19 17:12:07,257 - INFO - 1 change detected
2025-03-19 17:12:07,616 - INFO - 1 change detected
2025-03-19 17:12:07,973 - INFO - 1 change detected
2025-03-19 17:12:08,337 - INFO - 1 change detected
2025-03-19 17:12:08,696 - INFO - 1 change detected
2025-03-19 17:12:09,051 - INFO - 1 change detected
2025-03-19 17:12:09,408 - INFO - 1 change detected
2025-03-19 17:12:09,767 - INFO - 1 change detected
2025-03-19 17:12:10,126 - INFO - 1 change detected
2025-03-19 17:12:10,483 - INFO - 1 change detected
2025-03-19 17:12:10,846 - INFO - 1 change detected
2025-03-19 17:12:11,208 - INFO - 1 change detected
2025-03-19 17:12:11,565 - INFO - 1 change detected
2025-03-19 17:12:11,924 - INFO - 1 change detected
2025-03-19 17:12:12,285 - INFO - 1 change detected
2025-03-19 17:12:12,644 - INFO - 1 change detected
2025-03-19 17:12:13,002 - INFO - 1 change detected
2025-03-19 17:12:13,354 - INFO - 1 change detected
2025-03-19 17:12:13,711 - INFO - 1 change detected
2025-03-19 17:12:14,070 - INFO - 1 change detected
2025-03-19 17:12:14,426 - INFO - 1 change detected
2025-03-19 17:12:14,783 - INFO - 1 change detected
2025-03-19 17:12:15,145 - INFO - 1 change detected
2025-03-19 17:12:15,505 - INFO - 1 change detected
2025-03-19 17:12:15,858 - INFO - 1 change detected
2025-03-19 17:12:16,216 - INFO - 1 change detected
2025-03-19 17:12:16,576 - INFO - 1 change detected
2025-03-19 17:12:16,935 - INFO - 1 change detected
2025-03-19 17:12:17,292 - INFO - 1 change detected
2025-03-19 17:12:17,649 - INFO - 1 change detected
2025-03-19 17:12:18,004 - INFO - 1 change detected
2025-03-19 17:12:18,362 - INFO - 1 change detected
2025-03-19 17:12:18,718 - INFO - 1 change detected
2025-03-19 17:12:19,079 - INFO - 1 change detected
2025-03-19 17:12:19,434 - INFO - 1 change detected
2025-03-19 17:12:19,791 - INFO - 1 change detected
2025-03-19 17:12:20,152 - INFO - 1 change detected
2025-03-19 17:12:20,508 - INFO - 1 change detected
2025-03-19 17:12:20,866 - INFO - 1 change detected
2025-03-19 17:12:21,224 - INFO - 1 change detected
2025-03-19 17:12:21,581 - INFO - 1 change detected
2025-03-19 17:12:21,943 - INFO - 1 change detected
2025-03-19 17:12:22,302 - INFO - 1 change detected
2025-03-19 17:12:22,660 - INFO - 1 change detected
2025-03-19 17:12:23,019 - INFO - 1 change detected
2025-03-19 17:12:23,377 - INFO - 1 change detected
2025-03-19 17:12:23,738 - INFO - 1 change detected
2025-03-19 17:12:24,094 - INFO - 1 change detected
2025-03-19 17:12:24,451 - INFO - 1 change detected
2025-03-19 17:12:24,811 - INFO - 1 change detected
2025-03-19 17:12:25,166 - INFO - 1 change detected
2025-03-19 17:12:25,521 - INFO - 1 change detected
2025-03-19 17:12:25,878 - INFO - 1 change detected
2025-03-19 17:12:26,287 - INFO - 1 change detected
2025-03-19 17:12:26,642 - INFO - 1 change detected
2025-03-19 17:12:27,003 - INFO - 1 change detected
2025-03-19 17:12:27,466 - INFO - 1 change detected
2025-03-19 17:12:27,830 - INFO - 1 change detected
2025-03-19 17:12:28,187 - INFO - 1 change detected
2025-03-19 17:12:28,549 - INFO - 1 change detected
2025-03-19 17:12:28,904 - INFO - 1 change detected
2025-03-19 17:12:29,262 - INFO - 1 change detected
2025-03-19 17:12:29,617 - INFO - 1 change detected
2025-03-19 17:12:29,978 - INFO - 1 change detected
2025-03-19 17:12:30,336 - INFO - 1 change detected
2025-03-19 17:12:30,696 - INFO - 1 change detected
2025-03-19 17:12:31,059 - INFO - 1 change detected
2025-03-19 17:12:31,421 - INFO - 1 change detected
2025-03-19 17:12:31,783 - INFO - 1 change detected
2025-03-19 17:12:32,143 - INFO - 1 change detected
2025-03-19 17:12:32,500 - INFO - 1 change detected
2025-03-19 17:12:32,859 - INFO - 1 change detected
2025-03-19 17:12:33,217 - INFO - 1 change detected
2025-03-19 17:12:33,573 - INFO - 1 change detected
2025-03-19 17:12:33,935 - INFO - 1 change detected
2025-03-19 17:12:34,293 - INFO - 1 change detected
2025-03-19 17:12:34,653 - INFO - 1 change detected
2025-03-19 17:12:35,016 - INFO - 1 change detected
2025-03-19 17:12:35,376 - INFO - 1 change detected
2025-03-19 17:12:35,736 - INFO - 1 change detected
2025-03-19 17:12:36,091 - INFO - 1 change detected
2025-03-19 17:12:36,450 - INFO - 1 change detected
2025-03-19 17:12:36,810 - INFO - 1 change detected
2025-03-19 17:12:37,168 - INFO - 1 change detected
2025-03-19 17:12:37,525 - INFO - 1 change detected
2025-03-19 17:12:37,883 - INFO - 1 change detected
2025-03-19 17:12:38,240 - INFO - 1 change detected
2025-03-19 17:12:38,595 - INFO - 1 change detected
2025-03-19 17:12:38,954 - INFO - 1 change detected
2025-03-19 17:12:39,310 - INFO - 1 change detected
2025-03-19 17:12:39,665 - INFO - 1 change detected
2025-03-19 17:12:40,025 - INFO - 1 change detected
2025-03-19 17:12:40,384 - INFO - 1 change detected
2025-03-19 17:12:40,740 - INFO - 1 change detected
2025-03-19 17:12:41,100 - INFO - 1 change detected
2025-03-19 17:12:41,455 - INFO - 1 change detected
2025-03-19 17:12:41,811 - INFO - 1 change detected
2025-03-19 17:12:42,171 - INFO - 1 change detected
2025-03-19 17:12:42,532 - INFO - 1 change detected
2025-03-19 17:12:42,891 - INFO - 1 change detected
2025-03-19 17:12:43,249 - INFO - 1 change detected
2025-03-19 17:12:43,608 - INFO - 1 change detected
2025-03-19 17:12:43,965 - INFO - 1 change detected
2025-03-19 17:12:44,322 - INFO - 1 change detected
2025-03-19 17:12:44,680 - INFO - 1 change detected
2025-03-19 17:12:45,042 - INFO - 1 change detected
2025-03-19 17:12:45,399 - INFO - 1 change detected
2025-03-19 17:12:45,756 - INFO - 1 change detected
2025-03-19 17:12:46,114 - INFO - 1 change detected
2025-03-19 17:12:46,472 - INFO - 1 change detected
2025-03-19 17:12:46,833 - INFO - 1 change detected
2025-03-19 17:12:47,194 - INFO - 1 change detected
2025-03-19 17:12:47,550 - INFO - 1 change detected
2025-03-19 17:12:47,907 - INFO - 1 change detected
2025-03-19 17:12:48,265 - INFO - 1 change detected
2025-03-19 17:12:48,621 - INFO - 1 change detected
2025-03-19 17:12:48,978 - INFO - 1 change detected
2025-03-19 17:12:49,339 - INFO - 1 change detected
2025-03-19 17:12:49,696 - INFO - 1 change detected
2025-03-19 17:12:50,056 - INFO - 1 change detected
2025-03-19 17:12:50,412 - INFO - 1 change detected
2025-03-19 17:12:50,771 - INFO - 1 change detected
2025-03-19 17:12:51,129 - INFO - 1 change detected
2025-03-19 17:12:51,486 - INFO - 1 change detected
2025-03-19 17:12:51,842 - INFO - 1 change detected
2025-03-19 17:12:52,200 - INFO - 1 change detected
2025-03-19 17:12:52,557 - INFO - 1 change detected
2025-03-19 17:12:52,918 - INFO - 1 change detected
2025-03-19 17:12:53,276 - INFO - 1 change detected
2025-03-19 17:12:53,633 - INFO - 1 change detected
2025-03-19 17:12:53,994 - INFO - 1 change detected
2025-03-19 17:12:54,351 - INFO - 1 change detected
2025-03-19 17:12:54,709 - INFO - 1 change detected
2025-03-19 17:12:55,065 - INFO - 1 change detected
2025-03-19 17:12:55,423 - INFO - 1 change detected
2025-03-19 17:12:55,784 - INFO - 1 change detected
2025-03-19 17:12:56,142 - INFO - 1 change detected
2025-03-19 17:12:56,501 - INFO - 1 change detected
2025-03-19 17:12:56,858 - INFO - 1 change detected
2025-03-19 17:12:57,214 - INFO - 1 change detected
2025-03-19 17:12:57,576 - INFO - Stopping reloader process [21292]
2025-03-19 17:24:25,375 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-19 17:24:25,376 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-19 17:24:25,377 - INFO - Started reloader process [21056] using WatchFiles
2025-03-19 17:24:26,825 - INFO - Started server process [21212]
2025-03-19 17:24:26,828 - INFO - Waiting for application startup.
2025-03-19 17:24:26,837 - INFO - Application startup complete.
2025-03-19 17:24:40,991 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:24:41,161 - INFO - Logged request from IP bro 127.0.0.1 to /profile
2025-03-19 17:24:41,235 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:24:41,307 - INFO - Logged request from IP bro 127.0.0.1 to /favicon.ico
2025-03-19 17:25:00,674 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:25:00,846 - INFO - Logged request from IP bro 127.0.0.1 to /docs
2025-03-19 17:25:00,941 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:25:01,110 - INFO - Logged request from IP bro 127.0.0.1 to /openapi.json
2025-03-19 17:25:40,615 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:25:40,620 - INFO - Logged request from IP bro 127.0.0.1 to /docs
2025-03-19 17:25:40,688 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:25:40,694 - INFO - Logged request from IP bro 127.0.0.1 to /openapi.json
2025-03-19 17:25:48,777 - INFO - 1 change detected
2025-03-19 17:25:48,778 - WARNING - WatchFiles detected changes in 'auth.py'. Reloading...
2025-03-19 17:25:50,744 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:25:50,808 - INFO - Logged request from IP bro 127.0.0.1 to /docs
2025-03-19 17:25:50,852 - INFO - Shutting down
2025-03-19 17:25:50,962 - INFO - Waiting for application shutdown.
2025-03-19 17:25:50,963 - INFO - Monitoring task cancelled. Exiting...
2025-03-19 17:25:50,963 - INFO - Application shutdown complete.
2025-03-19 17:25:50,963 - INFO - Finished server process [21212]
2025-03-19 17:25:51,560 - INFO - 1 change detected
2025-03-19 17:25:52,269 - INFO - 5 changes detected
2025-03-19 17:25:52,738 - INFO - Started server process [22588]
2025-03-19 17:25:52,741 - INFO - Waiting for application startup.
2025-03-19 17:25:52,749 - INFO - Application startup complete.
2025-03-19 17:25:52,755 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:25:52,933 - INFO - Logged request from IP bro 127.0.0.1 to /openapi.json
2025-03-19 17:26:00,577 - INFO - 1 change detected
2025-03-19 17:26:00,577 - WARNING - WatchFiles detected changes in 'auth.py'. Reloading...
2025-03-19 17:26:01,680 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:26:01,745 - INFO - Logged request from IP bro 127.0.0.1 to /docs
2025-03-19 17:26:01,789 - INFO - Shutting down
2025-03-19 17:26:01,899 - INFO - Waiting for application shutdown.
2025-03-19 17:26:01,899 - INFO - Monitoring task cancelled. Exiting...
2025-03-19 17:26:01,900 - INFO - Application shutdown complete.
2025-03-19 17:26:01,900 - INFO - Finished server process [22588]
2025-03-19 17:26:02,495 - INFO - 1 change detected
2025-03-19 17:26:03,150 - INFO - 5 changes detected
2025-03-19 17:26:03,587 - INFO - Started server process [23460]
2025-03-19 17:26:03,590 - INFO - Waiting for application startup.
2025-03-19 17:26:03,597 - INFO - Application startup complete.
2025-03-19 17:26:03,602 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:26:03,669 - INFO - Logged request from IP bro 127.0.0.1 to /openapi.json
2025-03-19 17:26:10,403 - INFO - 1 change detected
2025-03-19 17:26:10,403 - WARNING - WatchFiles detected changes in 'auth.py'. Reloading...
2025-03-19 17:26:11,410 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:26:11,477 - INFO - Logged request from IP bro 127.0.0.1 to /docs
2025-03-19 17:26:11,528 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:26:11,712 - INFO - Logged request from IP bro 127.0.0.1 to /openapi.json
2025-03-19 17:26:11,717 - INFO - Shutting down
2025-03-19 17:26:11,828 - INFO - Waiting for application shutdown.
2025-03-19 17:26:11,829 - INFO - Monitoring task cancelled. Exiting...
2025-03-19 17:26:11,829 - INFO - Application shutdown complete.
2025-03-19 17:26:11,830 - INFO - Finished server process [23460]
2025-03-19 17:26:12,426 - INFO - 1 change detected
2025-03-19 17:26:13,030 - INFO - 5 changes detected
2025-03-19 17:26:13,471 - INFO - Started server process [23472]
2025-03-19 17:26:13,473 - INFO - Waiting for application startup.
2025-03-19 17:26:13,481 - INFO - Application startup complete.
2025-03-19 17:28:11,858 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:28:11,920 - INFO - Logged request from IP bro 127.0.0.1 to /docs
2025-03-19 17:28:11,970 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:28:12,040 - INFO - Logged request from IP bro 127.0.0.1 to /openapi.json
2025-03-19 17:28:19,884 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:28:19,891 - INFO - Logged request from IP bro 127.0.0.1 to /auth/show-current-users
2025-03-19 17:28:26,652 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:28:26,715 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-19 17:28:26,720 - INFO - Request body received: b'grant_type=password&username=fizril&password=fizril2001'
2025-03-19 17:28:26,729 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-19 17:28:28,476 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:28:28,645 - INFO - Logged request from IP bro 127.0.0.1 to /auth/show-current-users
2025-03-19 17:29:06,279 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:29:06,334 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-19 17:29:06,338 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-19 17:31:06,850 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:06,859 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:31:13,388 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:31:13,394 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-19 17:31:13,398 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-19 17:31:24,247 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:24,253 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:31:25,786 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:25,843 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:31:26,783 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:26,844 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-19 17:31:26,850 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:26,850 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:26,850 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:26,851 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:26,860 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-19 17:31:26,865 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-19 17:31:26,868 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-19 17:31:26,873 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-19 17:31:28,272 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:28,276 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:28,285 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:28,287 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:28,292 - INFO - Logged request from IP bro 127.0.0.1 to /auth/users/list
2025-03-19 17:31:28,297 - INFO - Logged request from IP bro 127.0.0.1 to /auth/activity-logs
2025-03-19 17:31:32,192 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:32,198 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:32,260 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-19 17:31:32,268 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-19 17:31:32,271 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:32,271 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:32,271 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:32,278 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-19 17:31:32,282 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-19 17:31:32,286 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-19 17:31:32,572 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:32,581 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:31:36,584 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:36,588 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:31:36,591 - INFO - Logged request from IP bro 127.0.0.1 to /auth/users/list
2025-03-19 17:31:36,598 - INFO - Logged request from IP bro 127.0.0.1 to /auth/activity-logs
2025-03-19 17:34:51,543 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:34:51,548 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 17:35:11,860 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:36:11,876 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-19 17:36:11,878 - INFO - Shutting down
2025-03-19 17:36:11,879 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:36:11,879 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:36:11,879 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:37:41,899 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 255, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 255, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-19 17:37:42,051 - INFO - Finished server process [23472]
2025-03-19 17:37:42,052 - INFO - Monitoring task cancelled. Exiting...
2025-03-19 17:37:42,090 - ERROR - Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 700, in lifespan
    await receive()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-03-19 17:37:42,100 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 250, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 250, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-19 17:37:42,111 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 250, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 250, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-19 17:37:42,120 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 250, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 250, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-19 17:37:42,333 - INFO - Stopping reloader process [21056]
2025-03-19 17:37:55,014 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-19 17:37:55,015 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-19 17:37:55,015 - INFO - Started reloader process [3688] using WatchFiles
2025-03-19 17:37:56,433 - INFO - Started server process [8848]
2025-03-19 17:37:56,436 - INFO - Waiting for application startup.
2025-03-19 17:37:56,444 - INFO - Application startup complete.
2025-03-19 17:38:35,686 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:38:35,747 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-19 17:38:35,752 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-19 17:38:35,758 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-19 17:38:42,914 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:38:42,972 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:38:43,028 - INFO - Logged request from IP bro 127.0.0.1 to /profile
2025-03-19 17:41:51,513 - INFO - 1 change detected
2025-03-19 17:41:51,514 - WARNING - WatchFiles detected changes in 'auth.py'. Reloading...
2025-03-19 17:42:53,629 - INFO - Shutting down
2025-03-19 17:42:53,737 - INFO - Waiting for application shutdown.
2025-03-19 17:42:53,738 - INFO - Monitoring task cancelled. Exiting...
2025-03-19 17:42:53,738 - INFO - Application shutdown complete.
2025-03-19 17:42:53,738 - INFO - Finished server process [8848]
2025-03-19 17:42:54,283 - INFO - 1 change detected
2025-03-19 17:42:55,091 - INFO - 5 changes detected
2025-03-19 17:42:55,500 - INFO - Started server process [22544]
2025-03-19 17:42:55,503 - INFO - Waiting for application startup.
2025-03-19 17:42:55,510 - INFO - Application startup complete.
2025-03-19 17:47:24,993 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:47:25,169 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:47:25,243 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:47:27,323 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:47:27,332 - INFO - Logged request from IP bro 127.0.0.1 to /docs
2025-03-19 17:47:27,478 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:47:27,549 - INFO - Logged request from IP bro 127.0.0.1 to /openapi.json
2025-03-19 17:47:40,584 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:47:40,590 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:47:50,637 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:47:50,806 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:48:06,050 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:48:06,106 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-19 17:48:06,110 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-19 17:48:06,116 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-19 17:48:08,804 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:48:08,871 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:48:33,865 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:48:33,931 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:48:57,759 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:48:57,766 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:52:08,954 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:52:08,962 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:53:28,843 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:53:28,848 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-19 17:53:28,850 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-19 17:53:46,065 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:53:46,070 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-19 17:53:46,072 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-19 17:53:48,640 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:53:48,698 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:53:57,878 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:53:57,938 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:53:57,998 - INFO - Logged request from IP bro 127.0.0.1 to //auth/update-user
2025-03-19 17:54:03,135 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:54:03,307 - INFO - Logged request from IP bro 127.0.0.1 to //auth/update-user
2025-03-19 17:54:14,171 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:54:14,179 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:54:16,195 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:54:16,202 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:54:21,929 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:54:21,936 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:54:21,942 - INFO - Logged request from IP bro 127.0.0.1 to /auth/update-user
2025-03-19 17:54:35,605 - INFO - 1 change detected
2025-03-19 17:54:35,605 - WARNING - WatchFiles detected changes in 'auth.py'. Reloading...
2025-03-19 17:54:38,128 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:54:38,194 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:54:38,231 - INFO - Shutting down
2025-03-19 17:54:38,339 - INFO - Waiting for application shutdown.
2025-03-19 17:54:38,341 - INFO - Monitoring task cancelled. Exiting...
2025-03-19 17:54:38,341 - INFO - Application shutdown complete.
2025-03-19 17:54:38,341 - INFO - Finished server process [22544]
2025-03-19 17:54:38,924 - INFO - 1 change detected
2025-03-19 17:54:39,582 - INFO - 5 changes detected
2025-03-19 17:54:40,009 - INFO - Started server process [16296]
2025-03-19 17:54:40,012 - INFO - Waiting for application startup.
2025-03-19 17:54:40,019 - INFO - Application startup complete.
2025-03-19 17:54:44,857 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:54:44,951 - INFO - Logged request from IP bro 127.0.0.1 to /auth/update-user
2025-03-19 17:54:44,972 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-19 17:54:54,031 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:54:54,088 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-19 17:54:54,092 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-19 17:54:54,303 - WARNING - Failed login attempt detected from IP: 127.0.0.1
2025-03-19 17:54:56,986 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:54:57,046 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-19 17:54:57,048 - INFO - Request body received: b'username=fizril&password=fizril420'
2025-03-19 17:54:59,822 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 17:54:59,831 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-19 17:55:03,725 - INFO - MUSEEEEEEEE2: False
2025-03-19 17:55:03,790 - INFO - Logged request from IP bro 127.0.0.1 to /auth/update-user
2025-03-19 18:02:41,095 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:02:41,186 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 18:02:42,461 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:02:42,540 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 18:03:10,244 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:03:10,406 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 18:03:12,294 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:03:12,297 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:03:12,304 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-19 18:03:12,317 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-19 18:03:12,321 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:03:12,321 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:03:12,321 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:03:12,333 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-19 18:03:12,340 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-19 18:03:12,347 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-19 18:03:13,416 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:03:13,425 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-19 18:06:55,599 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:06:55,601 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:06:55,615 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-19 18:06:55,625 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-19 18:06:55,628 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:06:55,629 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:06:55,629 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:06:55,813 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-19 18:06:55,818 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-19 18:06:55,822 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-19 18:10:35,178 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:10:35,183 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:10:35,190 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-19 18:10:35,197 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-19 18:10:35,200 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:10:35,200 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:10:35,200 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-19 18:10:35,210 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-19 18:10:35,214 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-19 18:10:35,218 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-19 18:11:35,232 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-19 18:11:35,234 - INFO - Shutting down
2025-03-19 18:11:35,240 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 164, in log_requests
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 164, in log_requests
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-19 18:11:35,260 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    |     return await future
    |            ^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    |     result = context.run(func, *args)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 172, in failures_breakdown
    |     ).filter(APIRequest.status_code >= 400).group_by(APIRequest.method).all()
    |                                                                         ~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    |     return self._iter().all()  # type: ignore
    |            ~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    result = context.run(func, *args)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 172, in failures_breakdown
    ).filter(APIRequest.status_code >= 400).group_by(APIRequest.method).all()
                                                                        ~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-19 18:11:35,318 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    |     return await future
    |            ^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    |     result = context.run(func, *args)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 188, in performance_trends
    |     ).group_by("hour").order_by("hour").all()
    |                                         ~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    |     return self._iter().all()  # type: ignore
    |            ~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    result = context.run(func, *args)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 188, in performance_trends
    ).group_by("hour").order_by("hour").all()
                                        ~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-19 18:11:35,335 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    |     return await future
    |            ^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    |     result = context.run(func, *args)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 204, in client_insights
    |     ).group_by(APIRequest.client_ip).order_by(func.count().desc()).limit(10).all()
    |                                                                              ~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    |     return self._iter().all()  # type: ignore
    |            ~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    result = context.run(func, *args)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 204, in client_insights
    ).group_by(APIRequest.client_ip).order_by(func.count().desc()).limit(10).all()
                                                                             ~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-19 18:11:35,352 - INFO - Waiting for background tasks to complete. (CTRL+C to force quit)
2025-03-19 18:11:35,464 - INFO - Waiting for application shutdown.
2025-03-19 18:11:35,465 - INFO - Monitoring task cancelled. Exiting...
2025-03-19 18:11:35,465 - INFO - Application shutdown complete.
2025-03-19 18:11:35,466 - INFO - Finished server process [16296]
2025-03-19 18:11:35,682 - INFO - Stopping reloader process [3688]
2025-03-26 16:30:30,506 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-26 16:30:30,508 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-26 16:30:30,509 - INFO - Started reloader process [9460] using WatchFiles
2025-03-26 16:30:32,126 - INFO - Started server process [15220]
2025-03-26 16:30:32,129 - INFO - Waiting for application startup.
2025-03-26 16:30:32,142 - INFO - Application startup complete.
2025-03-26 16:30:39,781 - INFO - MUSEEEEEEEE2: False
2025-03-26 16:30:39,856 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-26 16:30:39,866 - INFO - Request body received: b'username=fizril&password=fizril420'
2025-03-26 16:30:39,878 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-26 16:30:40,120 - WARNING - Failed login attempt detected from IP: 127.0.0.1
2025-03-26 16:30:42,357 - INFO - MUSEEEEEEEE2: False
2025-03-26 16:30:42,415 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-26 16:30:42,420 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-26 16:31:03,483 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:31:03,666 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:31:04,956 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:31:05,097 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:31:10,609 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:31:10,701 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:31:12,480 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:31:12,540 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:31:39,510 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:31:39,577 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:32:04,114 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:32:04,181 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:32:16,421 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:32:16,488 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:39:31,883 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:39:31,944 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:40:53,561 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:40:53,628 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:42:36,405 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:42:36,412 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:42:39,797 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:42:39,804 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:46:49,133 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:46:49,141 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:46:49,146 - INFO - Logged request from IP bro 127.0.0.1 to /auth/current-user
2025-03-26 16:50:18,030 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:50:18,098 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 16:50:20,265 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:50:20,268 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:50:20,337 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 16:50:20,410 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 16:50:20,414 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:50:20,414 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:50:20,415 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:50:20,423 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 16:50:20,428 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 16:50:20,434 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 16:50:21,248 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 16:50:21,256 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:01:59,608 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:01:59,617 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:02:23,884 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:02:23,893 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:02:38,094 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:02:38,102 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:02:44,846 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:02:45,013 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:12:22,766 - INFO - 1 change detected
2025-03-26 17:12:23,156 - INFO - 1 change detected
2025-03-26 17:12:23,517 - INFO - 1 change detected
2025-03-26 17:12:23,924 - INFO - 1 change detected
2025-03-26 17:12:24,333 - INFO - 1 change detected
2025-03-26 17:12:24,740 - INFO - 1 change detected
2025-03-26 17:12:25,148 - INFO - 1 change detected
2025-03-26 17:12:25,551 - INFO - 1 change detected
2025-03-26 17:12:25,909 - INFO - 1 change detected
2025-03-26 17:12:26,271 - INFO - 1 change detected
2025-03-26 17:12:26,631 - INFO - 1 change detected
2025-03-26 17:12:26,991 - INFO - 1 change detected
2025-03-26 17:12:27,352 - INFO - 1 change detected
2025-03-26 17:12:27,810 - INFO - 1 change detected
2025-03-26 17:12:28,211 - INFO - 1 change detected
2025-03-26 17:12:28,618 - INFO - 1 change detected
2025-03-26 17:12:28,975 - INFO - 1 change detected
2025-03-26 17:12:29,385 - INFO - 1 change detected
2025-03-26 17:12:29,794 - INFO - 1 change detected
2025-03-26 17:12:30,198 - INFO - 1 change detected
2025-03-26 17:12:30,610 - INFO - 1 change detected
2025-03-26 17:12:31,013 - INFO - 1 change detected
2025-03-26 17:12:31,422 - INFO - 1 change detected
2025-03-26 17:12:31,781 - INFO - 1 change detected
2025-03-26 17:12:32,192 - INFO - 1 change detected
2025-03-26 17:12:32,601 - INFO - 1 change detected
2025-03-26 17:12:33,008 - INFO - 1 change detected
2025-03-26 17:12:33,409 - INFO - 1 change detected
2025-03-26 17:12:33,815 - INFO - 1 change detected
2025-03-26 17:12:34,221 - INFO - 1 change detected
2025-03-26 17:12:34,628 - INFO - 1 change detected
2025-03-26 17:12:35,030 - INFO - 1 change detected
2025-03-26 17:12:35,435 - INFO - 1 change detected
2025-03-26 17:12:35,839 - INFO - 1 change detected
2025-03-26 17:12:36,260 - INFO - 1 change detected
2025-03-26 17:12:36,681 - INFO - 1 change detected
2025-03-26 17:12:37,100 - INFO - 1 change detected
2025-03-26 17:12:37,504 - INFO - 1 change detected
2025-03-26 17:12:37,909 - INFO - 1 change detected
2025-03-26 17:12:38,320 - INFO - 1 change detected
2025-03-26 17:12:38,728 - INFO - 1 change detected
2025-03-26 17:12:39,142 - INFO - 1 change detected
2025-03-26 17:12:39,559 - INFO - 1 change detected
2025-03-26 17:12:39,987 - INFO - 1 change detected
2025-03-26 17:12:40,409 - INFO - 1 change detected
2025-03-26 17:12:40,820 - INFO - 1 change detected
2025-03-26 17:12:41,225 - INFO - 1 change detected
2025-03-26 17:12:41,634 - INFO - 1 change detected
2025-03-26 17:12:42,039 - INFO - 1 change detected
2025-03-26 17:12:42,395 - INFO - 1 change detected
2025-03-26 17:12:42,810 - INFO - 1 change detected
2025-03-26 17:12:43,219 - INFO - 1 change detected
2025-03-26 17:12:43,639 - INFO - 1 change detected
2025-03-26 17:12:44,053 - INFO - 1 change detected
2025-03-26 17:12:44,471 - INFO - 1 change detected
2025-03-26 17:12:44,880 - INFO - 1 change detected
2025-03-26 17:12:45,290 - INFO - 1 change detected
2025-03-26 17:12:45,706 - INFO - 1 change detected
2025-03-26 17:12:46,118 - INFO - 1 change detected
2025-03-26 17:12:46,528 - INFO - 1 change detected
2025-03-26 17:12:46,936 - INFO - 1 change detected
2025-03-26 17:12:47,346 - INFO - 1 change detected
2025-03-26 17:12:47,799 - INFO - 1 change detected
2025-03-26 17:12:48,202 - INFO - 1 change detected
2025-03-26 17:12:48,609 - INFO - 1 change detected
2025-03-26 17:12:48,966 - INFO - 1 change detected
2025-03-26 17:12:49,375 - INFO - 1 change detected
2025-03-26 17:12:49,782 - INFO - 1 change detected
2025-03-26 17:12:50,186 - INFO - 1 change detected
2025-03-26 17:12:50,597 - INFO - 1 change detected
2025-03-26 17:12:51,001 - INFO - 1 change detected
2025-03-26 17:12:51,407 - INFO - 1 change detected
2025-03-26 17:12:51,761 - INFO - 1 change detected
2025-03-26 17:12:52,174 - INFO - 1 change detected
2025-03-26 17:12:52,582 - INFO - 1 change detected
2025-03-26 17:12:52,989 - INFO - 1 change detected
2025-03-26 17:12:53,392 - INFO - 1 change detected
2025-03-26 17:12:53,804 - INFO - 1 change detected
2025-03-26 17:12:54,210 - INFO - 1 change detected
2025-03-26 17:12:54,616 - INFO - 1 change detected
2025-03-26 17:12:55,022 - INFO - 1 change detected
2025-03-26 17:12:55,433 - INFO - 1 change detected
2025-03-26 17:12:55,839 - INFO - 1 change detected
2025-03-26 17:12:56,251 - INFO - 1 change detected
2025-03-26 17:12:56,656 - INFO - 1 change detected
2025-03-26 17:12:57,063 - INFO - 1 change detected
2025-03-26 17:12:57,471 - INFO - 1 change detected
2025-03-26 17:12:57,880 - INFO - 1 change detected
2025-03-26 17:12:58,292 - INFO - 1 change detected
2025-03-26 17:12:58,699 - INFO - 1 change detected
2025-03-26 17:12:59,109 - INFO - 1 change detected
2025-03-26 17:12:59,523 - INFO - 1 change detected
2025-03-26 17:12:59,886 - INFO - 1 change detected
2025-03-26 17:13:00,299 - INFO - 1 change detected
2025-03-26 17:13:00,704 - INFO - 1 change detected
2025-03-26 17:13:01,109 - INFO - 1 change detected
2025-03-26 17:13:01,519 - INFO - 1 change detected
2025-03-26 17:13:01,923 - INFO - 1 change detected
2025-03-26 17:13:02,329 - INFO - 1 change detected
2025-03-26 17:13:02,736 - INFO - 1 change detected
2025-03-26 17:13:03,097 - INFO - 1 change detected
2025-03-26 17:13:03,562 - INFO - 1 change detected
2025-03-26 17:13:03,965 - INFO - 1 change detected
2025-03-26 17:13:04,376 - INFO - 1 change detected
2025-03-26 17:13:04,783 - INFO - 1 change detected
2025-03-26 17:13:05,186 - INFO - 1 change detected
2025-03-26 17:13:05,605 - INFO - 1 change detected
2025-03-26 17:13:06,022 - INFO - 1 change detected
2025-03-26 17:13:06,439 - INFO - 1 change detected
2025-03-26 17:13:06,851 - INFO - 1 change detected
2025-03-26 17:13:07,262 - INFO - 1 change detected
2025-03-26 17:13:07,679 - INFO - 1 change detected
2025-03-26 17:13:08,084 - INFO - 1 change detected
2025-03-26 17:13:08,490 - INFO - 1 change detected
2025-03-26 17:13:08,895 - INFO - 1 change detected
2025-03-26 17:13:09,300 - INFO - 1 change detected
2025-03-26 17:13:09,709 - INFO - 1 change detected
2025-03-26 17:13:10,115 - INFO - 1 change detected
2025-03-26 17:13:10,522 - INFO - 1 change detected
2025-03-26 17:13:10,929 - INFO - 1 change detected
2025-03-26 17:13:11,337 - INFO - 1 change detected
2025-03-26 17:13:11,761 - INFO - 1 change detected
2025-03-26 17:13:12,203 - INFO - 1 change detected
2025-03-26 17:13:12,610 - INFO - 1 change detected
2025-03-26 17:13:13,013 - INFO - 1 change detected
2025-03-26 17:13:13,420 - INFO - 1 change detected
2025-03-26 17:13:13,827 - INFO - 1 change detected
2025-03-26 17:13:14,253 - INFO - 1 change detected
2025-03-26 17:13:14,657 - INFO - 1 change detected
2025-03-26 17:13:15,064 - INFO - 1 change detected
2025-03-26 17:13:15,469 - INFO - 1 change detected
2025-03-26 17:13:15,879 - INFO - 1 change detected
2025-03-26 17:13:16,296 - INFO - 1 change detected
2025-03-26 17:13:16,701 - INFO - 1 change detected
2025-03-26 17:13:17,113 - INFO - 1 change detected
2025-03-26 17:13:17,471 - INFO - 1 change detected
2025-03-26 17:13:17,883 - INFO - 1 change detected
2025-03-26 17:13:18,291 - INFO - 1 change detected
2025-03-26 17:13:18,702 - INFO - 1 change detected
2025-03-26 17:13:19,108 - INFO - 1 change detected
2025-03-26 17:13:19,517 - INFO - 1 change detected
2025-03-26 17:13:19,926 - INFO - 1 change detected
2025-03-26 17:13:20,335 - INFO - 1 change detected
2025-03-26 17:13:20,741 - INFO - 1 change detected
2025-03-26 17:13:21,101 - INFO - 1 change detected
2025-03-26 17:13:21,515 - INFO - 1 change detected
2025-03-26 17:13:21,925 - INFO - 1 change detected
2025-03-26 17:13:22,332 - INFO - 1 change detected
2025-03-26 17:13:22,736 - INFO - 1 change detected
2025-03-26 17:13:23,143 - INFO - 1 change detected
2025-03-26 17:13:23,546 - INFO - 1 change detected
2025-03-26 17:13:23,952 - INFO - 1 change detected
2025-03-26 17:13:24,360 - INFO - 1 change detected
2025-03-26 17:13:24,716 - INFO - 1 change detected
2025-03-26 17:13:25,124 - INFO - 1 change detected
2025-03-26 17:13:25,535 - INFO - 1 change detected
2025-03-26 17:13:25,942 - INFO - 1 change detected
2025-03-26 17:13:26,352 - INFO - 1 change detected
2025-03-26 17:13:26,759 - INFO - 1 change detected
2025-03-26 17:13:27,161 - INFO - 1 change detected
2025-03-26 17:13:27,567 - INFO - 1 change detected
2025-03-26 17:13:27,974 - INFO - 1 change detected
2025-03-26 17:13:28,380 - INFO - 1 change detected
2025-03-26 17:13:28,787 - INFO - 1 change detected
2025-03-26 17:13:29,192 - INFO - 1 change detected
2025-03-26 17:13:29,596 - INFO - 1 change detected
2025-03-26 17:13:30,005 - INFO - 1 change detected
2025-03-26 17:13:30,415 - INFO - 1 change detected
2025-03-26 17:13:30,773 - INFO - 1 change detected
2025-03-26 17:13:31,185 - INFO - 1 change detected
2025-03-26 17:13:31,590 - INFO - 1 change detected
2025-03-26 17:13:32,000 - INFO - 1 change detected
2025-03-26 17:13:32,407 - INFO - 1 change detected
2025-03-26 17:13:32,768 - INFO - 1 change detected
2025-03-26 17:13:33,177 - INFO - 1 change detected
2025-03-26 17:13:33,585 - INFO - 1 change detected
2025-03-26 17:13:33,989 - INFO - 1 change detected
2025-03-26 17:13:34,399 - INFO - 1 change detected
2025-03-26 17:13:34,805 - INFO - 1 change detected
2025-03-26 17:13:35,165 - INFO - 1 change detected
2025-03-26 17:13:35,575 - INFO - 1 change detected
2025-03-26 17:13:35,985 - INFO - 1 change detected
2025-03-26 17:13:36,392 - INFO - 1 change detected
2025-03-26 17:13:36,797 - INFO - 1 change detected
2025-03-26 17:13:37,208 - INFO - 1 change detected
2025-03-26 17:13:37,566 - INFO - 1 change detected
2025-03-26 17:13:37,977 - INFO - 1 change detected
2025-03-26 17:13:38,382 - INFO - 1 change detected
2025-03-26 17:13:38,788 - INFO - 1 change detected
2025-03-26 17:13:39,193 - INFO - 1 change detected
2025-03-26 17:13:39,598 - INFO - 1 change detected
2025-03-26 17:13:40,003 - INFO - 1 change detected
2025-03-26 17:13:40,413 - INFO - 1 change detected
2025-03-26 17:13:40,817 - INFO - 1 change detected
2025-03-26 17:13:41,224 - INFO - 1 change detected
2025-03-26 17:13:41,629 - INFO - 1 change detected
2025-03-26 17:13:42,034 - INFO - 1 change detected
2025-03-26 17:13:42,443 - INFO - 1 change detected
2025-03-26 17:13:42,847 - INFO - 1 change detected
2025-03-26 17:13:43,252 - INFO - 1 change detected
2025-03-26 17:13:43,659 - INFO - 1 change detected
2025-03-26 17:13:44,015 - INFO - 1 change detected
2025-03-26 17:13:44,422 - INFO - 1 change detected
2025-03-26 17:13:44,829 - INFO - 1 change detected
2025-03-26 17:13:45,231 - INFO - 1 change detected
2025-03-26 17:13:45,636 - INFO - 1 change detected
2025-03-26 17:13:46,039 - INFO - 1 change detected
2025-03-26 17:13:46,447 - INFO - 1 change detected
2025-03-26 17:13:46,852 - INFO - 1 change detected
2025-03-26 17:13:47,260 - INFO - 1 change detected
2025-03-26 17:13:47,620 - INFO - 1 change detected
2025-03-26 17:13:48,034 - INFO - 1 change detected
2025-03-26 17:13:48,442 - INFO - 1 change detected
2025-03-26 17:13:48,802 - INFO - 1 change detected
2025-03-26 17:13:49,213 - INFO - 1 change detected
2025-03-26 17:13:49,622 - INFO - 1 change detected
2025-03-26 17:13:50,027 - INFO - 1 change detected
2025-03-26 17:13:50,435 - INFO - 1 change detected
2025-03-26 17:13:50,842 - INFO - 1 change detected
2025-03-26 17:13:51,203 - INFO - 1 change detected
2025-03-26 17:13:51,614 - INFO - 1 change detected
2025-03-26 17:13:52,017 - INFO - 1 change detected
2025-03-26 17:13:52,427 - INFO - 1 change detected
2025-03-26 17:13:52,833 - INFO - 1 change detected
2025-03-26 17:13:53,241 - INFO - 1 change detected
2025-03-26 17:13:53,600 - INFO - 1 change detected
2025-03-26 17:13:54,008 - INFO - 1 change detected
2025-03-26 17:13:54,414 - INFO - 1 change detected
2025-03-26 17:13:54,820 - INFO - 1 change detected
2025-03-26 17:13:55,226 - INFO - 1 change detected
2025-03-26 17:13:55,630 - INFO - 1 change detected
2025-03-26 17:13:56,043 - INFO - 1 change detected
2025-03-26 17:13:56,452 - INFO - 1 change detected
2025-03-26 17:13:56,859 - INFO - 1 change detected
2025-03-26 17:13:57,268 - INFO - 1 change detected
2025-03-26 17:13:57,678 - INFO - 1 change detected
2025-03-26 17:13:58,086 - INFO - 1 change detected
2025-03-26 17:13:58,493 - INFO - 1 change detected
2025-03-26 17:13:58,900 - INFO - 1 change detected
2025-03-26 17:13:59,305 - INFO - 1 change detected
2025-03-26 17:13:59,711 - INFO - 1 change detected
2025-03-26 17:14:00,119 - INFO - 1 change detected
2025-03-26 17:14:00,523 - INFO - 1 change detected
2025-03-26 17:14:00,882 - INFO - 1 change detected
2025-03-26 17:14:01,293 - INFO - 1 change detected
2025-03-26 17:14:01,705 - INFO - 1 change detected
2025-03-26 17:14:02,110 - INFO - 1 change detected
2025-03-26 17:14:02,514 - INFO - 1 change detected
2025-03-26 17:14:03,222 - INFO - 1 change detected
2025-03-26 17:14:03,627 - INFO - 1 change detected
2025-03-26 17:14:03,984 - INFO - 1 change detected
2025-03-26 17:14:04,396 - INFO - 1 change detected
2025-03-26 17:14:04,807 - INFO - 1 change detected
2025-03-26 17:14:05,215 - INFO - 1 change detected
2025-03-26 17:14:05,620 - INFO - 1 change detected
2025-03-26 17:14:05,980 - INFO - 1 change detected
2025-03-26 17:14:06,390 - INFO - 1 change detected
2025-03-26 17:14:06,798 - INFO - 1 change detected
2025-03-26 17:14:07,202 - INFO - 1 change detected
2025-03-26 17:14:07,609 - INFO - 1 change detected
2025-03-26 17:14:08,017 - INFO - 1 change detected
2025-03-26 17:14:08,425 - INFO - 1 change detected
2025-03-26 17:14:08,783 - INFO - 1 change detected
2025-03-26 17:14:09,195 - INFO - 1 change detected
2025-03-26 17:14:09,605 - INFO - 1 change detected
2025-03-26 17:14:09,965 - INFO - 1 change detected
2025-03-26 17:14:10,377 - INFO - 1 change detected
2025-03-26 17:14:10,785 - INFO - 1 change detected
2025-03-26 17:14:11,195 - INFO - 1 change detected
2025-03-26 17:14:11,600 - INFO - 1 change detected
2025-03-26 17:14:12,008 - INFO - 1 change detected
2025-03-26 17:14:12,413 - INFO - 1 change detected
2025-03-26 17:14:12,819 - INFO - 1 change detected
2025-03-26 17:14:13,223 - INFO - 1 change detected
2025-03-26 17:14:13,627 - INFO - 1 change detected
2025-03-26 17:14:14,031 - INFO - 1 change detected
2025-03-26 17:14:14,437 - INFO - 1 change detected
2025-03-26 17:14:14,845 - INFO - 1 change detected
2025-03-26 17:14:15,251 - INFO - 1 change detected
2025-03-26 17:14:15,656 - INFO - 1 change detected
2025-03-26 17:14:16,065 - INFO - 1 change detected
2025-03-26 17:14:16,472 - INFO - 1 change detected
2025-03-26 17:14:16,875 - INFO - 1 change detected
2025-03-26 17:14:17,281 - INFO - 1 change detected
2025-03-26 17:14:17,685 - INFO - 1 change detected
2025-03-26 17:14:18,093 - INFO - 1 change detected
2025-03-26 17:14:18,502 - INFO - 1 change detected
2025-03-26 17:14:18,903 - INFO - 1 change detected
2025-03-26 17:14:19,309 - INFO - 1 change detected
2025-03-26 17:14:19,717 - INFO - 1 change detected
2025-03-26 17:14:20,125 - INFO - 1 change detected
2025-03-26 17:14:20,531 - INFO - 1 change detected
2025-03-26 17:14:20,889 - INFO - 1 change detected
2025-03-26 17:14:21,303 - INFO - 1 change detected
2025-03-26 17:14:21,708 - INFO - 1 change detected
2025-03-26 17:14:22,111 - INFO - 1 change detected
2025-03-26 17:14:22,520 - INFO - 1 change detected
2025-03-26 17:14:22,926 - INFO - 1 change detected
2025-03-26 17:14:23,336 - INFO - 1 change detected
2025-03-26 17:14:23,742 - INFO - 1 change detected
2025-03-26 17:14:24,148 - INFO - 1 change detected
2025-03-26 17:14:24,507 - INFO - 1 change detected
2025-03-26 17:14:24,916 - INFO - 1 change detected
2025-03-26 17:14:25,322 - INFO - 1 change detected
2025-03-26 17:14:25,729 - INFO - 1 change detected
2025-03-26 17:14:26,133 - INFO - 1 change detected
2025-03-26 17:14:26,545 - INFO - 1 change detected
2025-03-26 17:14:26,953 - INFO - 1 change detected
2025-03-26 17:14:27,312 - INFO - 1 change detected
2025-03-26 17:14:27,720 - INFO - 1 change detected
2025-03-26 17:14:28,127 - INFO - 1 change detected
2025-03-26 17:14:28,534 - INFO - 1 change detected
2025-03-26 17:14:28,943 - INFO - 1 change detected
2025-03-26 17:14:29,360 - INFO - 1 change detected
2025-03-26 17:14:29,767 - INFO - 1 change detected
2025-03-26 17:14:30,123 - INFO - 1 change detected
2025-03-26 17:14:30,536 - INFO - 1 change detected
2025-03-26 17:14:30,943 - INFO - 1 change detected
2025-03-26 17:14:31,354 - INFO - 1 change detected
2025-03-26 17:14:31,713 - INFO - 1 change detected
2025-03-26 17:14:32,124 - INFO - 1 change detected
2025-03-26 17:14:32,531 - INFO - 1 change detected
2025-03-26 17:14:32,938 - INFO - 1 change detected
2025-03-26 17:14:33,348 - INFO - 1 change detected
2025-03-26 17:14:33,755 - INFO - 1 change detected
2025-03-26 17:14:34,158 - INFO - 1 change detected
2025-03-26 17:14:34,563 - INFO - 1 change detected
2025-03-26 17:14:34,971 - INFO - 1 change detected
2025-03-26 17:14:35,374 - INFO - 1 change detected
2025-03-26 17:14:35,731 - INFO - 1 change detected
2025-03-26 17:14:36,140 - INFO - 1 change detected
2025-03-26 17:14:36,548 - INFO - 1 change detected
2025-03-26 17:14:36,952 - INFO - 1 change detected
2025-03-26 17:14:37,305 - INFO - 1 change detected
2025-03-26 17:14:37,712 - INFO - 1 change detected
2025-03-26 17:14:38,120 - INFO - 1 change detected
2025-03-26 17:14:38,523 - INFO - 1 change detected
2025-03-26 17:14:38,929 - INFO - 1 change detected
2025-03-26 17:14:39,335 - INFO - 1 change detected
2025-03-26 17:14:39,738 - INFO - 1 change detected
2025-03-26 17:14:40,146 - INFO - 1 change detected
2025-03-26 17:14:40,503 - INFO - 1 change detected
2025-03-26 17:14:40,919 - INFO - 1 change detected
2025-03-26 17:14:41,324 - INFO - 1 change detected
2025-03-26 17:14:41,734 - INFO - 1 change detected
2025-03-26 17:14:42,145 - INFO - 1 change detected
2025-03-26 17:14:42,856 - INFO - 1 change detected
2025-03-26 17:14:43,610 - INFO - 1 change detected
2025-03-26 17:14:44,177 - INFO - 1 change detected
2025-03-26 17:14:44,592 - INFO - 1 change detected
2025-03-26 17:14:44,999 - INFO - 1 change detected
2025-03-26 17:14:45,360 - INFO - 1 change detected
2025-03-26 17:14:45,772 - INFO - 1 change detected
2025-03-26 17:14:46,180 - INFO - 1 change detected
2025-03-26 17:14:46,538 - INFO - 1 change detected
2025-03-26 17:14:46,949 - INFO - 1 change detected
2025-03-26 17:14:47,406 - INFO - 1 change detected
2025-03-26 17:14:47,811 - INFO - 1 change detected
2025-03-26 17:14:48,219 - INFO - 1 change detected
2025-03-26 17:14:48,628 - INFO - 1 change detected
2025-03-26 17:14:49,034 - INFO - 1 change detected
2025-03-26 17:14:49,443 - INFO - 1 change detected
2025-03-26 17:14:49,847 - INFO - 1 change detected
2025-03-26 17:14:50,206 - INFO - 1 change detected
2025-03-26 17:14:50,618 - INFO - 1 change detected
2025-03-26 17:14:51,030 - INFO - 1 change detected
2025-03-26 17:14:51,438 - INFO - 1 change detected
2025-03-26 17:14:51,846 - INFO - 1 change detected
2025-03-26 17:14:52,204 - INFO - 1 change detected
2025-03-26 17:14:52,614 - INFO - 1 change detected
2025-03-26 17:14:53,017 - INFO - 1 change detected
2025-03-26 17:14:53,422 - INFO - 1 change detected
2025-03-26 17:14:53,828 - INFO - 1 change detected
2025-03-26 17:14:54,234 - INFO - 1 change detected
2025-03-26 17:14:54,640 - INFO - 1 change detected
2025-03-26 17:14:55,047 - INFO - 1 change detected
2025-03-26 17:14:55,404 - INFO - 1 change detected
2025-03-26 17:14:55,817 - INFO - 1 change detected
2025-03-26 17:14:56,221 - INFO - 1 change detected
2025-03-26 17:14:56,627 - INFO - 1 change detected
2025-03-26 17:14:57,032 - INFO - 1 change detected
2025-03-26 17:14:57,440 - INFO - 1 change detected
2025-03-26 17:14:57,798 - INFO - 1 change detected
2025-03-26 17:14:58,206 - INFO - 1 change detected
2025-03-26 17:14:58,612 - INFO - 1 change detected
2025-03-26 17:14:59,019 - INFO - 1 change detected
2025-03-26 17:14:59,426 - INFO - 1 change detected
2025-03-26 17:14:59,835 - INFO - 1 change detected
2025-03-26 17:15:00,240 - INFO - 1 change detected
2025-03-26 17:15:00,645 - INFO - 1 change detected
2025-03-26 17:15:01,154 - INFO - 1 change detected
2025-03-26 17:15:01,568 - INFO - 1 change detected
2025-03-26 17:15:01,973 - INFO - 1 change detected
2025-03-26 17:15:02,380 - INFO - 1 change detected
2025-03-26 17:15:02,784 - INFO - 1 change detected
2025-03-26 17:15:03,341 - INFO - 1 change detected
2025-03-26 17:15:03,855 - INFO - 1 change detected
2025-03-26 17:15:04,217 - INFO - 1 change detected
2025-03-26 17:15:04,627 - INFO - 1 change detected
2025-03-26 17:15:05,033 - INFO - 1 change detected
2025-03-26 17:15:05,441 - INFO - 1 change detected
2025-03-26 17:15:05,895 - INFO - 1 change detected
2025-03-26 17:15:06,298 - INFO - 1 change detected
2025-03-26 17:15:06,704 - INFO - 1 change detected
2025-03-26 17:15:07,115 - INFO - 1 change detected
2025-03-26 17:15:07,523 - INFO - 1 change detected
2025-03-26 17:15:07,928 - INFO - 1 change detected
2025-03-26 17:15:08,336 - INFO - 1 change detected
2025-03-26 17:15:08,744 - INFO - 1 change detected
2025-03-26 17:15:09,101 - INFO - 1 change detected
2025-03-26 17:15:09,513 - INFO - 1 change detected
2025-03-26 17:15:09,921 - INFO - 1 change detected
2025-03-26 17:15:10,327 - INFO - 1 change detected
2025-03-26 17:15:10,732 - INFO - 1 change detected
2025-03-26 17:15:11,088 - INFO - 1 change detected
2025-03-26 17:15:11,500 - INFO - 1 change detected
2025-03-26 17:15:11,908 - INFO - 1 change detected
2025-03-26 17:15:12,364 - INFO - 1 change detected
2025-03-26 17:15:12,769 - INFO - 1 change detected
2025-03-26 17:15:13,126 - INFO - 1 change detected
2025-03-26 17:15:13,538 - INFO - 1 change detected
2025-03-26 17:15:13,949 - INFO - 1 change detected
2025-03-26 17:15:14,307 - INFO - 1 change detected
2025-03-26 17:15:14,717 - INFO - 1 change detected
2025-03-26 17:15:15,125 - INFO - 1 change detected
2025-03-26 17:15:15,532 - INFO - 1 change detected
2025-03-26 17:15:15,941 - INFO - 1 change detected
2025-03-26 17:15:16,347 - INFO - 1 change detected
2025-03-26 17:15:16,751 - INFO - 1 change detected
2025-03-26 17:15:17,160 - INFO - 1 change detected
2025-03-26 17:15:17,519 - INFO - 1 change detected
2025-03-26 17:15:17,929 - INFO - 1 change detected
2025-03-26 17:15:18,333 - INFO - 1 change detected
2025-03-26 17:15:18,744 - INFO - 1 change detected
2025-03-26 17:15:19,152 - INFO - 1 change detected
2025-03-26 17:15:19,512 - INFO - 1 change detected
2025-03-26 17:15:19,923 - INFO - 1 change detected
2025-03-26 17:15:20,330 - INFO - 1 change detected
2025-03-26 17:15:20,738 - INFO - 1 change detected
2025-03-26 17:15:21,143 - INFO - 1 change detected
2025-03-26 17:15:21,552 - INFO - 1 change detected
2025-03-26 17:15:21,959 - INFO - 1 change detected
2025-03-26 17:15:22,316 - INFO - 1 change detected
2025-03-26 17:15:22,726 - INFO - 1 change detected
2025-03-26 17:15:23,136 - INFO - 1 change detected
2025-03-26 17:15:23,546 - INFO - 1 change detected
2025-03-26 17:15:23,956 - INFO - 1 change detected
2025-03-26 17:15:24,362 - INFO - 1 change detected
2025-03-26 17:15:24,722 - INFO - 1 change detected
2025-03-26 17:15:25,132 - INFO - 1 change detected
2025-03-26 17:15:25,539 - INFO - 1 change detected
2025-03-26 17:15:25,945 - INFO - 1 change detected
2025-03-26 17:15:26,354 - INFO - 1 change detected
2025-03-26 17:15:26,712 - INFO - 1 change detected
2025-03-26 17:15:27,127 - INFO - 1 change detected
2025-03-26 17:15:27,537 - INFO - 1 change detected
2025-03-26 17:15:27,894 - INFO - 1 change detected
2025-03-26 17:15:28,299 - INFO - 1 change detected
2025-03-26 17:15:28,707 - INFO - 1 change detected
2025-03-26 17:15:29,116 - INFO - 1 change detected
2025-03-26 17:15:29,522 - INFO - 1 change detected
2025-03-26 17:15:29,932 - INFO - 1 change detected
2025-03-26 17:15:30,291 - INFO - 1 change detected
2025-03-26 17:15:30,703 - INFO - 1 change detected
2025-03-26 17:15:31,109 - INFO - 1 change detected
2025-03-26 17:15:31,465 - INFO - 1 change detected
2025-03-26 17:15:31,874 - INFO - 1 change detected
2025-03-26 17:15:32,281 - INFO - 1 change detected
2025-03-26 17:15:32,685 - INFO - 1 change detected
2025-03-26 17:15:33,095 - INFO - 1 change detected
2025-03-26 17:15:33,503 - INFO - 1 change detected
2025-03-26 17:15:33,912 - INFO - 1 change detected
2025-03-26 17:15:34,319 - INFO - 1 change detected
2025-03-26 17:15:34,723 - INFO - 1 change detected
2025-03-26 17:15:35,080 - INFO - 1 change detected
2025-03-26 17:15:35,493 - INFO - 1 change detected
2025-03-26 17:15:35,898 - INFO - 1 change detected
2025-03-26 17:15:36,303 - INFO - 1 change detected
2025-03-26 17:15:36,715 - INFO - 1 change detected
2025-03-26 17:15:37,123 - INFO - 1 change detected
2025-03-26 17:15:37,532 - INFO - 1 change detected
2025-03-26 17:15:37,938 - INFO - 1 change detected
2025-03-26 17:15:38,343 - INFO - 1 change detected
2025-03-26 17:15:38,701 - INFO - 1 change detected
2025-03-26 17:15:39,112 - INFO - 1 change detected
2025-03-26 17:15:39,518 - INFO - 1 change detected
2025-03-26 17:15:39,929 - INFO - 1 change detected
2025-03-26 17:15:40,338 - INFO - 1 change detected
2025-03-26 17:15:40,747 - INFO - 1 change detected
2025-03-26 17:15:41,154 - INFO - 1 change detected
2025-03-26 17:15:41,558 - INFO - 1 change detected
2025-03-26 17:15:41,965 - INFO - 1 change detected
2025-03-26 17:15:42,370 - INFO - 1 change detected
2025-03-26 17:15:42,667 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:15:42,742 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:15:42,778 - INFO - 1 change detected
2025-03-26 17:15:43,138 - INFO - 1 change detected
2025-03-26 17:15:43,548 - INFO - 1 change detected
2025-03-26 17:15:43,955 - INFO - 1 change detected
2025-03-26 17:15:44,362 - INFO - 1 change detected
2025-03-26 17:15:44,722 - INFO - 1 change detected
2025-03-26 17:15:45,136 - INFO - 1 change detected
2025-03-26 17:15:45,544 - INFO - 1 change detected
2025-03-26 17:15:45,905 - INFO - 1 change detected
2025-03-26 17:15:46,319 - INFO - 1 change detected
2025-03-26 17:15:46,727 - INFO - 1 change detected
2025-03-26 17:15:47,143 - INFO - 1 change detected
2025-03-26 17:15:47,507 - INFO - 1 change detected
2025-03-26 17:15:47,915 - INFO - 1 change detected
2025-03-26 17:15:48,326 - INFO - 1 change detected
2025-03-26 17:15:48,732 - INFO - 1 change detected
2025-03-26 17:15:49,137 - INFO - 1 change detected
2025-03-26 17:15:49,497 - INFO - 1 change detected
2025-03-26 17:15:49,911 - INFO - 1 change detected
2025-03-26 17:15:50,314 - INFO - 1 change detected
2025-03-26 17:15:50,720 - INFO - 1 change detected
2025-03-26 17:15:51,129 - INFO - 1 change detected
2025-03-26 17:15:51,488 - INFO - 1 change detected
2025-03-26 17:15:51,900 - INFO - 1 change detected
2025-03-26 17:15:52,306 - INFO - 1 change detected
2025-03-26 17:15:52,713 - INFO - 1 change detected
2025-03-26 17:15:53,118 - INFO - 1 change detected
2025-03-26 17:15:53,528 - INFO - 1 change detected
2025-03-26 17:15:53,937 - INFO - 1 change detected
2025-03-26 17:15:54,343 - INFO - 1 change detected
2025-03-26 17:15:54,700 - INFO - 1 change detected
2025-03-26 17:15:55,114 - INFO - 1 change detected
2025-03-26 17:15:55,519 - INFO - 1 change detected
2025-03-26 17:15:55,927 - INFO - 1 change detected
2025-03-26 17:15:56,336 - INFO - 1 change detected
2025-03-26 17:15:56,743 - INFO - 1 change detected
2025-03-26 17:15:57,152 - INFO - 1 change detected
2025-03-26 17:15:57,558 - INFO - 1 change detected
2025-03-26 17:15:57,966 - INFO - 1 change detected
2025-03-26 17:15:58,324 - INFO - 1 change detected
2025-03-26 17:15:58,736 - INFO - 1 change detected
2025-03-26 17:15:59,144 - INFO - 1 change detected
2025-03-26 17:15:59,505 - INFO - 1 change detected
2025-03-26 17:15:59,918 - INFO - 1 change detected
2025-03-26 17:16:00,328 - INFO - 1 change detected
2025-03-26 17:16:00,731 - INFO - 1 change detected
2025-03-26 17:16:01,140 - INFO - 1 change detected
2025-03-26 17:16:01,547 - INFO - 1 change detected
2025-03-26 17:16:01,954 - INFO - 1 change detected
2025-03-26 17:16:02,357 - INFO - 1 change detected
2025-03-26 17:16:02,714 - INFO - 1 change detected
2025-03-26 17:16:03,122 - INFO - 1 change detected
2025-03-26 17:16:03,529 - INFO - 1 change detected
2025-03-26 17:16:03,932 - INFO - 1 change detected
2025-03-26 17:16:04,343 - INFO - 1 change detected
2025-03-26 17:16:04,750 - INFO - 1 change detected
2025-03-26 17:16:05,154 - INFO - 1 change detected
2025-03-26 17:16:05,559 - INFO - 1 change detected
2025-03-26 17:16:05,965 - INFO - 1 change detected
2025-03-26 17:16:06,368 - INFO - 1 change detected
2025-03-26 17:16:06,775 - INFO - 1 change detected
2025-03-26 17:16:07,185 - INFO - 1 change detected
2025-03-26 17:16:07,592 - INFO - 1 change detected
2025-03-26 17:16:07,998 - INFO - 1 change detected
2025-03-26 17:16:08,408 - INFO - 1 change detected
2025-03-26 17:16:08,815 - INFO - 1 change detected
2025-03-26 17:16:09,222 - INFO - 1 change detected
2025-03-26 17:16:09,581 - INFO - 1 change detected
2025-03-26 17:16:09,993 - INFO - 1 change detected
2025-03-26 17:16:10,401 - INFO - 1 change detected
2025-03-26 17:16:10,807 - INFO - 1 change detected
2025-03-26 17:16:11,215 - INFO - 1 change detected
2025-03-26 17:16:11,623 - INFO - 1 change detected
2025-03-26 17:16:11,982 - INFO - 1 change detected
2025-03-26 17:16:12,398 - INFO - 1 change detected
2025-03-26 17:16:12,813 - INFO - 1 change detected
2025-03-26 17:16:13,219 - INFO - 1 change detected
2025-03-26 17:16:13,627 - INFO - 1 change detected
2025-03-26 17:16:13,984 - INFO - 1 change detected
2025-03-26 17:16:14,394 - INFO - 1 change detected
2025-03-26 17:16:14,798 - INFO - 1 change detected
2025-03-26 17:16:15,206 - INFO - 1 change detected
2025-03-26 17:16:15,611 - INFO - 1 change detected
2025-03-26 17:16:15,783 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:16:15,876 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:16:16,017 - INFO - 1 change detected
2025-03-26 17:16:16,426 - INFO - 1 change detected
2025-03-26 17:16:16,863 - INFO - 1 change detected
2025-03-26 17:16:17,273 - INFO - 1 change detected
2025-03-26 17:16:17,676 - INFO - 1 change detected
2025-03-26 17:16:18,082 - INFO - 1 change detected
2025-03-26 17:16:18,486 - INFO - 1 change detected
2025-03-26 17:16:18,891 - INFO - 1 change detected
2025-03-26 17:16:19,009 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:16:19,101 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 17:16:19,107 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:16:19,107 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:16:19,107 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:16:19,124 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:16:19,130 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 17:16:19,138 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 17:16:19,145 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 17:16:19,156 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 17:16:19,296 - INFO - 1 change detected
2025-03-26 17:16:19,660 - INFO - 1 change detected
2025-03-26 17:16:20,069 - INFO - 1 change detected
2025-03-26 17:16:20,473 - INFO - 1 change detected
2025-03-26 17:16:20,881 - INFO - 1 change detected
2025-03-26 17:16:21,286 - INFO - 1 change detected
2025-03-26 17:16:21,692 - INFO - 1 change detected
2025-03-26 17:16:22,100 - INFO - 1 change detected
2025-03-26 17:16:22,508 - INFO - 1 change detected
2025-03-26 17:16:22,917 - INFO - 1 change detected
2025-03-26 17:16:23,323 - INFO - 1 change detected
2025-03-26 17:16:23,732 - INFO - 1 change detected
2025-03-26 17:16:24,143 - INFO - 1 change detected
2025-03-26 17:16:24,550 - INFO - 1 change detected
2025-03-26 17:16:24,953 - INFO - 1 change detected
2025-03-26 17:16:25,308 - INFO - 1 change detected
2025-03-26 17:16:25,720 - INFO - 1 change detected
2025-03-26 17:16:26,129 - INFO - 1 change detected
2025-03-26 17:16:26,537 - INFO - 1 change detected
2025-03-26 17:16:26,945 - INFO - 1 change detected
2025-03-26 17:16:27,301 - INFO - 1 change detected
2025-03-26 17:16:27,710 - INFO - 1 change detected
2025-03-26 17:16:28,120 - INFO - 1 change detected
2025-03-26 17:16:28,533 - INFO - 1 change detected
2025-03-26 17:16:28,941 - INFO - 1 change detected
2025-03-26 17:16:29,299 - INFO - 1 change detected
2025-03-26 17:16:29,712 - INFO - 1 change detected
2025-03-26 17:16:30,118 - INFO - 1 change detected
2025-03-26 17:16:30,528 - INFO - 1 change detected
2025-03-26 17:16:30,936 - INFO - 1 change detected
2025-03-26 17:16:31,340 - INFO - 1 change detected
2025-03-26 17:16:31,745 - INFO - 1 change detected
2025-03-26 17:16:32,150 - INFO - 1 change detected
2025-03-26 17:16:32,553 - INFO - 1 change detected
2025-03-26 17:16:32,910 - INFO - 1 change detected
2025-03-26 17:16:33,305 - INFO - 1 change detected
2025-03-26 17:16:33,715 - INFO - 1 change detected
2025-03-26 17:16:34,119 - INFO - 1 change detected
2025-03-26 17:16:34,528 - INFO - 1 change detected
2025-03-26 17:16:34,935 - INFO - 1 change detected
2025-03-26 17:16:35,341 - INFO - 1 change detected
2025-03-26 17:16:35,750 - INFO - 1 change detected
2025-03-26 17:16:36,155 - INFO - 1 change detected
2025-03-26 17:16:36,558 - INFO - 1 change detected
2025-03-26 17:16:36,966 - INFO - 1 change detected
2025-03-26 17:16:37,373 - INFO - 1 change detected
2025-03-26 17:16:37,777 - INFO - 1 change detected
2025-03-26 17:16:38,184 - INFO - 1 change detected
2025-03-26 17:16:38,591 - INFO - 1 change detected
2025-03-26 17:16:38,999 - INFO - 1 change detected
2025-03-26 17:16:39,406 - INFO - 1 change detected
2025-03-26 17:16:39,814 - INFO - 1 change detected
2025-03-26 17:16:40,220 - INFO - 1 change detected
2025-03-26 17:16:40,628 - INFO - 1 change detected
2025-03-26 17:16:41,036 - INFO - 1 change detected
2025-03-26 17:16:41,394 - INFO - 1 change detected
2025-03-26 17:16:41,806 - INFO - 1 change detected
2025-03-26 17:16:42,215 - INFO - 1 change detected
2025-03-26 17:16:42,624 - INFO - 1 change detected
2025-03-26 17:16:43,029 - INFO - 1 change detected
2025-03-26 17:16:43,438 - INFO - 1 change detected
2025-03-26 17:16:43,844 - INFO - 1 change detected
2025-03-26 17:16:44,250 - INFO - 1 change detected
2025-03-26 17:16:44,656 - INFO - 1 change detected
2025-03-26 17:16:45,062 - INFO - 1 change detected
2025-03-26 17:16:45,468 - INFO - 1 change detected
2025-03-26 17:16:45,874 - INFO - 1 change detected
2025-03-26 17:16:46,286 - INFO - 1 change detected
2025-03-26 17:16:46,701 - INFO - 1 change detected
2025-03-26 17:16:47,107 - INFO - 1 change detected
2025-03-26 17:16:47,519 - INFO - 1 change detected
2025-03-26 17:16:47,921 - INFO - 1 change detected
2025-03-26 17:16:48,324 - INFO - 1 change detected
2025-03-26 17:16:48,726 - INFO - 1 change detected
2025-03-26 17:16:49,139 - INFO - 1 change detected
2025-03-26 17:16:49,546 - INFO - 1 change detected
2025-03-26 17:16:49,904 - INFO - 1 change detected
2025-03-26 17:16:50,317 - INFO - 1 change detected
2025-03-26 17:16:50,723 - INFO - 1 change detected
2025-03-26 17:16:51,083 - INFO - 1 change detected
2025-03-26 17:16:51,523 - INFO - 1 change detected
2025-03-26 17:16:51,989 - INFO - 1 change detected
2025-03-26 17:16:52,355 - INFO - 1 change detected
2025-03-26 17:16:52,765 - INFO - 1 change detected
2025-03-26 17:16:53,168 - INFO - 1 change detected
2025-03-26 17:16:53,572 - INFO - 1 change detected
2025-03-26 17:16:53,977 - INFO - 1 change detected
2025-03-26 17:16:54,386 - INFO - 1 change detected
2025-03-26 17:16:54,792 - INFO - 1 change detected
2025-03-26 17:16:55,203 - INFO - 1 change detected
2025-03-26 17:16:55,609 - INFO - 1 change detected
2025-03-26 17:16:55,965 - INFO - 1 change detected
2025-03-26 17:16:56,377 - INFO - 1 change detected
2025-03-26 17:16:56,781 - INFO - 1 change detected
2025-03-26 17:16:57,186 - INFO - 1 change detected
2025-03-26 17:16:57,594 - INFO - 1 change detected
2025-03-26 17:16:58,001 - INFO - 1 change detected
2025-03-26 17:16:58,411 - INFO - 1 change detected
2025-03-26 17:16:58,818 - INFO - 1 change detected
2025-03-26 17:16:59,222 - INFO - 1 change detected
2025-03-26 17:16:59,631 - INFO - 1 change detected
2025-03-26 17:17:00,039 - INFO - 1 change detected
2025-03-26 17:17:00,400 - INFO - 1 change detected
2025-03-26 17:17:00,812 - INFO - 1 change detected
2025-03-26 17:17:01,222 - INFO - 1 change detected
2025-03-26 17:17:01,631 - INFO - 1 change detected
2025-03-26 17:17:01,989 - INFO - 1 change detected
2025-03-26 17:17:02,400 - INFO - 1 change detected
2025-03-26 17:17:02,808 - INFO - 1 change detected
2025-03-26 17:17:03,217 - INFO - 1 change detected
2025-03-26 17:17:03,577 - INFO - 1 change detected
2025-03-26 17:17:03,990 - INFO - 1 change detected
2025-03-26 17:17:04,395 - INFO - 1 change detected
2025-03-26 17:17:04,802 - INFO - 1 change detected
2025-03-26 17:17:05,207 - INFO - 1 change detected
2025-03-26 17:17:05,615 - INFO - 1 change detected
2025-03-26 17:17:06,021 - INFO - 1 change detected
2025-03-26 17:17:06,379 - INFO - 1 change detected
2025-03-26 17:17:06,791 - INFO - 1 change detected
2025-03-26 17:17:07,195 - INFO - 1 change detected
2025-03-26 17:17:07,600 - INFO - 1 change detected
2025-03-26 17:17:08,006 - INFO - 1 change detected
2025-03-26 17:17:08,413 - INFO - 1 change detected
2025-03-26 17:17:08,822 - INFO - 1 change detected
2025-03-26 17:17:09,177 - INFO - 1 change detected
2025-03-26 17:17:09,586 - INFO - 1 change detected
2025-03-26 17:17:09,837 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:17:09,838 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:17:09,839 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:17:09,839 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:17:09,839 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:17:09,993 - INFO - 1 change detected
2025-03-26 17:17:10,398 - INFO - 1 change detected
2025-03-26 17:17:10,806 - INFO - 1 change detected
2025-03-26 17:17:11,216 - INFO - 1 change detected
2025-03-26 17:17:11,622 - INFO - 1 change detected
2025-03-26 17:17:12,032 - INFO - 1 change detected
2025-03-26 17:17:12,829 - INFO - 1 change detected
2025-03-26 17:17:13,245 - INFO - 1 change detected
2025-03-26 17:17:13,662 - INFO - 1 change detected
2025-03-26 17:17:14,120 - INFO - 1 change detected
2025-03-26 17:19:39,938 - INFO - Shutting down
2025-03-26 17:20:09,961 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:20:09,965 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:20:09,965 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:20:09,965 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:20:09,965 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:20:09,966 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:20:09,966 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:20:09,966 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:20:09,966 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:24:40,052 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,055 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,284 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,296 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,309 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,321 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,333 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,345 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,353 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,360 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,368 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,375 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,383 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,389 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:24:40,398 - INFO - Finished server process [15220]
2025-03-26 17:24:40,488 - ERROR - Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 700, in lifespan
    await receive()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-03-26 17:24:40,494 - INFO - Monitoring task cancelled. Exiting...
2025-03-26 17:24:40,914 - INFO - Stopping reloader process [9460]
2025-03-26 17:26:26,140 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-26 17:26:26,141 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-26 17:26:26,142 - INFO - Started reloader process [29192] using WatchFiles
2025-03-26 17:26:27,808 - INFO - Started server process [3084]
2025-03-26 17:26:27,812 - INFO - Waiting for application startup.
2025-03-26 17:26:27,821 - INFO - Application startup complete.
2025-03-26 17:26:38,278 - INFO - MUSEEEEEEEE2: False
2025-03-26 17:26:38,341 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-26 17:26:38,348 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-26 17:26:38,359 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-26 17:26:41,653 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:26:41,658 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:26:41,726 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:26:41,810 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 17:26:41,825 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:26:41,920 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 17:26:42,004 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 17:26:42,012 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:26:42,016 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 17:26:42,098 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 17:37:21,956 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:37:21,966 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:37:22,853 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:37:22,856 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:37:22,862 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 17:37:22,872 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 17:37:22,875 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:37:22,875 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:37:22,875 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:37:22,898 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 17:37:22,908 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 17:37:22,914 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 17:37:40,194 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:37:40,198 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:37:40,211 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 17:37:40,221 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 17:37:40,226 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:37:40,226 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:37:40,227 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:37:40,247 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 17:37:40,254 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 17:37:40,260 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 17:38:54,467 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:38:54,471 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:38:54,471 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:38:54,471 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:38:54,471 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:38:54,489 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 17:38:54,596 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 17:38:54,604 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 17:38:54,610 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 17:38:54,616 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 17:39:24,640 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 164, in log_requests
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 164, in log_requests
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:39:24,687 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    |     return await future
    |            ^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    |     result = context.run(func, *args)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 157, in requests_breakdown
    |     ).group_by(APIRequest.method).all()
    |                                   ~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    |     return self._iter().all()  # type: ignore
    |            ~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    result = context.run(func, *args)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 157, in requests_breakdown
    ).group_by(APIRequest.method).all()
                                  ~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:39:24,781 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    |     return await future
    |            ^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    |     result = context.run(func, *args)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 188, in performance_trends
    |     ).group_by("hour").order_by("hour").all()
    |                                         ~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    |     return self._iter().all()  # type: ignore
    |            ~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    result = context.run(func, *args)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 188, in performance_trends
    ).group_by("hour").order_by("hour").all()
                                        ~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:39:24,796 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    |     return await future
    |            ^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    |     result = context.run(func, *args)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 172, in failures_breakdown
    |     ).filter(APIRequest.status_code >= 400).group_by(APIRequest.method).all()
    |                                                                         ~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    |     return self._iter().all()  # type: ignore
    |            ~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 213, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 193, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2505, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1005, in run
    result = context.run(func, *args)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\api_analytics.py", line 172, in failures_breakdown
    ).filter(APIRequest.status_code >= 400).group_by(APIRequest.method).all()
                                                                        ~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:54:27,371 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:54:27,375 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:55:27,400 - INFO - Shutting down
2025-03-26 17:55:57,410 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:55:57,411 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:55:57,424 - INFO - Waiting for background tasks to complete. (CTRL+C to force quit)
2025-03-26 17:55:57,426 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 17:55:57,538 - INFO - Waiting for application shutdown.
2025-03-26 17:55:57,545 - INFO - Monitoring task cancelled. Exiting...
2025-03-26 17:55:57,546 - INFO - Application shutdown complete.
2025-03-26 17:55:57,549 - INFO - Finished server process [3084]
2025-03-26 17:55:58,013 - INFO - Stopping reloader process [29192]
2025-03-26 17:56:27,488 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-26 17:56:27,489 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-26 17:56:27,490 - INFO - Started reloader process [15572] using WatchFiles
2025-03-26 17:56:29,088 - INFO - Started server process [2040]
2025-03-26 17:56:29,091 - INFO - Waiting for application startup.
2025-03-26 17:56:29,099 - INFO - Application startup complete.
2025-03-26 17:56:36,527 - INFO - MUSEEEEEEEE2: False
2025-03-26 17:56:36,592 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-26 17:56:36,599 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-26 17:56:36,611 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-26 17:56:39,261 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:39,340 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 17:56:39,347 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:39,347 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:39,347 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:39,347 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:39,624 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 17:56:39,636 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 17:56:39,643 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 17:56:39,649 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 17:56:40,546 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:40,558 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:56:57,834 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:57,840 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:57,849 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 17:56:57,868 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 17:56:57,872 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:57,872 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:57,873 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:57,909 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 17:56:57,923 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 17:56:57,933 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 17:56:59,205 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:56:59,217 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:57:48,212 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:57:48,221 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:57:48,895 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:57:48,901 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 17:57:48,907 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:57:48,907 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:57:48,907 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:57:49,061 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 17:57:49,078 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 17:57:49,093 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 17:57:49,100 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:57:49,109 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 17:57:51,467 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:57:51,475 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:58:03,152 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:58:03,168 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 17:58:03,177 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:58:03,177 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:58:03,177 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:58:03,178 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:58:03,267 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 17:58:03,276 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 17:58:03,283 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 17:58:03,289 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 17:58:03,758 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:58:03,770 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 17:58:04,276 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:58:04,279 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:58:04,282 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:59:04,306 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 17:59:04,306 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:00:34,336 - INFO - Shutting down
2025-03-26 18:00:34,339 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 18:00:34,356 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 18:00:34,362 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 18:00:34,369 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:01:04,373 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 18:01:04,388 - INFO - Finished server process [2040]
2025-03-26 18:01:04,389 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 207, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 18:01:04,406 - ERROR - Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 700, in lifespan
    await receive()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-03-26 18:01:04,410 - INFO - Monitoring task cancelled. Exiting...
2025-03-26 18:01:04,410 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-26 18:01:04,694 - INFO - Stopping reloader process [15572]
2025-03-26 18:02:49,898 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-26 18:02:49,900 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-26 18:02:49,902 - INFO - Started reloader process [17244] using WatchFiles
2025-03-26 18:02:51,875 - INFO - Started server process [20488]
2025-03-26 18:02:51,878 - INFO - Waiting for application startup.
2025-03-26 18:02:51,887 - INFO - Application startup complete.
2025-03-26 18:03:06,953 - INFO - MUSEEEEEEEE2: False
2025-03-26 18:03:07,017 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-26 18:03:07,024 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-26 18:03:07,031 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-26 18:03:08,884 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:03:08,956 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 18:03:10,144 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:03:10,147 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:03:10,319 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 18:03:10,331 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 18:03:10,334 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:03:10,334 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:03:10,334 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:03:10,525 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 18:03:10,534 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 18:03:10,541 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 18:04:10,158 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:04:10,162 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:04:10,162 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:04:10,168 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 18:04:10,181 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 18:04:10,187 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 18:04:10,190 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:04:10,190 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:04:10,212 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 18:04:10,217 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 18:04:30,105 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:04:30,116 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 18:04:30,125 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:04:30,126 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:04:30,126 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:04:30,142 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 18:04:30,149 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 18:04:30,156 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 18:04:30,158 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:04:30,171 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 18:04:41,938 - INFO - Shutting down
2025-03-26 18:04:42,047 - INFO - Waiting for application shutdown.
2025-03-26 18:04:42,048 - INFO - Monitoring task cancelled. Exiting...
2025-03-26 18:04:42,048 - INFO - Application shutdown complete.
2025-03-26 18:04:42,048 - INFO - Finished server process [20488]
2025-03-26 18:04:42,163 - INFO - Stopping reloader process [17244]
2025-03-26 18:13:18,745 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-26 18:13:18,746 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-26 18:13:18,747 - INFO - Started reloader process [1064] using WatchFiles
2025-03-26 18:13:20,274 - INFO - Started server process [7136]
2025-03-26 18:13:20,277 - INFO - Waiting for application startup.
2025-03-26 18:13:20,285 - INFO - Application startup complete.
2025-03-26 18:13:38,817 - INFO - MUSEEEEEEEE2: False
2025-03-26 18:13:38,881 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-26 18:13:38,888 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-26 18:13:38,895 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-26 18:13:40,571 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:13:40,640 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 18:13:41,381 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:13:41,464 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 18:13:41,470 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:13:41,470 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:13:41,470 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:13:41,470 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:13:41,662 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 18:13:41,669 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 18:13:41,676 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 18:13:41,681 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 18:13:54,996 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:13:55,002 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:13:55,009 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:13:55,009 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:13:55,009 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:13:55,021 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 18:13:55,131 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 18:13:55,149 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 18:13:55,156 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 18:13:55,161 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 18:13:57,896 - INFO - Shutting down
2025-03-26 18:13:58,007 - INFO - Waiting for application shutdown.
2025-03-26 18:13:58,008 - INFO - Monitoring task cancelled. Exiting...
2025-03-26 18:13:58,008 - INFO - Application shutdown complete.
2025-03-26 18:13:58,009 - INFO - Finished server process [7136]
2025-03-26 18:13:58,292 - INFO - Stopping reloader process [1064]
2025-03-26 18:27:42,124 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-26 18:27:42,126 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-26 18:27:42,127 - INFO - Started reloader process [27784] using WatchFiles
2025-03-26 18:27:44,494 - INFO - Started server process [11908]
2025-03-26 18:27:44,497 - INFO - Waiting for application startup.
2025-03-26 18:27:44,509 - INFO - Application startup complete.
2025-03-26 18:27:53,804 - INFO - MUSEEEEEEEE2: False
2025-03-26 18:27:53,869 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-26 18:27:53,876 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-26 18:27:53,883 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-26 18:27:55,742 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:27:55,743 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:27:55,806 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:27:55,807 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:27:55,982 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-26 18:27:55,987 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-26 18:27:55,992 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-26 18:27:55,996 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-26 18:28:06,636 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:28:06,648 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-26 18:28:06,657 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:28:06,657 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:28:06,657 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:28:06,791 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-26 18:28:06,800 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-26 18:28:06,806 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-26 18:29:18,399 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:29:18,414 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-26 18:29:18,490 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:29:18,500 - INFO - Logged request from IP bro 127.0.0.1 to /favicon.ico
2025-03-26 18:30:20,781 - INFO - 1 change detected
2025-03-26 18:30:20,783 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-26 18:30:32,269 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:30:32,395 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-26 18:30:32,401 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:30:32,401 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:30:32,401 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:30:32,534 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-26 18:30:32,543 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-26 18:30:32,553 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-26 18:30:32,670 - INFO - Shutting down
2025-03-26 18:30:32,779 - INFO - Waiting for application shutdown.
2025-03-26 18:30:32,780 - INFO - Monitoring task cancelled. Exiting...
2025-03-26 18:30:32,780 - INFO - Application shutdown complete.
2025-03-26 18:30:32,781 - INFO - Finished server process [11908]
2025-03-26 18:30:33,397 - INFO - 2 changes detected
2025-03-26 18:30:33,397 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-26 18:30:35,192 - INFO - 6 changes detected
2025-03-26 18:30:36,407 - INFO - 1 change detected
2025-03-26 18:30:36,769 - INFO - 1 change detected
2025-03-26 18:30:37,132 - INFO - 1 change detected
2025-03-26 18:30:37,544 - INFO - 1 change detected
2025-03-26 18:30:37,950 - INFO - 1 change detected
2025-03-26 18:30:38,352 - INFO - 1 change detected
2025-03-26 18:30:38,713 - INFO - 1 change detected
2025-03-26 18:30:39,120 - INFO - 1 change detected
2025-03-26 18:30:39,526 - INFO - 1 change detected
2025-03-26 18:30:39,931 - INFO - 1 change detected
2025-03-26 18:30:40,336 - INFO - 1 change detected
2025-03-26 18:30:40,739 - INFO - 1 change detected
2025-03-26 18:30:41,146 - INFO - 1 change detected
2025-03-26 18:30:41,504 - INFO - 1 change detected
2025-03-26 18:30:41,914 - INFO - 1 change detected
2025-03-26 18:30:42,316 - INFO - 1 change detected
2025-03-26 18:30:42,721 - INFO - 1 change detected
2025-03-26 18:30:43,130 - INFO - 1 change detected
2025-03-26 18:30:43,542 - INFO - 1 change detected
2025-03-26 18:30:43,946 - INFO - 1 change detected
2025-03-26 18:30:44,350 - INFO - 1 change detected
2025-03-26 18:30:44,754 - INFO - 1 change detected
2025-03-26 18:30:45,160 - INFO - 1 change detected
2025-03-26 18:30:45,517 - INFO - 1 change detected
2025-03-26 18:30:45,929 - INFO - 1 change detected
2025-03-26 18:30:46,334 - INFO - 1 change detected
2025-03-26 18:30:46,735 - INFO - 1 change detected
2025-03-26 18:30:47,141 - INFO - 1 change detected
2025-03-26 18:30:47,549 - INFO - 1 change detected
2025-03-26 18:30:47,908 - INFO - 1 change detected
2025-03-26 18:30:48,317 - INFO - 1 change detected
2025-03-26 18:30:48,724 - INFO - 1 change detected
2025-03-26 18:30:49,131 - INFO - 1 change detected
2025-03-26 18:30:49,540 - INFO - 1 change detected
2025-03-26 18:30:49,941 - INFO - 1 change detected
2025-03-26 18:30:50,350 - INFO - 1 change detected
2025-03-26 18:30:50,707 - INFO - 1 change detected
2025-03-26 18:30:51,117 - INFO - 1 change detected
2025-03-26 18:30:51,525 - INFO - 1 change detected
2025-03-26 18:30:51,932 - INFO - 1 change detected
2025-03-26 18:30:52,339 - INFO - 1 change detected
2025-03-26 18:30:52,697 - INFO - 1 change detected
2025-03-26 18:30:53,103 - INFO - 1 change detected
2025-03-26 18:30:53,505 - INFO - 1 change detected
2025-03-26 18:30:53,913 - INFO - 1 change detected
2025-03-26 18:30:54,317 - INFO - 1 change detected
2025-03-26 18:30:54,724 - INFO - 1 change detected
2025-03-26 18:30:55,130 - INFO - 1 change detected
2025-03-26 18:30:55,533 - INFO - 1 change detected
2025-03-26 18:30:55,938 - INFO - 1 change detected
2025-03-26 18:30:56,341 - INFO - 1 change detected
2025-03-26 18:30:56,745 - INFO - 1 change detected
2025-03-26 18:30:57,155 - INFO - 1 change detected
2025-03-26 18:30:57,559 - INFO - 1 change detected
2025-03-26 18:30:57,964 - INFO - 1 change detected
2025-03-26 18:30:58,369 - INFO - 1 change detected
2025-03-26 18:30:58,779 - INFO - 1 change detected
2025-03-26 18:30:59,184 - INFO - 1 change detected
2025-03-26 18:30:59,589 - INFO - 1 change detected
2025-03-26 18:30:59,948 - INFO - 1 change detected
2025-03-26 18:31:00,360 - INFO - 2 changes detected
2025-03-26 18:31:00,360 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-26 18:31:00,782 - INFO - 1 change detected
2025-03-26 18:31:01,190 - INFO - 1 change detected
2025-03-26 18:31:01,549 - INFO - 1 change detected
2025-03-26 18:31:01,956 - INFO - 1 change detected
2025-03-26 18:31:02,312 - INFO - 6 changes detected
2025-03-26 18:31:02,670 - INFO - 1 change detected
2025-03-26 18:31:03,029 - INFO - 1 change detected
2025-03-26 18:31:03,387 - INFO - 1 change detected
2025-03-26 18:31:03,797 - INFO - 1 change detected
2025-03-26 18:31:04,201 - INFO - 1 change detected
2025-03-26 18:31:04,606 - INFO - 1 change detected
2025-03-26 18:31:05,012 - INFO - 1 change detected
2025-03-26 18:31:05,416 - INFO - 1 change detected
2025-03-26 18:31:05,823 - INFO - 1 change detected
2025-03-26 18:31:06,230 - INFO - 1 change detected
2025-03-26 18:31:06,633 - INFO - 1 change detected
2025-03-26 18:31:06,991 - INFO - 1 change detected
2025-03-26 18:31:07,400 - INFO - 1 change detected
2025-03-26 18:31:07,806 - INFO - 1 change detected
2025-03-26 18:31:08,211 - INFO - 1 change detected
2025-03-26 18:31:08,617 - INFO - 1 change detected
2025-03-26 18:31:09,023 - INFO - 1 change detected
2025-03-26 18:31:09,430 - INFO - 1 change detected
2025-03-26 18:31:09,836 - INFO - 1 change detected
2025-03-26 18:31:10,245 - INFO - 1 change detected
2025-03-26 18:31:10,601 - INFO - 1 change detected
2025-03-26 18:31:11,008 - INFO - 1 change detected
2025-03-26 18:31:11,412 - INFO - 1 change detected
2025-03-26 18:31:11,816 - INFO - 1 change detected
2025-03-26 18:31:12,224 - INFO - 1 change detected
2025-03-26 18:31:12,630 - INFO - 1 change detected
2025-03-26 18:31:13,039 - INFO - 1 change detected
2025-03-26 18:31:13,447 - INFO - 1 change detected
2025-03-26 18:31:13,854 - INFO - 1 change detected
2025-03-26 18:31:14,261 - INFO - 1 change detected
2025-03-26 18:31:14,619 - INFO - 1 change detected
2025-03-26 18:31:15,027 - INFO - 1 change detected
2025-03-26 18:31:15,433 - INFO - 1 change detected
2025-03-26 18:31:15,836 - INFO - 1 change detected
2025-03-26 18:31:16,243 - INFO - 1 change detected
2025-03-26 18:31:16,654 - INFO - 1 change detected
2025-03-26 18:31:17,059 - INFO - 1 change detected
2025-03-26 18:31:17,416 - INFO - 1 change detected
2025-03-26 18:31:17,827 - INFO - 1 change detected
2025-03-26 18:31:18,233 - INFO - 1 change detected
2025-03-26 18:31:18,639 - INFO - 1 change detected
2025-03-26 18:31:19,047 - INFO - 1 change detected
2025-03-26 18:31:19,454 - INFO - 1 change detected
2025-03-26 18:31:19,861 - INFO - 1 change detected
2025-03-26 18:31:20,266 - INFO - 1 change detected
2025-03-26 18:31:20,675 - INFO - 1 change detected
2025-03-26 18:31:21,031 - INFO - 1 change detected
2025-03-26 18:31:21,442 - INFO - 1 change detected
2025-03-26 18:31:21,849 - INFO - 1 change detected
2025-03-26 18:31:22,256 - INFO - 1 change detected
2025-03-26 18:31:22,660 - INFO - 1 change detected
2025-03-26 18:31:23,069 - INFO - 1 change detected
2025-03-26 18:31:23,474 - INFO - 1 change detected
2025-03-26 18:31:23,830 - INFO - 1 change detected
2025-03-26 18:31:24,191 - INFO - 1 change detected
2025-03-26 18:31:24,191 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-26 18:31:24,551 - INFO - 1 change detected
2025-03-26 18:31:24,913 - INFO - 1 change detected
2025-03-26 18:31:25,322 - INFO - 1 change detected
2025-03-26 18:31:25,683 - INFO - 1 change detected
2025-03-26 18:31:26,094 - INFO - 6 changes detected
2025-03-26 18:31:26,167 - INFO - Started server process [25244]
2025-03-26 18:31:26,170 - INFO - Waiting for application startup.
2025-03-26 18:31:26,183 - INFO - Application startup complete.
2025-03-26 18:31:26,192 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:31:26,270 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-26 18:31:26,501 - INFO - 1 change detected
2025-03-26 18:31:26,910 - INFO - 1 change detected
2025-03-26 18:31:27,269 - INFO - 1 change detected
2025-03-26 18:31:27,318 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:31:27,324 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:31:27,454 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-26 18:31:27,462 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-26 18:31:27,467 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:31:27,467 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:31:27,594 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-26 18:31:27,600 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-26 18:31:27,681 - INFO - 1 change detected
2025-03-26 18:31:28,085 - INFO - 1 change detected
2025-03-26 18:31:28,494 - INFO - 1 change detected
2025-03-26 18:31:28,900 - INFO - 1 change detected
2025-03-26 18:31:29,308 - INFO - 1 change detected
2025-03-26 18:31:29,715 - INFO - 1 change detected
2025-03-26 18:31:30,118 - INFO - 1 change detected
2025-03-26 18:31:30,525 - INFO - 1 change detected
2025-03-26 18:31:30,932 - INFO - 1 change detected
2025-03-26 18:31:31,339 - INFO - 1 change detected
2025-03-26 18:31:31,742 - INFO - 1 change detected
2025-03-26 18:31:32,150 - INFO - 1 change detected
2025-03-26 18:31:32,555 - INFO - 1 change detected
2025-03-26 18:31:32,960 - INFO - 1 change detected
2025-03-26 18:31:33,317 - INFO - 1 change detected
2025-03-26 18:31:33,727 - INFO - 1 change detected
2025-03-26 18:31:34,132 - INFO - 1 change detected
2025-03-26 18:31:34,536 - INFO - 1 change detected
2025-03-26 18:31:34,940 - INFO - 1 change detected
2025-03-26 18:31:35,345 - INFO - 1 change detected
2025-03-26 18:31:35,750 - INFO - 1 change detected
2025-03-26 18:31:36,158 - INFO - 1 change detected
2025-03-26 18:31:36,561 - INFO - 1 change detected
2025-03-26 18:31:36,968 - INFO - 1 change detected
2025-03-26 18:31:37,372 - INFO - 1 change detected
2025-03-26 18:31:37,778 - INFO - 1 change detected
2025-03-26 18:31:38,184 - INFO - 1 change detected
2025-03-26 18:31:38,588 - INFO - 1 change detected
2025-03-26 18:31:38,992 - INFO - 1 change detected
2025-03-26 18:31:39,399 - INFO - 1 change detected
2025-03-26 18:31:39,801 - INFO - 1 change detected
2025-03-26 18:31:40,159 - INFO - 1 change detected
2025-03-26 18:31:40,569 - INFO - 1 change detected
2025-03-26 18:31:40,972 - INFO - 1 change detected
2025-03-26 18:31:41,381 - INFO - 1 change detected
2025-03-26 18:31:41,785 - INFO - 1 change detected
2025-03-26 18:31:42,191 - INFO - 1 change detected
2025-03-26 18:31:42,602 - INFO - 1 change detected
2025-03-26 18:31:43,004 - INFO - 1 change detected
2025-03-26 18:31:43,412 - INFO - 1 change detected
2025-03-26 18:31:43,818 - INFO - 1 change detected
2025-03-26 18:31:44,222 - INFO - 1 change detected
2025-03-26 18:31:44,628 - INFO - 1 change detected
2025-03-26 18:31:45,032 - INFO - 1 change detected
2025-03-26 18:31:45,386 - INFO - 1 change detected
2025-03-26 18:31:45,798 - INFO - 1 change detected
2025-03-26 18:31:46,205 - INFO - 1 change detected
2025-03-26 18:31:46,607 - INFO - 1 change detected
2025-03-26 18:31:47,012 - INFO - 1 change detected
2025-03-26 18:31:47,418 - INFO - 1 change detected
2025-03-26 18:31:47,828 - INFO - 1 change detected
2025-03-26 18:31:48,235 - INFO - 1 change detected
2025-03-26 18:31:48,640 - INFO - 1 change detected
2025-03-26 18:31:49,046 - INFO - 1 change detected
2025-03-26 18:31:49,402 - INFO - 1 change detected
2025-03-26 18:31:49,815 - INFO - 1 change detected
2025-03-26 18:31:50,221 - INFO - 1 change detected
2025-03-26 18:31:50,623 - INFO - 1 change detected
2025-03-26 18:31:51,029 - INFO - 1 change detected
2025-03-26 18:31:51,433 - INFO - 1 change detected
2025-03-26 18:31:51,842 - INFO - 1 change detected
2025-03-26 18:31:52,247 - INFO - 1 change detected
2025-03-26 18:31:52,651 - INFO - 1 change detected
2025-03-26 18:31:53,055 - INFO - 1 change detected
2025-03-26 18:31:53,461 - INFO - 1 change detected
2025-03-26 18:31:53,863 - INFO - 1 change detected
2025-03-26 18:31:54,219 - INFO - 1 change detected
2025-03-26 18:31:54,630 - INFO - 1 change detected
2025-03-26 18:31:55,039 - INFO - 1 change detected
2025-03-26 18:31:55,455 - INFO - 1 change detected
2025-03-26 18:31:55,860 - INFO - 1 change detected
2025-03-26 18:31:56,219 - INFO - 1 change detected
2025-03-26 18:31:56,631 - INFO - 1 change detected
2025-03-26 18:31:57,037 - INFO - 1 change detected
2025-03-26 18:31:57,444 - INFO - 1 change detected
2025-03-26 18:31:57,851 - INFO - 1 change detected
2025-03-26 18:31:58,258 - INFO - 1 change detected
2025-03-26 18:31:58,616 - INFO - 1 change detected
2025-03-26 18:31:59,028 - INFO - 1 change detected
2025-03-26 18:31:59,433 - INFO - 1 change detected
2025-03-26 18:31:59,836 - INFO - 1 change detected
2025-03-26 18:32:00,242 - INFO - 1 change detected
2025-03-26 18:32:00,652 - INFO - 1 change detected
2025-03-26 18:32:01,059 - INFO - 1 change detected
2025-03-26 18:32:01,465 - INFO - 1 change detected
2025-03-26 18:32:01,874 - INFO - 1 change detected
2025-03-26 18:32:02,281 - INFO - 1 change detected
2025-03-26 18:32:02,686 - INFO - 1 change detected
2025-03-26 18:32:03,051 - INFO - 1 change detected
2025-03-26 18:32:03,457 - INFO - 1 change detected
2025-03-26 18:32:03,863 - INFO - 1 change detected
2025-03-26 18:32:04,267 - INFO - 1 change detected
2025-03-26 18:32:04,674 - INFO - 1 change detected
2025-03-26 18:32:05,080 - INFO - 1 change detected
2025-03-26 18:32:05,488 - INFO - 1 change detected
2025-03-26 18:32:05,896 - INFO - 1 change detected
2025-03-26 18:32:06,262 - INFO - 1 change detected
2025-03-26 18:32:06,672 - INFO - 1 change detected
2025-03-26 18:32:07,079 - INFO - 1 change detected
2025-03-26 18:32:07,079 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:32:07,087 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-26 18:32:07,490 - INFO - 1 change detected
2025-03-26 18:32:07,896 - INFO - 1 change detected
2025-03-26 18:32:08,303 - INFO - 1 change detected
2025-03-26 18:32:08,711 - INFO - 1 change detected
2025-03-26 18:32:09,122 - INFO - 1 change detected
2025-03-26 18:32:09,526 - INFO - 1 change detected
2025-03-26 18:32:09,929 - INFO - 1 change detected
2025-03-26 18:32:10,335 - INFO - 1 change detected
2025-03-26 18:32:10,693 - INFO - 1 change detected
2025-03-26 18:32:11,102 - INFO - 1 change detected
2025-03-26 18:32:11,507 - INFO - 1 change detected
2025-03-26 18:32:11,911 - INFO - 1 change detected
2025-03-26 18:32:12,318 - INFO - 1 change detected
2025-03-26 18:32:12,725 - INFO - 1 change detected
2025-03-26 18:32:13,128 - INFO - 1 change detected
2025-03-26 18:32:13,530 - INFO - 1 change detected
2025-03-26 18:32:13,932 - INFO - 1 change detected
2025-03-26 18:32:14,337 - INFO - 1 change detected
2025-03-26 18:32:14,745 - INFO - 1 change detected
2025-03-26 18:32:15,149 - INFO - 1 change detected
2025-03-26 18:32:15,557 - INFO - 1 change detected
2025-03-26 18:32:15,963 - INFO - 1 change detected
2025-03-26 18:32:16,367 - INFO - 1 change detected
2025-03-26 18:32:16,771 - INFO - 1 change detected
2025-03-26 18:32:17,176 - INFO - 1 change detected
2025-03-26 18:32:17,583 - INFO - 1 change detected
2025-03-26 18:32:17,991 - INFO - 1 change detected
2025-03-26 18:32:18,397 - INFO - 1 change detected
2025-03-26 18:32:18,755 - INFO - 1 change detected
2025-03-26 18:32:19,164 - INFO - 1 change detected
2025-03-26 18:32:19,570 - INFO - 1 change detected
2025-03-26 18:32:19,974 - INFO - 1 change detected
2025-03-26 18:32:20,381 - INFO - 1 change detected
2025-03-26 18:32:20,787 - INFO - 1 change detected
2025-03-26 18:32:21,195 - INFO - 1 change detected
2025-03-26 18:32:21,603 - INFO - 1 change detected
2025-03-26 18:32:22,010 - INFO - 1 change detected
2025-03-26 18:32:22,414 - INFO - 1 change detected
2025-03-26 18:32:22,820 - INFO - 1 change detected
2025-03-26 18:32:23,225 - INFO - 1 change detected
2025-03-26 18:32:23,630 - INFO - 1 change detected
2025-03-26 18:32:24,035 - INFO - 1 change detected
2025-03-26 18:32:24,441 - INFO - 1 change detected
2025-03-26 18:32:24,847 - INFO - 1 change detected
2025-03-26 18:32:25,253 - INFO - 1 change detected
2025-03-26 18:32:25,612 - INFO - 1 change detected
2025-03-26 18:32:26,020 - INFO - 1 change detected
2025-03-26 18:32:26,423 - INFO - 1 change detected
2025-03-26 18:32:26,829 - INFO - 1 change detected
2025-03-26 18:32:27,236 - INFO - 1 change detected
2025-03-26 18:32:27,646 - INFO - 1 change detected
2025-03-26 18:32:28,054 - INFO - 1 change detected
2025-03-26 18:32:28,412 - INFO - 1 change detected
2025-03-26 18:32:28,822 - INFO - 1 change detected
2025-03-26 18:32:29,231 - INFO - 1 change detected
2025-03-26 18:32:29,636 - INFO - 1 change detected
2025-03-26 18:32:30,041 - INFO - 1 change detected
2025-03-26 18:32:30,449 - INFO - 1 change detected
2025-03-26 18:32:30,856 - INFO - 1 change detected
2025-03-26 18:32:31,264 - INFO - 1 change detected
2025-03-26 18:32:31,667 - INFO - 1 change detected
2025-03-26 18:32:32,074 - INFO - 1 change detected
2025-03-26 18:32:32,433 - INFO - 1 change detected
2025-03-26 18:32:32,846 - INFO - 1 change detected
2025-03-26 18:32:33,249 - INFO - 1 change detected
2025-03-26 18:32:33,657 - INFO - 1 change detected
2025-03-26 18:32:34,069 - INFO - 1 change detected
2025-03-26 18:32:34,475 - INFO - 1 change detected
2025-03-26 18:32:34,833 - INFO - 1 change detected
2025-03-26 18:32:35,240 - INFO - 1 change detected
2025-03-26 18:32:35,647 - INFO - 1 change detected
2025-03-26 18:32:36,056 - INFO - 1 change detected
2025-03-26 18:32:36,417 - INFO - 1 change detected
2025-03-26 18:32:36,830 - INFO - 1 change detected
2025-03-26 18:32:37,233 - INFO - 1 change detected
2025-03-26 18:32:37,639 - INFO - 1 change detected
2025-03-26 18:32:38,049 - INFO - 1 change detected
2025-03-26 18:32:38,457 - INFO - 1 change detected
2025-03-26 18:32:38,863 - INFO - 1 change detected
2025-03-26 18:32:39,223 - INFO - 1 change detected
2025-03-26 18:32:39,634 - INFO - 1 change detected
2025-03-26 18:32:40,040 - INFO - 1 change detected
2025-03-26 18:32:40,445 - INFO - 1 change detected
2025-03-26 18:32:40,854 - INFO - 1 change detected
2025-03-26 18:32:41,214 - INFO - 1 change detected
2025-03-26 18:32:41,627 - INFO - 1 change detected
2025-03-26 18:32:42,033 - INFO - 1 change detected
2025-03-26 18:32:42,439 - INFO - 1 change detected
2025-03-26 18:32:42,846 - INFO - 1 change detected
2025-03-26 18:32:43,256 - INFO - 1 change detected
2025-03-26 18:32:43,659 - INFO - 1 change detected
2025-03-26 18:32:44,064 - INFO - 1 change detected
2025-03-26 18:32:44,520 - INFO - 1 change detected
2025-03-26 18:32:44,877 - INFO - 1 change detected
2025-03-26 18:32:45,337 - INFO - 1 change detected
2025-03-26 18:32:45,742 - INFO - 1 change detected
2025-03-26 18:32:46,148 - INFO - 1 change detected
2025-03-26 18:32:46,557 - INFO - 1 change detected
2025-03-26 18:32:46,961 - INFO - 1 change detected
2025-03-26 18:32:47,368 - INFO - 1 change detected
2025-03-26 18:32:47,774 - INFO - 1 change detected
2025-03-26 18:32:48,177 - INFO - 1 change detected
2025-03-26 18:32:48,584 - INFO - 1 change detected
2025-03-26 18:32:48,993 - INFO - 1 change detected
2025-03-26 18:32:49,354 - INFO - 1 change detected
2025-03-26 18:32:49,762 - INFO - 1 change detected
2025-03-26 18:32:50,170 - INFO - 1 change detected
2025-03-26 18:32:50,575 - INFO - 1 change detected
2025-03-26 18:32:50,979 - INFO - 1 change detected
2025-03-26 18:32:51,390 - INFO - 1 change detected
2025-03-26 18:32:51,795 - INFO - 1 change detected
2025-03-26 18:32:52,199 - INFO - 1 change detected
2025-03-26 18:32:52,606 - INFO - 1 change detected
2025-03-26 18:32:53,009 - INFO - 1 change detected
2025-03-26 18:32:53,415 - INFO - 1 change detected
2025-03-26 18:32:53,821 - INFO - 1 change detected
2025-03-26 18:32:54,227 - INFO - 1 change detected
2025-03-26 18:32:54,632 - INFO - 1 change detected
2025-03-26 18:32:55,037 - INFO - 1 change detected
2025-03-26 18:32:55,440 - INFO - 1 change detected
2025-03-26 18:32:55,846 - INFO - 1 change detected
2025-03-26 18:32:56,250 - INFO - 1 change detected
2025-03-26 18:32:56,654 - INFO - 1 change detected
2025-03-26 18:32:57,061 - INFO - 1 change detected
2025-03-26 18:32:57,467 - INFO - 1 change detected
2025-03-26 18:32:57,883 - INFO - 1 change detected
2025-03-26 18:32:58,289 - INFO - 1 change detected
2025-03-26 18:32:58,691 - INFO - 1 change detected
2025-03-26 18:32:59,048 - INFO - 1 change detected
2025-03-26 18:32:59,455 - INFO - 1 change detected
2025-03-26 18:32:59,858 - INFO - 1 change detected
2025-03-26 18:33:00,265 - INFO - 1 change detected
2025-03-26 18:33:00,674 - INFO - 1 change detected
2025-03-26 18:33:01,033 - INFO - 1 change detected
2025-03-26 18:33:01,443 - INFO - 1 change detected
2025-03-26 18:33:01,848 - INFO - 1 change detected
2025-03-26 18:33:02,251 - INFO - 1 change detected
2025-03-26 18:33:02,658 - INFO - 1 change detected
2025-03-26 18:33:03,061 - INFO - 1 change detected
2025-03-26 18:33:03,465 - INFO - 1 change detected
2025-03-26 18:33:03,873 - INFO - 1 change detected
2025-03-26 18:33:04,278 - INFO - 1 change detected
2025-03-26 18:33:04,684 - INFO - 1 change detected
2025-03-26 18:33:05,090 - INFO - 1 change detected
2025-03-26 18:33:05,497 - INFO - 1 change detected
2025-03-26 18:33:05,856 - INFO - 1 change detected
2025-03-26 18:33:06,265 - INFO - 1 change detected
2025-03-26 18:33:06,667 - INFO - 1 change detected
2025-03-26 18:33:07,073 - INFO - 1 change detected
2025-03-26 18:33:07,477 - INFO - 1 change detected
2025-03-26 18:33:07,881 - INFO - 1 change detected
2025-03-26 18:33:08,288 - INFO - 1 change detected
2025-03-26 18:33:08,695 - INFO - 1 change detected
2025-03-26 18:33:09,101 - INFO - 1 change detected
2025-03-26 18:33:09,506 - INFO - 1 change detected
2025-03-26 18:33:09,911 - INFO - 1 change detected
2025-03-26 18:33:10,316 - INFO - 1 change detected
2025-03-26 18:33:10,721 - INFO - 1 change detected
2025-03-26 18:33:11,128 - INFO - 1 change detected
2025-03-26 18:33:11,536 - INFO - 1 change detected
2025-03-26 18:33:11,939 - INFO - 1 change detected
2025-03-26 18:33:12,296 - INFO - 1 change detected
2025-03-26 18:33:12,707 - INFO - 1 change detected
2025-03-26 18:33:13,111 - INFO - 1 change detected
2025-03-26 18:33:13,522 - INFO - 1 change detected
2025-03-26 18:33:13,929 - INFO - 1 change detected
2025-03-26 18:33:14,335 - INFO - 1 change detected
2025-03-26 18:33:14,743 - INFO - 1 change detected
2025-03-26 18:33:15,099 - INFO - 1 change detected
2025-03-26 18:33:15,508 - INFO - 1 change detected
2025-03-26 18:33:15,917 - INFO - 1 change detected
2025-03-26 18:33:16,322 - INFO - 1 change detected
2025-03-26 18:33:16,727 - INFO - 1 change detected
2025-03-26 18:33:17,131 - INFO - 1 change detected
2025-03-26 18:33:17,539 - INFO - 1 change detected
2025-03-26 18:33:17,947 - INFO - 1 change detected
2025-03-26 18:33:18,356 - INFO - 1 change detected
2025-03-26 18:33:18,714 - INFO - 1 change detected
2025-03-26 18:33:19,128 - INFO - 1 change detected
2025-03-26 18:33:19,537 - INFO - 1 change detected
2025-03-26 18:33:19,896 - INFO - 1 change detected
2025-03-26 18:33:20,310 - INFO - 1 change detected
2025-03-26 18:33:20,717 - INFO - 1 change detected
2025-03-26 18:33:21,076 - INFO - 1 change detected
2025-03-26 18:33:21,487 - INFO - 1 change detected
2025-03-26 18:33:21,893 - INFO - 1 change detected
2025-03-26 18:33:22,298 - INFO - 1 change detected
2025-03-26 18:33:22,702 - INFO - 1 change detected
2025-03-26 18:33:23,108 - INFO - 1 change detected
2025-03-26 18:33:23,516 - INFO - 1 change detected
2025-03-26 18:33:23,922 - INFO - 1 change detected
2025-03-26 18:33:24,327 - INFO - 1 change detected
2025-03-26 18:33:24,731 - INFO - 1 change detected
2025-03-26 18:33:25,135 - INFO - 1 change detected
2025-03-26 18:33:25,541 - INFO - 1 change detected
2025-03-26 18:33:25,948 - INFO - 1 change detected
2025-03-26 18:33:26,352 - INFO - 1 change detected
2025-03-26 18:33:26,711 - INFO - 1 change detected
2025-03-26 18:33:27,123 - INFO - 1 change detected
2025-03-26 18:33:27,532 - INFO - 1 change detected
2025-03-26 18:33:27,937 - INFO - 1 change detected
2025-03-26 18:33:28,340 - INFO - 1 change detected
2025-03-26 18:33:28,746 - INFO - 1 change detected
2025-03-26 18:33:29,152 - INFO - 1 change detected
2025-03-26 18:33:29,556 - INFO - 1 change detected
2025-03-26 18:33:29,949 - INFO - 1 change detected
2025-03-26 18:33:30,413 - INFO - 1 change detected
2025-03-26 18:33:30,776 - INFO - 1 change detected
2025-03-26 18:33:31,186 - INFO - 1 change detected
2025-03-26 18:33:31,590 - INFO - 1 change detected
2025-03-26 18:33:31,996 - INFO - 1 change detected
2025-03-26 18:33:32,400 - INFO - 1 change detected
2025-03-26 18:33:32,807 - INFO - 1 change detected
2025-03-26 18:33:33,337 - INFO - 1 change detected
2025-03-26 18:33:33,697 - INFO - 1 change detected
2025-03-26 18:33:34,052 - INFO - 1 change detected
2025-03-26 18:33:34,459 - INFO - 1 change detected
2025-03-26 18:33:34,866 - INFO - 1 change detected
2025-03-26 18:33:35,275 - INFO - 1 change detected
2025-03-26 18:33:35,679 - INFO - 1 change detected
2025-03-26 18:33:36,085 - INFO - 1 change detected
2025-03-26 18:33:36,491 - INFO - 1 change detected
2025-03-26 18:33:36,896 - INFO - 1 change detected
2025-03-26 18:33:37,300 - INFO - 1 change detected
2025-03-26 18:33:37,706 - INFO - 1 change detected
2025-03-26 18:33:38,111 - INFO - 1 change detected
2025-03-26 18:33:38,513 - INFO - 1 change detected
2025-03-26 18:33:38,871 - INFO - 1 change detected
2025-03-26 18:33:39,278 - INFO - 1 change detected
2025-03-26 18:33:39,688 - INFO - 1 change detected
2025-03-26 18:33:40,092 - INFO - 1 change detected
2025-03-26 18:33:40,446 - INFO - 1 change detected
2025-03-26 18:33:40,855 - INFO - 1 change detected
2025-03-26 18:33:41,262 - INFO - 1 change detected
2025-03-26 18:33:41,664 - INFO - 1 change detected
2025-03-26 18:33:42,070 - INFO - 1 change detected
2025-03-26 18:33:42,477 - INFO - 1 change detected
2025-03-26 18:33:42,891 - INFO - 1 change detected
2025-03-26 18:33:43,297 - INFO - 1 change detected
2025-03-26 18:33:43,703 - INFO - 1 change detected
2025-03-26 18:33:44,106 - INFO - 1 change detected
2025-03-26 18:33:44,513 - INFO - 1 change detected
2025-03-26 18:33:44,921 - INFO - 1 change detected
2025-03-26 18:33:45,324 - INFO - 1 change detected
2025-03-26 18:33:45,728 - INFO - 1 change detected
2025-03-26 18:33:46,137 - INFO - 1 change detected
2025-03-26 18:33:46,553 - INFO - 1 change detected
2025-03-26 18:33:46,961 - INFO - 1 change detected
2025-03-26 18:33:47,365 - INFO - 1 change detected
2025-03-26 18:33:47,724 - INFO - 1 change detected
2025-03-26 18:33:48,132 - INFO - 1 change detected
2025-03-26 18:33:48,539 - INFO - 1 change detected
2025-03-26 18:33:48,944 - INFO - 1 change detected
2025-03-26 18:33:49,354 - INFO - 1 change detected
2025-03-26 18:33:49,756 - INFO - 1 change detected
2025-03-26 18:33:50,163 - INFO - 1 change detected
2025-03-26 18:33:50,567 - INFO - 1 change detected
2025-03-26 18:33:50,975 - INFO - 1 change detected
2025-03-26 18:33:51,379 - INFO - 1 change detected
2025-03-26 18:33:51,784 - INFO - 1 change detected
2025-03-26 18:33:52,190 - INFO - 1 change detected
2025-03-26 18:33:52,594 - INFO - 1 change detected
2025-03-26 18:33:53,002 - INFO - 1 change detected
2025-03-26 18:33:53,408 - INFO - 1 change detected
2025-03-26 18:33:53,815 - INFO - 1 change detected
2025-03-26 18:33:54,218 - INFO - 1 change detected
2025-03-26 18:33:54,576 - INFO - 1 change detected
2025-03-26 18:33:54,985 - INFO - 1 change detected
2025-03-26 18:33:55,390 - INFO - 1 change detected
2025-03-26 18:33:55,797 - INFO - 1 change detected
2025-03-26 18:33:56,255 - INFO - 1 change detected
2025-03-26 18:33:56,709 - INFO - 1 change detected
2025-03-26 18:33:57,123 - INFO - 1 change detected
2025-03-26 18:33:57,530 - INFO - 1 change detected
2025-03-26 18:33:57,936 - INFO - 1 change detected
2025-03-26 18:33:59,144 - INFO - 1 change detected
2025-03-26 18:33:59,499 - INFO - 1 change detected
2025-03-26 18:33:59,910 - INFO - 1 change detected
2025-03-26 18:34:00,315 - INFO - 1 change detected
2025-03-26 18:34:00,721 - INFO - 1 change detected
2025-03-26 18:34:01,128 - INFO - 1 change detected
2025-03-26 18:34:01,532 - INFO - 1 change detected
2025-03-26 18:34:01,937 - INFO - 1 change detected
2025-03-26 18:34:02,343 - INFO - 1 change detected
2025-03-26 18:34:02,747 - INFO - 1 change detected
2025-03-26 18:34:03,102 - INFO - 1 change detected
2025-03-26 18:34:03,511 - INFO - 1 change detected
2025-03-26 18:34:03,918 - INFO - 1 change detected
2025-03-26 18:34:04,326 - INFO - 1 change detected
2025-03-26 18:34:04,735 - INFO - 2 changes detected
2025-03-26 18:34:04,736 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-26 18:34:37,775 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:37,778 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:37,926 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 18:34:37,936 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 18:34:37,939 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:37,939 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:37,939 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:38,193 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 18:34:38,204 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 18:34:38,212 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 18:34:38,216 - INFO - Shutting down
2025-03-26 18:34:38,332 - INFO - Waiting for connections to close. (CTRL+C to force quit)
2025-03-26 18:34:38,472 - INFO - Waiting for application shutdown.
2025-03-26 18:34:38,474 - INFO - Monitoring task cancelled. Exiting...
2025-03-26 18:34:38,474 - INFO - Application shutdown complete.
2025-03-26 18:34:38,475 - INFO - Finished server process [25244]
2025-03-26 18:34:39,200 - INFO - 1 change detected
2025-03-26 18:34:40,664 - INFO - 5 changes detected
2025-03-26 18:34:40,815 - INFO - Started server process [5076]
2025-03-26 18:34:40,819 - INFO - Waiting for application startup.
2025-03-26 18:34:40,829 - INFO - Application startup complete.
2025-03-26 18:34:40,838 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:40,838 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:40,838 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:40,838 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:40,839 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:40,839 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:41,425 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 18:34:41,436 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 18:34:41,444 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 18:34:41,451 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 18:34:41,457 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 18:34:41,463 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 18:34:41,722 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:41,731 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 18:34:43,346 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:43,356 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 18:34:43,660 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:43,667 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:43,674 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:43,674 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:43,675 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 18:34:43,687 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 18:34:43,824 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 18:34:43,844 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 18:34:43,863 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 18:34:43,877 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 18:35:09,678 - INFO - Shutting down
2025-03-26 18:35:09,787 - INFO - Finished server process [5076]
2025-03-26 18:35:09,836 - ERROR - Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 700, in lifespan
    await receive()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-03-26 18:35:09,841 - INFO - Monitoring task cancelled. Exiting...
2025-03-26 18:35:10,105 - INFO - Stopping reloader process [27784]
2025-03-26 23:16:32,797 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-26 23:16:32,799 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-26 23:16:32,800 - INFO - Started reloader process [31644] using WatchFiles
2025-03-26 23:16:34,671 - INFO - Started server process [25144]
2025-03-26 23:16:34,673 - INFO - Waiting for application startup.
2025-03-26 23:16:34,685 - INFO - Application startup complete.
2025-03-26 23:16:41,532 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:41,625 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 23:16:42,706 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:42,709 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:42,769 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 23:16:42,837 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 23:16:42,842 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:42,842 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:42,843 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:43,024 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 23:16:43,031 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 23:16:43,037 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 23:16:52,548 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:52,561 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-26 23:16:52,566 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:52,572 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:52,572 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:52,581 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-26 23:16:52,606 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-26 23:16:52,614 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-26 23:16:53,798 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:53,798 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:53,804 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:53,804 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:53,810 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:53,817 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 23:16:53,824 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 23:16:53,892 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 23:16:53,899 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 23:16:53,904 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 23:16:55,842 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:16:55,852 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 23:19:10,147 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:19:10,155 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 23:19:13,765 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:19:13,773 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 23:19:18,221 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:19:18,226 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 23:19:18,715 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:19:18,718 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:20:18,800 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:20:18,800 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:20:18,803 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:20:18,803 - INFO - Shutting down
2025-03-26 23:20:18,821 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 23:20:18,829 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 23:20:18,836 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 23:20:18,839 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:20:18,839 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:20:18,840 - INFO - MUSEEEEEEEE2: False
2025-03-26 23:20:18,840 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:20:18,840 - INFO - MUSEEEEEEEE2: False
2025-03-26 23:20:18,840 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:20:18,840 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:20:18,840 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:24:48,930 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:24:48,931 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 298, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 298, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:24:49,046 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:24:49,054 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:24:49,061 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:24:49,068 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:24:49,075 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:24:49,082 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:24:49,089 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:24:49,095 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 298, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 298, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:24:49,107 - INFO - Finished server process [25144]
2025-03-26 23:24:49,114 - ERROR - Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 700, in lifespan
    await receive()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-03-26 23:24:49,118 - INFO - Monitoring task cancelled. Exiting...
2025-03-26 23:24:49,119 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-26 23:24:49,145 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-26 23:24:49,147 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-26 23:24:49,149 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-26 23:24:49,377 - INFO - Stopping reloader process [31644]
2025-03-26 23:24:54,672 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-26 23:24:54,673 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-26 23:24:54,674 - INFO - Started reloader process [5308] using WatchFiles
2025-03-26 23:24:56,624 - INFO - Started server process [22824]
2025-03-26 23:24:56,628 - INFO - Waiting for application startup.
2025-03-26 23:24:56,639 - INFO - Application startup complete.
2025-03-26 23:25:37,524 - INFO - MUSEEEEEEEE2: False
2025-03-26 23:25:37,591 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-26 23:25:37,598 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-26 23:25:37,609 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-26 23:25:45,202 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:45,268 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 23:25:47,303 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:47,305 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:47,479 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-26 23:25:47,549 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-26 23:25:47,555 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:47,555 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:47,837 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-26 23:25:47,845 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-26 23:25:49,198 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:49,201 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:49,273 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:49,447 - INFO - Logged request from IP bro 127.0.0.1 to /auth/users/list
2025-03-26 23:25:49,451 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:49,619 - INFO - Logged request from IP bro 127.0.0.1 to /auth/activity-logs
2025-03-26 23:25:51,660 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:51,665 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:51,673 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 23:25:51,678 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:51,678 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:51,819 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 23:25:51,841 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 23:25:51,853 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 23:25:51,856 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:25:51,864 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 23:31:40,622 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:31:40,625 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:31:40,628 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:31:40,628 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:31:40,635 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 23:31:40,644 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-26 23:31:40,650 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-26 23:31:40,655 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-26 23:31:40,657 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:31:40,724 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-26 23:31:42,939 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:31:42,942 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:31:42,943 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:31:42,943 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:31:42,949 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-26 23:31:42,966 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-26 23:31:42,971 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-26 23:31:42,975 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-26 23:32:12,994 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:32:12,999 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-26 23:32:13,011 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 304, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 284, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...<3 lines>...
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 339, in scan_cors_issues
    |     endpoints = db.query(APIEndpoint).all()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    |     return self._iter().all()  # type: ignore
    |            ~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 304, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 284, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 339, in scan_cors_issues
    endpoints = db.query(APIEndpoint).all()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2673, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:45:02,286 - INFO - MUSEEEEEEEE2: False
2025-03-26 23:45:32,299 - INFO - Shutting down
2025-03-26 23:46:02,309 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:46:02,309 - INFO - Waiting for connections to close. (CTRL+C to force quit)
2025-03-26 23:46:02,310 - INFO - MUSEEEEEEEE2: False
2025-03-26 23:46:32,319 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 298, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 298, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:46:32,333 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-26 23:46:32,429 - INFO - Waiting for application shutdown.
2025-03-26 23:46:32,430 - INFO - Monitoring task cancelled. Exiting...
2025-03-26 23:46:32,430 - INFO - Application shutdown complete.
2025-03-26 23:46:32,430 - INFO - Finished server process [22824]
2025-03-26 23:46:32,733 - INFO - Stopping reloader process [5308]
2025-03-26 23:48:38,898 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-26 23:48:38,899 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-26 23:48:38,900 - INFO - Started reloader process [29160] using WatchFiles
2025-03-26 23:48:40,399 - INFO - Started server process [9236]
2025-03-26 23:48:40,402 - INFO - Waiting for application startup.
2025-03-26 23:48:40,411 - INFO - Application startup complete.
2025-03-26 23:51:06,697 - INFO - MUSEEEEEEEE2: False
2025-03-26 23:51:06,760 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-26 23:51:06,766 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-26 23:51:06,773 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-26 23:52:07,080 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:52:07,251 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 23:52:07,305 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:52:07,376 - INFO - Logged request from IP bro 127.0.0.1 to /favicon.ico
2025-03-26 23:55:33,102 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:55:33,177 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-26 23:55:33,207 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:55:33,291 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/endpoints/health-summary
2025-03-26 23:55:33,320 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-26 23:55:33,403 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-27 00:04:03,134 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-27 00:04:03,137 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-27 00:04:03,208 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-27 00:04:03,216 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-27 00:04:03,218 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-27 00:04:03,218 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-27 00:04:03,225 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-27 00:04:03,230 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-27 00:06:21,789 - INFO - 1 change detected
2025-03-27 00:06:21,790 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-27 00:06:24,023 - INFO - Shutting down
2025-03-27 00:06:24,133 - INFO - Waiting for application shutdown.
2025-03-27 00:06:24,134 - INFO - Monitoring task cancelled. Exiting...
2025-03-27 00:06:24,134 - INFO - Application shutdown complete.
2025-03-27 00:06:24,135 - INFO - Finished server process [9236]
2025-03-27 00:06:24,730 - INFO - 1 change detected
2025-03-27 00:06:25,794 - INFO - 5 changes detected
2025-03-27 00:06:25,858 - INFO - Started server process [30284]
2025-03-27 00:06:25,861 - INFO - Waiting for application startup.
2025-03-27 00:06:25,869 - INFO - Application startup complete.
2025-03-27 00:06:27,501 - INFO - Shutting down
2025-03-27 00:06:27,611 - INFO - Waiting for application shutdown.
2025-03-27 00:06:27,611 - INFO - Monitoring task cancelled. Exiting...
2025-03-27 00:06:27,611 - INFO - Application shutdown complete.
2025-03-27 00:06:27,612 - INFO - Finished server process [30284]
2025-03-27 00:06:27,791 - INFO - Stopping reloader process [29160]
2025-03-28 15:36:32,202 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-28 15:36:32,203 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-28 15:36:32,204 - INFO - Started reloader process [22896] using WatchFiles
2025-03-28 15:36:34,045 - INFO - Started server process [22972]
2025-03-28 15:36:34,049 - INFO - Waiting for application startup.
2025-03-28 15:36:34,062 - INFO - Application startup complete.
2025-03-28 15:37:28,624 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:37:28,624 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:37:28,764 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 15:37:28,775 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-28 15:37:28,965 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:37:28,973 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/endpoints/health-summary
2025-03-28 15:37:28,989 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:37:29,147 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 15:37:39,540 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:37:39,605 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-28 15:37:39,619 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:37:39,685 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 15:37:39,703 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:37:39,763 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/endpoints/health-summary
2025-03-28 15:37:39,777 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:37:39,842 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 15:40:08,178 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:08,185 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-28 15:40:14,687 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:14,697 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-28 15:40:22,285 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:22,289 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:22,289 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:22,294 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 15:40:22,464 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 15:40:22,471 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 15:40:22,473 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:22,480 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-28 15:40:23,165 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:23,171 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:23,181 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:23,190 - INFO - Logged request from IP bro 127.0.0.1 to /auth/users/list
2025-03-28 15:40:23,195 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:23,275 - INFO - Logged request from IP bro 127.0.0.1 to /auth/activity-logs
2025-03-28 15:40:29,449 - INFO - MUSEEEEEEEE2: False
2025-03-28 15:40:29,507 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-28 15:40:29,512 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-28 15:40:29,522 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-28 15:40:30,282 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:30,287 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:30,353 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-28 15:40:30,375 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 15:40:30,394 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:30,401 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/endpoints/health-summary
2025-03-28 15:40:30,416 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:30,421 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 15:40:33,926 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:33,934 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-28 15:40:36,137 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:36,146 - INFO - Logged request from IP bro 127.0.0.1 to /auth/users/list
2025-03-28 15:40:36,152 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:36,290 - INFO - Logged request from IP bro 127.0.0.1 to /auth/activity-logs
2025-03-28 15:40:39,302 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:40:39,311 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-28 15:44:34,022 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:44:34,031 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-28 15:44:44,286 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:44:44,296 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints
2025-03-28 15:46:49,203 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:49,205 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:49,335 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-28 15:46:49,373 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/requests-breakdown
2025-03-28 15:46:49,393 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:49,393 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:49,393 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:49,413 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/failures-breakdown
2025-03-28 15:46:49,454 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/client-insights
2025-03-28 15:46:49,496 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/performance-trends
2025-03-28 15:46:57,319 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:57,331 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 15:46:57,338 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:57,339 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:57,339 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:57,408 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 15:46:57,415 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 15:46:57,419 - INFO - Logged request from IP bro 127.0.0.1 to /security/threat-logs
2025-03-28 15:46:58,728 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:58,731 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:58,731 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:46:58,735 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 15:47:28,741 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:48:58,769 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:48:58,771 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:48:58,911 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:48:58,921 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:50:28,944 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:50:28,946 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:50:28,955 - INFO - Shutting down
2025-03-28 15:50:28,956 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 289, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 289, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:50:29,018 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:50:29,018 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:50:29,019 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:50:29,019 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:50:29,019 - INFO - MUSEEEEEEEE2: False
2025-03-28 15:50:29,019 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:53:59,060 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:53:59,060 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:53:59,067 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:53:59,074 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:53:59,080 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:53:59,088 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:53:59,097 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 15:53:59,105 - INFO - Finished server process [22972]
2025-03-28 15:53:59,191 - ERROR - Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 700, in lifespan
    await receive()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-03-28 15:53:59,196 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 15:53:59,196 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 15:53:59,431 - INFO - Stopping reloader process [22896]
2025-03-28 15:54:11,337 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-28 15:54:11,339 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-28 15:54:11,339 - INFO - Started reloader process [16188] using WatchFiles
2025-03-28 15:54:13,005 - INFO - Started server process [6056]
2025-03-28 15:54:13,007 - INFO - Waiting for application startup.
2025-03-28 15:54:13,016 - INFO - Application startup complete.
2025-03-28 15:54:22,101 - INFO - MUSEEEEEEEE2: False
2025-03-28 15:54:22,271 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-28 15:54:22,278 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-28 15:54:22,284 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-28 15:54:22,988 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:54:22,992 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:54:23,054 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-28 15:54:23,112 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 15:54:23,283 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:54:23,293 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/endpoints/health-summary
2025-03-28 15:54:23,312 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:54:23,375 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 15:54:26,728 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:54:26,731 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:54:26,854 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 15:54:26,862 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 15:54:26,867 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:54:26,867 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:54:26,927 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 15:54:26,933 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 15:55:18,781 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:55:18,788 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 15:55:18,793 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:55:18,793 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:55:18,794 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 15:55:19,127 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 15:55:19,132 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 15:55:19,144 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 15:56:48,218 - INFO - 1 change detected
2025-03-28 15:56:48,580 - INFO - 1 change detected
2025-03-28 15:56:48,941 - INFO - 1 change detected
2025-03-28 15:56:49,349 - INFO - 1 change detected
2025-03-28 15:56:49,753 - INFO - 1 change detected
2025-03-28 15:56:50,159 - INFO - 1 change detected
2025-03-28 15:56:50,563 - INFO - 1 change detected
2025-03-28 15:56:50,973 - INFO - 1 change detected
2025-03-28 15:56:51,334 - INFO - 1 change detected
2025-03-28 15:56:51,742 - INFO - 1 change detected
2025-03-28 15:56:52,150 - INFO - 1 change detected
2025-03-28 15:56:52,554 - INFO - 1 change detected
2025-03-28 15:56:52,969 - INFO - 1 change detected
2025-03-28 15:56:53,376 - INFO - 1 change detected
2025-03-28 15:56:53,786 - INFO - 1 change detected
2025-03-28 15:56:54,192 - INFO - 1 change detected
2025-03-28 15:56:54,598 - INFO - 1 change detected
2025-03-28 15:56:55,004 - INFO - 1 change detected
2025-03-28 15:56:55,363 - INFO - 1 change detected
2025-03-28 15:56:55,775 - INFO - 1 change detected
2025-03-28 15:56:56,186 - INFO - 1 change detected
2025-03-28 15:56:56,541 - INFO - 1 change detected
2025-03-28 15:56:56,953 - INFO - 1 change detected
2025-03-28 15:56:57,358 - INFO - 1 change detected
2025-03-28 15:56:57,767 - INFO - 1 change detected
2025-03-28 15:56:58,129 - INFO - 1 change detected
2025-03-28 15:56:58,539 - INFO - 1 change detected
2025-03-28 15:56:58,942 - INFO - 1 change detected
2025-03-28 15:56:59,348 - INFO - 1 change detected
2025-03-28 15:56:59,759 - INFO - 1 change detected
2025-03-28 15:57:00,117 - INFO - 1 change detected
2025-03-28 15:57:00,529 - INFO - 1 change detected
2025-03-28 15:57:00,940 - INFO - 1 change detected
2025-03-28 15:57:01,300 - INFO - 1 change detected
2025-03-28 15:57:01,710 - INFO - 1 change detected
2025-03-28 15:57:02,119 - INFO - 1 change detected
2025-03-28 15:57:02,529 - INFO - 1 change detected
2025-03-28 15:57:02,888 - INFO - 1 change detected
2025-03-28 15:57:03,300 - INFO - 1 change detected
2025-03-28 15:57:03,709 - INFO - 1 change detected
2025-03-28 15:57:04,070 - INFO - 1 change detected
2025-03-28 15:57:04,524 - INFO - 1 change detected
2025-03-28 15:57:04,890 - INFO - 1 change detected
2025-03-28 15:57:05,297 - INFO - 1 change detected
2025-03-28 15:57:05,700 - INFO - 1 change detected
2025-03-28 15:57:06,108 - INFO - 1 change detected
2025-03-28 15:57:06,516 - INFO - 1 change detected
2025-03-28 15:57:06,926 - INFO - 1 change detected
2025-03-28 15:57:07,335 - INFO - 1 change detected
2025-03-28 15:57:07,736 - INFO - 1 change detected
2025-03-28 15:57:08,140 - INFO - 1 change detected
2025-03-28 15:57:08,544 - INFO - 1 change detected
2025-03-28 15:57:08,952 - INFO - 1 change detected
2025-03-28 15:57:09,355 - INFO - 1 change detected
2025-03-28 15:57:09,714 - INFO - 1 change detected
2025-03-28 15:57:10,120 - INFO - 1 change detected
2025-03-28 15:57:10,533 - INFO - 1 change detected
2025-03-28 15:57:10,941 - INFO - 1 change detected
2025-03-28 15:57:11,349 - INFO - 1 change detected
2025-03-28 15:57:11,751 - INFO - 1 change detected
2025-03-28 15:57:12,107 - INFO - 1 change detected
2025-03-28 15:57:12,515 - INFO - 1 change detected
2025-03-28 15:57:12,918 - INFO - 1 change detected
2025-03-28 15:57:13,382 - INFO - 1 change detected
2025-03-28 15:57:13,785 - INFO - 1 change detected
2025-03-28 15:57:14,143 - INFO - 1 change detected
2025-03-28 15:57:14,550 - INFO - 1 change detected
2025-03-28 15:57:14,953 - INFO - 1 change detected
2025-03-28 15:57:15,359 - INFO - 1 change detected
2025-03-28 15:57:15,763 - INFO - 1 change detected
2025-03-28 15:57:16,167 - INFO - 1 change detected
2025-03-28 15:57:16,572 - INFO - 1 change detected
2025-03-28 15:57:16,983 - INFO - 1 change detected
2025-03-28 15:57:17,451 - INFO - 1 change detected
2025-03-28 15:57:17,816 - INFO - 1 change detected
2025-03-28 15:57:18,226 - INFO - 1 change detected
2025-03-28 15:57:18,633 - INFO - 1 change detected
2025-03-28 15:57:19,040 - INFO - 1 change detected
2025-03-28 15:57:19,456 - INFO - 1 change detected
2025-03-28 15:57:19,864 - INFO - 1 change detected
2025-03-28 15:57:20,272 - INFO - 1 change detected
2025-03-28 15:57:20,627 - INFO - 1 change detected
2025-03-28 15:57:21,036 - INFO - 1 change detected
2025-03-28 15:57:21,441 - INFO - 1 change detected
2025-03-28 15:57:21,877 - INFO - 1 change detected
2025-03-28 15:57:22,234 - INFO - 1 change detected
2025-03-28 15:57:22,645 - INFO - 1 change detected
2025-03-28 15:57:23,052 - INFO - 1 change detected
2025-03-28 15:57:23,455 - INFO - 1 change detected
2025-03-28 15:57:23,866 - INFO - 1 change detected
2025-03-28 15:57:24,269 - INFO - 1 change detected
2025-03-28 15:57:24,626 - INFO - 1 change detected
2025-03-28 15:57:25,038 - INFO - 1 change detected
2025-03-28 15:57:25,450 - INFO - 1 change detected
2025-03-28 15:57:25,860 - INFO - 1 change detected
2025-03-28 15:57:26,217 - INFO - 1 change detected
2025-03-28 15:57:26,626 - INFO - 1 change detected
2025-03-28 15:57:27,031 - INFO - 1 change detected
2025-03-28 15:57:27,437 - INFO - 1 change detected
2025-03-28 15:57:27,841 - INFO - 1 change detected
2025-03-28 15:57:28,247 - INFO - 1 change detected
2025-03-28 15:57:28,649 - INFO - 1 change detected
2025-03-28 15:57:29,057 - INFO - 1 change detected
2025-03-28 15:57:29,462 - INFO - 1 change detected
2025-03-28 15:57:29,869 - INFO - 1 change detected
2025-03-28 15:57:30,275 - INFO - 1 change detected
2025-03-28 15:57:30,679 - INFO - 1 change detected
2025-03-28 15:57:31,082 - INFO - 1 change detected
2025-03-28 15:57:31,485 - INFO - 1 change detected
2025-03-28 15:57:31,893 - INFO - 1 change detected
2025-03-28 15:57:32,302 - INFO - 1 change detected
2025-03-28 15:57:32,703 - INFO - 1 change detected
2025-03-28 15:57:33,106 - INFO - 1 change detected
2025-03-28 15:57:33,466 - INFO - 1 change detected
2025-03-28 15:57:33,881 - INFO - 1 change detected
2025-03-28 15:57:34,290 - INFO - 1 change detected
2025-03-28 15:57:34,649 - INFO - 1 change detected
2025-03-28 15:57:35,059 - INFO - 1 change detected
2025-03-28 15:57:35,467 - INFO - 1 change detected
2025-03-28 15:57:35,821 - INFO - 1 change detected
2025-03-28 15:57:36,233 - INFO - 1 change detected
2025-03-28 15:57:36,637 - INFO - 1 change detected
2025-03-28 15:57:37,046 - INFO - 1 change detected
2025-03-28 15:57:37,455 - INFO - 1 change detected
2025-03-28 15:57:37,809 - INFO - 1 change detected
2025-03-28 15:57:38,224 - INFO - 1 change detected
2025-03-28 15:57:38,631 - INFO - 1 change detected
2025-03-28 15:57:39,037 - INFO - 1 change detected
2025-03-28 15:57:39,443 - INFO - 1 change detected
2025-03-28 15:57:39,850 - INFO - 1 change detected
2025-03-28 15:57:40,255 - INFO - 1 change detected
2025-03-28 15:57:40,661 - INFO - 1 change detected
2025-03-28 15:57:41,070 - INFO - 1 change detected
2025-03-28 15:57:41,472 - INFO - 1 change detected
2025-03-28 15:57:41,878 - INFO - 1 change detected
2025-03-28 15:57:42,286 - INFO - 1 change detected
2025-03-28 15:57:42,693 - INFO - 1 change detected
2025-03-28 15:57:43,052 - INFO - 1 change detected
2025-03-28 15:57:43,463 - INFO - 1 change detected
2025-03-28 15:57:43,866 - INFO - 1 change detected
2025-03-28 15:57:44,274 - INFO - 1 change detected
2025-03-28 15:57:44,680 - INFO - 1 change detected
2025-03-28 15:57:45,086 - INFO - 1 change detected
2025-03-28 15:57:45,444 - INFO - 1 change detected
2025-03-28 15:57:45,855 - INFO - 1 change detected
2025-03-28 15:57:46,264 - INFO - 1 change detected
2025-03-28 15:57:46,669 - INFO - 1 change detected
2025-03-28 15:57:47,031 - INFO - 1 change detected
2025-03-28 15:57:47,444 - INFO - 1 change detected
2025-03-28 15:57:47,848 - INFO - 1 change detected
2025-03-28 15:57:48,258 - INFO - 1 change detected
2025-03-28 15:57:48,664 - INFO - 1 change detected
2025-03-28 15:57:49,071 - INFO - 1 change detected
2025-03-28 15:57:49,479 - INFO - 1 change detected
2025-03-28 15:57:49,887 - INFO - 1 change detected
2025-03-28 15:57:50,290 - INFO - 1 change detected
2025-03-28 15:57:50,696 - INFO - 1 change detected
2025-03-28 15:57:51,120 - INFO - 1 change detected
2025-03-28 15:57:51,527 - INFO - 1 change detected
2025-03-28 15:57:51,935 - INFO - 1 change detected
2025-03-28 15:57:52,340 - INFO - 1 change detected
2025-03-28 15:57:52,745 - INFO - 1 change detected
2025-03-28 15:57:53,150 - INFO - 1 change detected
2025-03-28 15:57:53,553 - INFO - 1 change detected
2025-03-28 15:57:53,958 - INFO - 1 change detected
2025-03-28 15:57:54,364 - INFO - 1 change detected
2025-03-28 15:57:54,769 - INFO - 1 change detected
2025-03-28 15:57:55,176 - INFO - 1 change detected
2025-03-28 15:57:55,580 - INFO - 1 change detected
2025-03-28 15:57:55,988 - INFO - 1 change detected
2025-03-28 15:57:56,393 - INFO - 1 change detected
2025-03-28 15:57:56,799 - INFO - 1 change detected
2025-03-28 15:57:57,157 - INFO - 1 change detected
2025-03-28 15:57:57,570 - INFO - 1 change detected
2025-03-28 15:57:57,977 - INFO - 1 change detected
2025-03-28 15:57:58,339 - INFO - 1 change detected
2025-03-28 15:57:58,750 - INFO - 1 change detected
2025-03-28 15:57:59,159 - INFO - 1 change detected
2025-03-28 15:57:59,567 - INFO - 1 change detected
2025-03-28 15:57:59,972 - INFO - 1 change detected
2025-03-28 15:58:00,332 - INFO - 1 change detected
2025-03-28 15:58:00,743 - INFO - 1 change detected
2025-03-28 15:58:01,148 - INFO - 1 change detected
2025-03-28 15:58:01,555 - INFO - 1 change detected
2025-03-28 15:58:01,963 - INFO - 1 change detected
2025-03-28 15:58:02,368 - INFO - 1 change detected
2025-03-28 15:58:02,775 - INFO - 1 change detected
2025-03-28 15:58:03,182 - INFO - 1 change detected
2025-03-28 15:58:03,540 - INFO - 1 change detected
2025-03-28 15:58:03,954 - INFO - 1 change detected
2025-03-28 15:58:04,363 - INFO - 1 change detected
2025-03-28 15:58:04,722 - INFO - 1 change detected
2025-03-28 15:58:05,136 - INFO - 1 change detected
2025-03-28 15:58:05,541 - INFO - 1 change detected
2025-03-28 15:58:05,946 - INFO - 1 change detected
2025-03-28 15:58:06,352 - INFO - 1 change detected
2025-03-28 15:58:06,712 - INFO - 1 change detected
2025-03-28 15:58:07,125 - INFO - 1 change detected
2025-03-28 15:58:07,534 - INFO - 1 change detected
2025-03-28 15:58:07,939 - INFO - 1 change detected
2025-03-28 15:58:08,348 - INFO - 1 change detected
2025-03-28 15:58:08,755 - INFO - 1 change detected
2025-03-28 15:58:09,165 - INFO - 1 change detected
2025-03-28 15:58:09,568 - INFO - 1 change detected
2025-03-28 15:58:09,976 - INFO - 1 change detected
2025-03-28 15:58:10,334 - INFO - 1 change detected
2025-03-28 15:58:10,745 - INFO - 1 change detected
2025-03-28 15:58:11,153 - INFO - 1 change detected
2025-03-28 15:58:11,512 - INFO - 1 change detected
2025-03-28 15:58:11,923 - INFO - 1 change detected
2025-03-28 15:58:12,327 - INFO - 1 change detected
2025-03-28 15:58:12,732 - INFO - 1 change detected
2025-03-28 15:58:13,143 - INFO - 1 change detected
2025-03-28 15:58:13,552 - INFO - 1 change detected
2025-03-28 15:58:13,961 - INFO - 1 change detected
2025-03-28 15:58:14,322 - INFO - 1 change detected
2025-03-28 15:58:14,731 - INFO - 1 change detected
2025-03-28 15:58:15,138 - INFO - 1 change detected
2025-03-28 15:58:15,544 - INFO - 1 change detected
2025-03-28 15:58:15,950 - INFO - 1 change detected
2025-03-28 15:58:16,357 - INFO - 1 change detected
2025-03-28 15:58:16,766 - INFO - 1 change detected
2025-03-28 15:58:17,169 - INFO - 1 change detected
2025-03-28 15:58:17,573 - INFO - 1 change detected
2025-03-28 15:58:17,978 - INFO - 1 change detected
2025-03-28 15:58:18,385 - INFO - 1 change detected
2025-03-28 15:58:18,740 - INFO - 1 change detected
2025-03-28 15:58:19,152 - INFO - 1 change detected
2025-03-28 15:58:19,557 - INFO - 1 change detected
2025-03-28 15:58:19,967 - INFO - 1 change detected
2025-03-28 15:58:20,375 - INFO - 1 change detected
2025-03-28 15:58:20,735 - INFO - 1 change detected
2025-03-28 15:58:21,149 - INFO - 1 change detected
2025-03-28 15:58:21,555 - INFO - 1 change detected
2025-03-28 15:58:21,963 - INFO - 1 change detected
2025-03-28 15:58:22,370 - INFO - 1 change detected
2025-03-28 15:58:22,774 - INFO - 1 change detected
2025-03-28 15:58:23,177 - INFO - 1 change detected
2025-03-28 15:58:23,586 - INFO - 1 change detected
2025-03-28 15:58:23,995 - INFO - 1 change detected
2025-03-28 15:58:24,355 - INFO - 1 change detected
2025-03-28 15:58:24,765 - INFO - 1 change detected
2025-03-28 15:58:25,176 - INFO - 1 change detected
2025-03-28 15:58:25,534 - INFO - 1 change detected
2025-03-28 15:58:25,945 - INFO - 1 change detected
2025-03-28 15:58:26,352 - INFO - 1 change detected
2025-03-28 15:58:26,755 - INFO - 1 change detected
2025-03-28 15:58:27,162 - INFO - 1 change detected
2025-03-28 15:58:27,568 - INFO - 1 change detected
2025-03-28 15:58:27,980 - INFO - 1 change detected
2025-03-28 15:58:28,342 - INFO - 1 change detected
2025-03-28 15:58:28,755 - INFO - 1 change detected
2025-03-28 15:58:29,162 - INFO - 1 change detected
2025-03-28 15:58:29,570 - INFO - 1 change detected
2025-03-28 15:58:29,975 - INFO - 1 change detected
2025-03-28 15:58:30,383 - INFO - 1 change detected
2025-03-28 15:58:30,739 - INFO - 1 change detected
2025-03-28 15:58:31,152 - INFO - 1 change detected
2025-03-28 15:58:31,563 - INFO - 1 change detected
2025-03-28 15:58:31,925 - INFO - 1 change detected
2025-03-28 15:58:32,336 - INFO - 1 change detected
2025-03-28 15:58:32,741 - INFO - 1 change detected
2025-03-28 15:58:33,155 - INFO - 1 change detected
2025-03-28 15:58:33,516 - INFO - 1 change detected
2025-03-28 15:58:33,928 - INFO - 1 change detected
2025-03-28 15:58:34,337 - INFO - 1 change detected
2025-03-28 15:58:34,697 - INFO - 1 change detected
2025-03-28 15:58:35,108 - INFO - 1 change detected
2025-03-28 15:58:35,517 - INFO - 1 change detected
2025-03-28 15:58:35,928 - INFO - 1 change detected
2025-03-28 15:58:36,339 - INFO - 1 change detected
2025-03-28 15:58:36,741 - INFO - 1 change detected
2025-03-28 15:58:37,099 - INFO - 1 change detected
2025-03-28 15:58:37,510 - INFO - 1 change detected
2025-03-28 15:58:37,919 - INFO - 1 change detected
2025-03-28 15:58:38,327 - INFO - 1 change detected
2025-03-28 15:58:38,736 - INFO - 1 change detected
2025-03-28 15:58:39,144 - INFO - 1 change detected
2025-03-28 15:58:39,503 - INFO - 1 change detected
2025-03-28 15:58:39,912 - INFO - 1 change detected
2025-03-28 15:58:40,318 - INFO - 1 change detected
2025-03-28 15:58:40,725 - INFO - 1 change detected
2025-03-28 15:58:41,084 - INFO - 1 change detected
2025-03-28 15:58:41,498 - INFO - 1 change detected
2025-03-28 15:58:41,908 - INFO - 1 change detected
2025-03-28 15:58:42,268 - INFO - 1 change detected
2025-03-28 15:58:42,678 - INFO - 1 change detected
2025-03-28 15:58:43,088 - INFO - 1 change detected
2025-03-28 15:58:43,494 - INFO - 1 change detected
2025-03-28 15:58:43,853 - INFO - 1 change detected
2025-03-28 15:58:44,264 - INFO - 1 change detected
2025-03-28 15:58:44,673 - INFO - 1 change detected
2025-03-28 15:58:45,084 - INFO - 1 change detected
2025-03-28 15:58:45,441 - INFO - 1 change detected
2025-03-28 15:58:45,853 - INFO - 1 change detected
2025-03-28 15:58:46,261 - INFO - 1 change detected
2025-03-28 15:58:46,672 - INFO - 1 change detected
2025-03-28 15:58:47,030 - INFO - 1 change detected
2025-03-28 15:58:47,443 - INFO - 1 change detected
2025-03-28 15:58:47,852 - INFO - 1 change detected
2025-03-28 15:58:48,212 - INFO - 1 change detected
2025-03-28 15:58:48,625 - INFO - 1 change detected
2025-03-28 15:58:49,036 - INFO - 1 change detected
2025-03-28 15:58:49,396 - INFO - 1 change detected
2025-03-28 15:58:49,806 - INFO - 1 change detected
2025-03-28 15:58:50,216 - INFO - 1 change detected
2025-03-28 15:58:50,627 - INFO - 1 change detected
2025-03-28 15:58:50,986 - INFO - 1 change detected
2025-03-28 15:58:51,399 - INFO - 1 change detected
2025-03-28 15:58:51,809 - INFO - 1 change detected
2025-03-28 15:58:52,215 - INFO - 1 change detected
2025-03-28 15:58:52,625 - INFO - 1 change detected
2025-03-28 15:58:52,987 - INFO - 1 change detected
2025-03-28 15:58:53,398 - INFO - 1 change detected
2025-03-28 15:58:53,808 - INFO - 1 change detected
2025-03-28 15:58:54,217 - INFO - 1 change detected
2025-03-28 15:58:54,576 - INFO - 1 change detected
2025-03-28 15:58:54,992 - INFO - 1 change detected
2025-03-28 15:58:55,397 - INFO - 1 change detected
2025-03-28 15:58:55,802 - INFO - 1 change detected
2025-03-28 15:58:56,211 - INFO - 1 change detected
2025-03-28 15:58:56,619 - INFO - 1 change detected
2025-03-28 15:58:56,977 - INFO - 1 change detected
2025-03-28 15:58:57,393 - INFO - 1 change detected
2025-03-28 15:58:57,803 - INFO - 1 change detected
2025-03-28 15:58:58,157 - INFO - 1 change detected
2025-03-28 15:58:58,570 - INFO - 1 change detected
2025-03-28 15:58:58,977 - INFO - 1 change detected
2025-03-28 15:58:59,387 - INFO - 1 change detected
2025-03-28 15:58:59,749 - INFO - 1 change detected
2025-03-28 15:59:00,163 - INFO - 1 change detected
2025-03-28 15:59:00,571 - INFO - 1 change detected
2025-03-28 15:59:00,978 - INFO - 1 change detected
2025-03-28 15:59:01,338 - INFO - 1 change detected
2025-03-28 15:59:01,749 - INFO - 1 change detected
2025-03-28 15:59:02,165 - INFO - 1 change detected
2025-03-28 15:59:02,575 - INFO - 1 change detected
2025-03-28 15:59:02,934 - INFO - 1 change detected
2025-03-28 15:59:03,344 - INFO - 1 change detected
2025-03-28 15:59:03,752 - INFO - 1 change detected
2025-03-28 15:59:04,113 - INFO - 1 change detected
2025-03-28 15:59:04,522 - INFO - 1 change detected
2025-03-28 15:59:04,932 - INFO - 1 change detected
2025-03-28 15:59:05,343 - INFO - 1 change detected
2025-03-28 15:59:05,749 - INFO - 1 change detected
2025-03-28 15:59:06,157 - INFO - 1 change detected
2025-03-28 15:59:06,515 - INFO - 1 change detected
2025-03-28 15:59:06,929 - INFO - 1 change detected
2025-03-28 15:59:07,336 - INFO - 1 change detected
2025-03-28 15:59:07,741 - INFO - 1 change detected
2025-03-28 15:59:08,150 - INFO - 1 change detected
2025-03-28 15:59:08,506 - INFO - 1 change detected
2025-03-28 15:59:08,917 - INFO - 1 change detected
2025-03-28 15:59:09,326 - INFO - 1 change detected
2025-03-28 15:59:09,686 - INFO - 1 change detected
2025-03-28 15:59:10,101 - INFO - 1 change detected
2025-03-28 15:59:10,507 - INFO - 1 change detected
2025-03-28 15:59:10,914 - INFO - 1 change detected
2025-03-28 15:59:11,323 - INFO - 1 change detected
2025-03-28 15:59:11,680 - INFO - 1 change detected
2025-03-28 15:59:12,090 - INFO - 1 change detected
2025-03-28 15:59:12,495 - INFO - 1 change detected
2025-03-28 15:59:12,899 - INFO - 1 change detected
2025-03-28 15:59:13,303 - INFO - 1 change detected
2025-03-28 15:59:13,711 - INFO - 1 change detected
2025-03-28 15:59:14,116 - INFO - 1 change detected
2025-03-28 15:59:14,520 - INFO - 1 change detected
2025-03-28 15:59:14,928 - INFO - 1 change detected
2025-03-28 15:59:15,336 - INFO - 1 change detected
2025-03-28 15:59:15,744 - INFO - 1 change detected
2025-03-28 15:59:16,148 - INFO - 1 change detected
2025-03-28 15:59:16,555 - INFO - 1 change detected
2025-03-28 15:59:16,961 - INFO - 1 change detected
2025-03-28 15:59:17,367 - INFO - 1 change detected
2025-03-28 15:59:17,773 - INFO - 1 change detected
2025-03-28 15:59:18,177 - INFO - 1 change detected
2025-03-28 15:59:18,535 - INFO - 1 change detected
2025-03-28 15:59:18,942 - INFO - 1 change detected
2025-03-28 15:59:19,347 - INFO - 1 change detected
2025-03-28 15:59:19,753 - INFO - 1 change detected
2025-03-28 15:59:20,158 - INFO - 1 change detected
2025-03-28 15:59:20,597 - INFO - 1 change detected
2025-03-28 15:59:21,006 - INFO - 1 change detected
2025-03-28 15:59:21,413 - INFO - 1 change detected
2025-03-28 15:59:21,817 - INFO - 1 change detected
2025-03-28 15:59:22,221 - INFO - 1 change detected
2025-03-28 15:59:22,628 - INFO - 1 change detected
2025-03-28 15:59:23,034 - INFO - 1 change detected
2025-03-28 15:59:23,390 - INFO - 1 change detected
2025-03-28 15:59:23,800 - INFO - 1 change detected
2025-03-28 15:59:24,204 - INFO - 1 change detected
2025-03-28 15:59:24,608 - INFO - 1 change detected
2025-03-28 15:59:25,014 - INFO - 1 change detected
2025-03-28 15:59:25,420 - INFO - 1 change detected
2025-03-28 15:59:25,824 - INFO - 1 change detected
2025-03-28 15:59:26,232 - INFO - 1 change detected
2025-03-28 15:59:26,637 - INFO - 1 change detected
2025-03-28 15:59:27,042 - INFO - 1 change detected
2025-03-28 15:59:27,444 - INFO - 1 change detected
2025-03-28 15:59:27,847 - INFO - 1 change detected
2025-03-28 15:59:28,252 - INFO - 1 change detected
2025-03-28 15:59:28,657 - INFO - 1 change detected
2025-03-28 15:59:29,062 - INFO - 1 change detected
2025-03-28 15:59:29,468 - INFO - 1 change detected
2025-03-28 15:59:29,874 - INFO - 1 change detected
2025-03-28 15:59:30,279 - INFO - 1 change detected
2025-03-28 15:59:30,635 - INFO - 1 change detected
2025-03-28 15:59:31,042 - INFO - 1 change detected
2025-03-28 15:59:31,449 - INFO - 1 change detected
2025-03-28 15:59:31,858 - INFO - 1 change detected
2025-03-28 15:59:32,262 - INFO - 1 change detected
2025-03-28 15:59:32,670 - INFO - 1 change detected
2025-03-28 15:59:33,029 - INFO - 1 change detected
2025-03-28 15:59:33,443 - INFO - 1 change detected
2025-03-28 15:59:33,848 - INFO - 1 change detected
2025-03-28 15:59:34,255 - INFO - 1 change detected
2025-03-28 15:59:34,615 - INFO - 1 change detected
2025-03-28 15:59:35,026 - INFO - 1 change detected
2025-03-28 15:59:35,432 - INFO - 1 change detected
2025-03-28 15:59:35,841 - INFO - 1 change detected
2025-03-28 15:59:36,248 - INFO - 1 change detected
2025-03-28 15:59:36,655 - INFO - 1 change detected
2025-03-28 15:59:37,060 - INFO - 1 change detected
2025-03-28 15:59:37,466 - INFO - 1 change detected
2025-03-28 15:59:37,882 - INFO - 1 change detected
2025-03-28 15:59:38,247 - INFO - 1 change detected
2025-03-28 15:59:38,652 - INFO - 1 change detected
2025-03-28 15:59:39,056 - INFO - 1 change detected
2025-03-28 15:59:39,462 - INFO - 1 change detected
2025-03-28 15:59:39,868 - INFO - 1 change detected
2025-03-28 15:59:40,272 - INFO - 1 change detected
2025-03-28 15:59:40,677 - INFO - 1 change detected
2025-03-28 15:59:41,083 - INFO - 1 change detected
2025-03-28 15:59:41,523 - INFO - 1 change detected
2025-03-28 15:59:41,929 - INFO - 1 change detected
2025-03-28 15:59:42,330 - INFO - 1 change detected
2025-03-28 15:59:42,737 - INFO - 1 change detected
2025-03-28 15:59:43,142 - INFO - 1 change detected
2025-03-28 15:59:43,547 - INFO - 1 change detected
2025-03-28 15:59:43,956 - INFO - 1 change detected
2025-03-28 15:59:44,362 - INFO - 1 change detected
2025-03-28 15:59:44,766 - INFO - 1 change detected
2025-03-28 15:59:45,173 - INFO - 1 change detected
2025-03-28 15:59:45,579 - INFO - 1 change detected
2025-03-28 15:59:45,935 - INFO - 1 change detected
2025-03-28 15:59:46,341 - INFO - 1 change detected
2025-03-28 15:59:46,747 - INFO - 1 change detected
2025-03-28 15:59:47,153 - INFO - 1 change detected
2025-03-28 15:59:47,559 - INFO - 1 change detected
2025-03-28 15:59:47,964 - INFO - 1 change detected
2025-03-28 15:59:48,369 - INFO - 1 change detected
2025-03-28 15:59:48,775 - INFO - 1 change detected
2025-03-28 15:59:49,182 - INFO - 1 change detected
2025-03-28 15:59:49,590 - INFO - 1 change detected
2025-03-28 15:59:49,997 - INFO - 1 change detected
2025-03-28 15:59:50,402 - INFO - 1 change detected
2025-03-28 15:59:50,811 - INFO - 1 change detected
2025-03-28 15:59:51,215 - INFO - 1 change detected
2025-03-28 15:59:51,623 - INFO - 1 change detected
2025-03-28 15:59:52,032 - INFO - 1 change detected
2025-03-28 15:59:52,434 - INFO - 1 change detected
2025-03-28 15:59:52,835 - INFO - 1 change detected
2025-03-28 15:59:53,190 - INFO - 1 change detected
2025-03-28 15:59:53,601 - INFO - 1 change detected
2025-03-28 15:59:54,010 - INFO - 1 change detected
2025-03-28 15:59:54,427 - INFO - 1 change detected
2025-03-28 15:59:54,785 - INFO - 1 change detected
2025-03-28 15:59:55,194 - INFO - 1 change detected
2025-03-28 15:59:55,606 - INFO - 1 change detected
2025-03-28 15:59:55,965 - INFO - 1 change detected
2025-03-28 15:59:56,373 - INFO - 1 change detected
2025-03-28 15:59:56,779 - INFO - 1 change detected
2025-03-28 15:59:57,183 - INFO - 1 change detected
2025-03-28 15:59:57,591 - INFO - 1 change detected
2025-03-28 15:59:58,000 - INFO - 1 change detected
2025-03-28 15:59:58,409 - INFO - 1 change detected
2025-03-28 15:59:58,820 - INFO - 1 change detected
2025-03-28 15:59:59,225 - INFO - 1 change detected
2025-03-28 15:59:59,628 - INFO - 1 change detected
2025-03-28 16:00:00,036 - INFO - 1 change detected
2025-03-28 16:00:00,394 - INFO - 1 change detected
2025-03-28 16:00:00,807 - INFO - 1 change detected
2025-03-28 16:00:01,216 - INFO - 1 change detected
2025-03-28 16:00:01,621 - INFO - 1 change detected
2025-03-28 16:00:02,027 - INFO - 1 change detected
2025-03-28 16:00:02,429 - INFO - 1 change detected
2025-03-28 16:00:02,786 - INFO - 1 change detected
2025-03-28 16:00:03,195 - INFO - 1 change detected
2025-03-28 16:00:03,606 - INFO - 1 change detected
2025-03-28 16:00:04,013 - INFO - 1 change detected
2025-03-28 16:00:04,369 - INFO - 1 change detected
2025-03-28 16:00:04,778 - INFO - 1 change detected
2025-03-28 16:00:05,185 - INFO - 1 change detected
2025-03-28 16:00:05,593 - INFO - 1 change detected
2025-03-28 16:00:05,999 - INFO - 1 change detected
2025-03-28 16:00:06,406 - INFO - 1 change detected
2025-03-28 16:00:06,814 - INFO - 1 change detected
2025-03-28 16:00:07,174 - INFO - 1 change detected
2025-03-28 16:00:07,586 - INFO - 1 change detected
2025-03-28 16:00:07,997 - INFO - 1 change detected
2025-03-28 16:00:08,403 - INFO - 1 change detected
2025-03-28 16:00:08,817 - INFO - 1 change detected
2025-03-28 16:00:09,223 - INFO - 1 change detected
2025-03-28 16:00:09,628 - INFO - 1 change detected
2025-03-28 16:00:09,985 - INFO - 1 change detected
2025-03-28 16:00:10,394 - INFO - 1 change detected
2025-03-28 16:00:10,799 - INFO - 1 change detected
2025-03-28 16:00:11,206 - INFO - 1 change detected
2025-03-28 16:00:11,615 - INFO - 1 change detected
2025-03-28 16:00:12,021 - INFO - 1 change detected
2025-03-28 16:00:12,425 - INFO - 1 change detected
2025-03-28 16:00:12,831 - INFO - 1 change detected
2025-03-28 16:00:13,189 - INFO - 1 change detected
2025-03-28 16:00:13,596 - INFO - 1 change detected
2025-03-28 16:00:14,005 - INFO - 1 change detected
2025-03-28 16:00:14,411 - INFO - 1 change detected
2025-03-28 16:00:14,770 - INFO - 1 change detected
2025-03-28 16:00:15,182 - INFO - 1 change detected
2025-03-28 16:00:15,592 - INFO - 1 change detected
2025-03-28 16:00:16,000 - INFO - 1 change detected
2025-03-28 16:00:16,405 - INFO - 1 change detected
2025-03-28 16:00:16,810 - INFO - 1 change detected
2025-03-28 16:00:17,219 - INFO - 1 change detected
2025-03-28 16:00:17,576 - INFO - 1 change detected
2025-03-28 16:00:17,988 - INFO - 1 change detected
2025-03-28 16:00:18,394 - INFO - 1 change detected
2025-03-28 16:00:18,802 - INFO - 1 change detected
2025-03-28 16:00:19,206 - INFO - 1 change detected
2025-03-28 16:00:19,279 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:00:19,286 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:00:19,288 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:00:19,291 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:00:19,291 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:00:19,294 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:00:19,304 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:00:19,308 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:00:19,611 - INFO - 1 change detected
2025-03-28 16:00:20,014 - INFO - 1 change detected
2025-03-28 16:00:20,370 - INFO - 1 change detected
2025-03-28 16:00:20,780 - INFO - 1 change detected
2025-03-28 16:00:21,185 - INFO - 1 change detected
2025-03-28 16:00:21,593 - INFO - 1 change detected
2025-03-28 16:00:22,002 - INFO - 1 change detected
2025-03-28 16:00:22,410 - INFO - 1 change detected
2025-03-28 16:00:22,771 - INFO - 1 change detected
2025-03-28 16:00:23,186 - INFO - 1 change detected
2025-03-28 16:00:23,598 - INFO - 1 change detected
2025-03-28 16:00:24,007 - INFO - 1 change detected
2025-03-28 16:00:24,366 - INFO - 1 change detected
2025-03-28 16:00:24,779 - INFO - 1 change detected
2025-03-28 16:00:25,189 - INFO - 1 change detected
2025-03-28 16:00:25,549 - INFO - 1 change detected
2025-03-28 16:00:25,961 - INFO - 1 change detected
2025-03-28 16:00:26,367 - INFO - 1 change detected
2025-03-28 16:00:26,781 - INFO - 1 change detected
2025-03-28 16:00:27,139 - INFO - 1 change detected
2025-03-28 16:00:27,552 - INFO - 1 change detected
2025-03-28 16:00:27,961 - INFO - 1 change detected
2025-03-28 16:00:28,366 - INFO - 1 change detected
2025-03-28 16:00:28,775 - INFO - 1 change detected
2025-03-28 16:00:29,133 - INFO - 1 change detected
2025-03-28 16:00:29,546 - INFO - 1 change detected
2025-03-28 16:00:29,954 - INFO - 1 change detected
2025-03-28 16:00:30,311 - INFO - 1 change detected
2025-03-28 16:00:30,726 - INFO - 1 change detected
2025-03-28 16:00:31,132 - INFO - 1 change detected
2025-03-28 16:00:31,536 - INFO - 1 change detected
2025-03-28 16:00:31,942 - INFO - 1 change detected
2025-03-28 16:00:32,347 - INFO - 1 change detected
2025-03-28 16:00:32,704 - INFO - 1 change detected
2025-03-28 16:00:33,116 - INFO - 1 change detected
2025-03-28 16:00:33,528 - INFO - 1 change detected
2025-03-28 16:00:33,887 - INFO - 1 change detected
2025-03-28 16:00:34,300 - INFO - 1 change detected
2025-03-28 16:00:34,709 - INFO - 1 change detected
2025-03-28 16:00:35,069 - INFO - 1 change detected
2025-03-28 16:00:35,483 - INFO - 1 change detected
2025-03-28 16:00:35,891 - INFO - 1 change detected
2025-03-28 16:00:36,294 - INFO - 1 change detected
2025-03-28 16:00:36,702 - INFO - 1 change detected
2025-03-28 16:00:37,064 - INFO - 1 change detected
2025-03-28 16:00:37,479 - INFO - 1 change detected
2025-03-28 16:00:37,888 - INFO - 1 change detected
2025-03-28 16:00:38,292 - INFO - 1 change detected
2025-03-28 16:00:38,698 - INFO - 1 change detected
2025-03-28 16:00:39,101 - INFO - 1 change detected
2025-03-28 16:00:39,504 - INFO - 1 change detected
2025-03-28 16:00:39,910 - INFO - 1 change detected
2025-03-28 16:00:40,312 - INFO - 1 change detected
2025-03-28 16:00:40,723 - INFO - 1 change detected
2025-03-28 16:00:41,081 - INFO - 1 change detected
2025-03-28 16:00:41,490 - INFO - 1 change detected
2025-03-28 16:00:41,896 - INFO - 1 change detected
2025-03-28 16:00:42,306 - INFO - 1 change detected
2025-03-28 16:00:42,711 - INFO - 1 change detected
2025-03-28 16:00:43,119 - INFO - 1 change detected
2025-03-28 16:00:43,521 - INFO - 1 change detected
2025-03-28 16:00:43,928 - INFO - 1 change detected
2025-03-28 16:00:44,333 - INFO - 1 change detected
2025-03-28 16:00:44,739 - INFO - 1 change detected
2025-03-28 16:00:45,146 - INFO - 1 change detected
2025-03-28 16:00:45,548 - INFO - 1 change detected
2025-03-28 16:00:45,958 - INFO - 1 change detected
2025-03-28 16:00:46,311 - INFO - 1 change detected
2025-03-28 16:00:46,719 - INFO - 1 change detected
2025-03-28 16:00:47,127 - INFO - 1 change detected
2025-03-28 16:00:47,531 - INFO - 1 change detected
2025-03-28 16:00:47,937 - INFO - 1 change detected
2025-03-28 16:00:48,342 - INFO - 1 change detected
2025-03-28 16:00:48,745 - INFO - 1 change detected
2025-03-28 16:00:49,152 - INFO - 1 change detected
2025-03-28 16:00:49,557 - INFO - 1 change detected
2025-03-28 16:00:49,962 - INFO - 1 change detected
2025-03-28 16:00:50,369 - INFO - 1 change detected
2025-03-28 16:00:50,772 - INFO - 1 change detected
2025-03-28 16:00:51,178 - INFO - 1 change detected
2025-03-28 16:00:51,583 - INFO - 1 change detected
2025-03-28 16:00:51,940 - INFO - 1 change detected
2025-03-28 16:00:52,351 - INFO - 1 change detected
2025-03-28 16:00:52,755 - INFO - 1 change detected
2025-03-28 16:00:53,161 - INFO - 1 change detected
2025-03-28 16:00:53,564 - INFO - 1 change detected
2025-03-28 16:00:53,971 - INFO - 1 change detected
2025-03-28 16:00:54,376 - INFO - 1 change detected
2025-03-28 16:00:54,780 - INFO - 1 change detected
2025-03-28 16:00:55,188 - INFO - 1 change detected
2025-03-28 16:00:55,591 - INFO - 1 change detected
2025-03-28 16:00:55,995 - INFO - 1 change detected
2025-03-28 16:00:56,400 - INFO - 1 change detected
2025-03-28 16:00:56,804 - INFO - 1 change detected
2025-03-28 16:00:57,212 - INFO - 1 change detected
2025-03-28 16:00:57,615 - INFO - 1 change detected
2025-03-28 16:00:58,021 - INFO - 1 change detected
2025-03-28 16:00:58,427 - INFO - 1 change detected
2025-03-28 16:00:58,834 - INFO - 1 change detected
2025-03-28 16:00:59,239 - INFO - 1 change detected
2025-03-28 16:00:59,653 - INFO - 1 change detected
2025-03-28 16:01:00,059 - INFO - 1 change detected
2025-03-28 16:01:00,470 - INFO - 1 change detected
2025-03-28 16:01:00,828 - INFO - 1 change detected
2025-03-28 16:01:01,229 - INFO - 1 change detected
2025-03-28 16:01:01,632 - INFO - 1 change detected
2025-03-28 16:01:02,036 - INFO - 1 change detected
2025-03-28 16:01:02,439 - INFO - 1 change detected
2025-03-28 16:01:02,848 - INFO - 1 change detected
2025-03-28 16:01:03,253 - INFO - 1 change detected
2025-03-28 16:01:03,669 - INFO - 1 change detected
2025-03-28 16:01:04,027 - INFO - 1 change detected
2025-03-28 16:01:04,434 - INFO - 1 change detected
2025-03-28 16:01:04,839 - INFO - 1 change detected
2025-03-28 16:01:05,246 - INFO - 1 change detected
2025-03-28 16:01:05,653 - INFO - 1 change detected
2025-03-28 16:01:06,061 - INFO - 1 change detected
2025-03-28 16:01:06,465 - INFO - 1 change detected
2025-03-28 16:01:06,873 - INFO - 1 change detected
2025-03-28 16:01:07,280 - INFO - 1 change detected
2025-03-28 16:01:07,686 - INFO - 1 change detected
2025-03-28 16:01:08,092 - INFO - 1 change detected
2025-03-28 16:01:08,496 - INFO - 1 change detected
2025-03-28 16:01:08,901 - INFO - 1 change detected
2025-03-28 16:01:09,306 - INFO - 1 change detected
2025-03-28 16:01:09,710 - INFO - 1 change detected
2025-03-28 16:01:10,116 - INFO - 1 change detected
2025-03-28 16:01:10,481 - INFO - 1 change detected
2025-03-28 16:01:10,888 - INFO - 1 change detected
2025-03-28 16:01:11,295 - INFO - 1 change detected
2025-03-28 16:01:11,701 - INFO - 1 change detected
2025-03-28 16:01:12,105 - INFO - 1 change detected
2025-03-28 16:01:12,511 - INFO - 1 change detected
2025-03-28 16:01:12,917 - INFO - 1 change detected
2025-03-28 16:01:13,322 - INFO - 1 change detected
2025-03-28 16:01:13,726 - INFO - 1 change detected
2025-03-28 16:01:14,132 - INFO - 1 change detected
2025-03-28 16:01:14,539 - INFO - 1 change detected
2025-03-28 16:01:14,956 - INFO - 1 change detected
2025-03-28 16:01:15,362 - INFO - 1 change detected
2025-03-28 16:01:15,769 - INFO - 1 change detected
2025-03-28 16:01:16,178 - INFO - 1 change detected
2025-03-28 16:01:16,583 - INFO - 1 change detected
2025-03-28 16:01:16,992 - INFO - 1 change detected
2025-03-28 16:01:17,395 - INFO - 1 change detected
2025-03-28 16:01:17,803 - INFO - 1 change detected
2025-03-28 16:01:18,157 - INFO - 1 change detected
2025-03-28 16:01:18,566 - INFO - 1 change detected
2025-03-28 16:01:18,973 - INFO - 1 change detected
2025-03-28 16:01:19,382 - INFO - 1 change detected
2025-03-28 16:01:19,790 - INFO - 1 change detected
2025-03-28 16:01:20,193 - INFO - 1 change detected
2025-03-28 16:01:20,600 - INFO - 1 change detected
2025-03-28 16:01:21,005 - INFO - 1 change detected
2025-03-28 16:01:21,412 - INFO - 1 change detected
2025-03-28 16:01:21,817 - INFO - 1 change detected
2025-03-28 16:01:22,173 - INFO - 1 change detected
2025-03-28 16:01:22,582 - INFO - 1 change detected
2025-03-28 16:01:22,987 - INFO - 1 change detected
2025-03-28 16:01:23,393 - INFO - 1 change detected
2025-03-28 16:01:23,802 - INFO - 1 change detected
2025-03-28 16:01:24,210 - INFO - 1 change detected
2025-03-28 16:01:24,565 - INFO - 1 change detected
2025-03-28 16:01:24,976 - INFO - 1 change detected
2025-03-28 16:01:25,384 - INFO - 1 change detected
2025-03-28 16:01:25,789 - INFO - 1 change detected
2025-03-28 16:01:26,194 - INFO - 1 change detected
2025-03-28 16:01:26,601 - INFO - 1 change detected
2025-03-28 16:01:27,009 - INFO - 1 change detected
2025-03-28 16:01:27,414 - INFO - 1 change detected
2025-03-28 16:01:27,822 - INFO - 1 change detected
2025-03-28 16:01:28,227 - INFO - 1 change detected
2025-03-28 16:01:28,632 - INFO - 1 change detected
2025-03-28 16:01:28,991 - INFO - 1 change detected
2025-03-28 16:01:29,397 - INFO - 1 change detected
2025-03-28 16:01:29,801 - INFO - 1 change detected
2025-03-28 16:01:30,209 - INFO - 1 change detected
2025-03-28 16:01:30,615 - INFO - 1 change detected
2025-03-28 16:01:31,021 - INFO - 1 change detected
2025-03-28 16:01:31,427 - INFO - 1 change detected
2025-03-28 16:01:31,831 - INFO - 1 change detected
2025-03-28 16:01:32,237 - INFO - 1 change detected
2025-03-28 16:01:32,642 - INFO - 1 change detected
2025-03-28 16:01:33,058 - INFO - 1 change detected
2025-03-28 16:01:33,461 - INFO - 1 change detected
2025-03-28 16:01:33,817 - INFO - 1 change detected
2025-03-28 16:01:34,227 - INFO - 1 change detected
2025-03-28 16:01:34,632 - INFO - 1 change detected
2025-03-28 16:01:35,038 - INFO - 1 change detected
2025-03-28 16:01:35,440 - INFO - 1 change detected
2025-03-28 16:01:35,857 - INFO - 1 change detected
2025-03-28 16:01:36,263 - INFO - 1 change detected
2025-03-28 16:01:36,669 - INFO - 1 change detected
2025-03-28 16:01:37,074 - INFO - 1 change detected
2025-03-28 16:01:37,479 - INFO - 1 change detected
2025-03-28 16:01:37,884 - INFO - 1 change detected
2025-03-28 16:01:38,241 - INFO - 1 change detected
2025-03-28 16:01:38,653 - INFO - 1 change detected
2025-03-28 16:01:39,067 - INFO - 1 change detected
2025-03-28 16:01:39,478 - INFO - 1 change detected
2025-03-28 16:01:39,837 - INFO - 1 change detected
2025-03-28 16:01:40,245 - INFO - 1 change detected
2025-03-28 16:01:40,653 - INFO - 1 change detected
2025-03-28 16:01:41,056 - INFO - 1 change detected
2025-03-28 16:01:41,467 - INFO - 1 change detected
2025-03-28 16:01:41,874 - INFO - 1 change detected
2025-03-28 16:01:42,232 - INFO - 1 change detected
2025-03-28 16:01:42,646 - INFO - 1 change detected
2025-03-28 16:01:43,051 - INFO - 1 change detected
2025-03-28 16:01:43,460 - INFO - 1 change detected
2025-03-28 16:01:43,864 - INFO - 1 change detected
2025-03-28 16:01:44,272 - INFO - 1 change detected
2025-03-28 16:01:44,676 - INFO - 1 change detected
2025-03-28 16:01:45,082 - INFO - 1 change detected
2025-03-28 16:01:45,487 - INFO - 1 change detected
2025-03-28 16:01:45,895 - INFO - 1 change detected
2025-03-28 16:01:46,301 - INFO - 1 change detected
2025-03-28 16:01:46,705 - INFO - 1 change detected
2025-03-28 16:01:47,115 - INFO - 1 change detected
2025-03-28 16:01:47,518 - INFO - 1 change detected
2025-03-28 16:01:47,924 - INFO - 1 change detected
2025-03-28 16:01:48,330 - INFO - 1 change detected
2025-03-28 16:01:48,736 - INFO - 1 change detected
2025-03-28 16:01:49,141 - INFO - 1 change detected
2025-03-28 16:01:49,548 - INFO - 1 change detected
2025-03-28 16:01:49,906 - INFO - 1 change detected
2025-03-28 16:01:49,907 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-28 16:01:57,776 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:01:57,780 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:01:57,794 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:01:57,810 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:01:57,815 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:01:57,815 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:01:57,961 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:01:57,971 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:01:57,978 - INFO - Shutting down
2025-03-28 16:01:58,092 - INFO - Waiting for connections to close. (CTRL+C to force quit)
2025-03-28 16:01:58,196 - INFO - Waiting for application shutdown.
2025-03-28 16:01:58,197 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 16:01:58,197 - INFO - Application shutdown complete.
2025-03-28 16:01:58,197 - INFO - Finished server process [6056]
2025-03-28 16:01:58,862 - INFO - 1 change detected
2025-03-28 16:01:59,978 - INFO - 5 changes detected
2025-03-28 16:02:00,108 - INFO - Started server process [24796]
2025-03-28 16:02:00,112 - INFO - Waiting for application startup.
2025-03-28 16:02:00,121 - INFO - Application startup complete.
2025-03-28 16:02:00,849 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:00,933 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:01,002 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:01,017 - INFO - Logged request from IP bro 127.0.0.1 to /auth/users/list
2025-03-28 16:02:01,023 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:01,028 - INFO - Logged request from IP bro 127.0.0.1 to /auth/activity-logs
2025-03-28 16:02:06,882 - INFO - MUSEEEEEEEE2: False
2025-03-28 16:02:06,938 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-28 16:02:06,942 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-28 16:02:06,949 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-28 16:02:07,653 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:07,658 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:07,725 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-28 16:02:07,730 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:02:07,734 - WARNING - CORS check error for https:///api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:02:07,734 - WARNING - Error scanning https:///api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:02:07,756 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:07,762 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/endpoints/health-summary
2025-03-28 16:02:07,777 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:07,834 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:02:09,141 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:09,144 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:09,205 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:02:09,210 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:02:09,214 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:09,214 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:09,379 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:02:09,384 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:02:09,388 - WARNING - CORS check error for https:///api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:02:09,390 - WARNING - Error scanning https:///api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:02:09,391 - WARNING - CORS check error for https:///api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:02:09,391 - WARNING - Error scanning https:///api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:02:22,983 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:22,988 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/endpoints/health-summary
2025-03-28 16:02:23,047 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:02:23,115 - INFO - Logged request from IP bro 127.0.0.1 to /favicon.ico
2025-03-28 16:03:25,284 - INFO - 1 change detected
2025-03-28 16:03:25,285 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-28 16:03:32,354 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:03:32,358 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:03:32,358 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:03:32,654 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:03:32,662 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:03:32,666 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:03:32,680 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:03:32,693 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:03:32,700 - WARNING - CORS check error for https:///api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:03:32,702 - WARNING - Error scanning https:///api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:03:32,705 - WARNING - CORS check error for https:///api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:03:32,705 - WARNING - Error scanning https:///api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:03:32,780 - INFO - Shutting down
2025-03-28 16:03:32,887 - INFO - Waiting for application shutdown.
2025-03-28 16:03:32,888 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 16:03:32,888 - INFO - Application shutdown complete.
2025-03-28 16:03:32,889 - INFO - Finished server process [24796]
2025-03-28 16:03:33,534 - INFO - 1 change detected
2025-03-28 16:03:34,598 - INFO - 5 changes detected
2025-03-28 16:03:34,698 - INFO - Started server process [25460]
2025-03-28 16:03:34,701 - INFO - Waiting for application startup.
2025-03-28 16:03:34,708 - INFO - Application startup complete.
2025-03-28 16:03:34,815 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:03:34,892 - INFO - Logged request from IP bro 127.0.0.1 to /auth/users/list
2025-03-28 16:03:34,900 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:03:34,960 - INFO - Logged request from IP bro 127.0.0.1 to /auth/activity-logs
2025-03-28 16:03:35,745 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:03:35,750 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:03:35,754 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:03:35,765 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:03:35,768 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:03:35,768 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:03:35,932 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:03:35,938 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:03:35,944 - WARNING - CORS check error for /api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:03:35,947 - WARNING - Error scanning /api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:03:35,948 - WARNING - CORS check error for /api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:03:35,948 - WARNING - Error scanning /api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:04:07,217 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:04:07,224 - INFO - Logged request from IP bro 127.0.0.1 to /auth/activity-logs
2025-03-28 16:04:07,287 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:04:07,294 - INFO - Logged request from IP bro 127.0.0.1 to /favicon.ico
2025-03-28 16:04:57,199 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:04:57,367 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:04:57,371 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:04:57,371 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:04:57,371 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:04:57,480 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:04:57,483 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:04:57,487 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:04:57,491 - WARNING - Error scanning /api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:04:57,492 - WARNING - CORS check error for /api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:04:57,542 - WARNING - CORS check error for /api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:04:57,542 - WARNING - Error scanning /api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:06:44,159 - INFO - 1 change detected
2025-03-28 16:06:44,159 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-28 16:06:55,690 - INFO - Shutting down
2025-03-28 16:06:55,797 - INFO - Waiting for application shutdown.
2025-03-28 16:06:55,798 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 16:06:55,798 - INFO - Application shutdown complete.
2025-03-28 16:06:55,799 - INFO - Finished server process [25460]
2025-03-28 16:06:56,398 - INFO - 2 changes detected
2025-03-28 16:06:56,398 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-28 16:06:57,611 - INFO - Started server process [22572]
2025-03-28 16:06:57,613 - INFO - Waiting for application startup.
2025-03-28 16:06:57,622 - INFO - Application startup complete.
2025-03-28 16:06:57,626 - ERROR - Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 700, in lifespan
    await receive()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-03-28 16:06:57,630 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 16:06:58,192 - INFO - 6 changes detected
2025-03-28 16:06:59,460 - INFO - Started server process [20756]
2025-03-28 16:06:59,463 - INFO - Waiting for application startup.
2025-03-28 16:06:59,474 - INFO - Application startup complete.
2025-03-28 16:07:02,140 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:07:02,319 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:07:02,326 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:07:02,326 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:07:02,327 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:07:02,505 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:07:02,513 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:07:02,517 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:07:02,526 - WARNING - CORS check error for /api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:07:02,527 - WARNING - Error scanning /api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:07:02,589 - WARNING - Error scanning /api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:07:02,648 - WARNING - CORS check error for /api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:07:45,439 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:07:45,451 - INFO - Logged request from IP bro 127.0.0.1 to /
2025-03-28 16:07:45,490 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:07:45,502 - INFO - Logged request from IP bro 127.0.0.1 to /favicon.ico
2025-03-28 16:07:55,096 - INFO - 1 change detected
2025-03-28 16:07:55,096 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-28 16:08:02,234 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:08:02,246 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:08:02,251 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:08:02,252 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:08:02,252 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:08:02,405 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:08:02,412 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:08:02,420 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:08:02,432 - WARNING - Error scanning /api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:08:02,434 - WARNING - CORS check error for /api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:08:02,495 - WARNING - CORS check error for /api-management/endpoints/create: Invalid URL 'https:///api-management/endpoints/create': No host supplied
2025-03-28 16:08:02,495 - WARNING - Error scanning /api-management/endpoints/create: Invalid URL "https:///api-management/endpoints/create?input=' OR 1=1 --": No host supplied
2025-03-28 16:08:02,567 - INFO - Shutting down
2025-03-28 16:08:02,668 - INFO - Waiting for application shutdown.
2025-03-28 16:08:02,670 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 16:08:02,670 - INFO - Application shutdown complete.
2025-03-28 16:08:02,671 - INFO - Finished server process [20756]
2025-03-28 16:08:03,296 - INFO - 1 change detected
2025-03-28 16:08:04,408 - INFO - 5 changes detected
2025-03-28 16:08:04,490 - INFO - Started server process [24296]
2025-03-28 16:08:04,492 - INFO - Waiting for application startup.
2025-03-28 16:08:04,500 - INFO - Application startup complete.
2025-03-28 16:08:14,692 - INFO - Shutting down
2025-03-28 16:08:14,802 - INFO - Waiting for application shutdown.
2025-03-28 16:08:14,803 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 16:08:14,803 - INFO - Application shutdown complete.
2025-03-28 16:08:14,803 - INFO - Finished server process [24296]
2025-03-28 16:08:14,980 - INFO - Stopping reloader process [16188]
2025-03-28 16:08:17,721 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-28 16:08:17,723 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-28 16:08:17,723 - INFO - Started reloader process [23104] using WatchFiles
2025-03-28 16:08:19,309 - INFO - Started server process [25308]
2025-03-28 16:08:19,312 - INFO - Waiting for application startup.
2025-03-28 16:08:19,319 - INFO - Application startup complete.
2025-03-28 16:08:38,495 - INFO - 1 change detected
2025-03-28 16:08:38,496 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-28 16:08:41,938 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:08:41,943 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:08:42,169 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:08:42,178 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:08:42,180 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:08:42,180 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:08:42,297 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:08:42,305 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:08:47,381 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:08:47,381 - INFO - Shutting down
2025-03-28 16:08:52,403 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:08:57,429 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:09:02,450 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:09:02,460 - INFO - Finished server process [25308]
2025-03-28 16:09:02,465 - ERROR - Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 700, in lifespan
    await receive()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-03-28 16:09:02,469 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 16:09:02,470 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:09:02,475 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:09:02,477 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:09:02,479 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:09:03,063 - INFO - 1 change detected
2025-03-28 16:09:04,283 - INFO - 5 changes detected
2025-03-28 16:09:04,359 - INFO - Started server process [21976]
2025-03-28 16:09:04,361 - INFO - Waiting for application startup.
2025-03-28 16:09:04,371 - INFO - Application startup complete.
2025-03-28 16:09:04,373 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:04,374 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:04,375 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:04,376 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:04,381 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:04,381 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:04,381 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:04,382 - INFO - MUSEEEEEEEE2: False
2025-03-28 16:09:04,382 - INFO - MUSEEEEEEEE2: False
2025-03-28 16:09:04,382 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:04,382 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:04,382 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:04,832 - INFO - Logged request from IP bro 127.0.0.1 to /auth/activity-logs
2025-03-28 16:09:04,839 - INFO - Logged request from IP bro 127.0.0.1 to /auth/users/list
2025-03-28 16:09:04,844 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:09:04,847 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-28 16:09:04,851 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-28 16:09:04,855 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:09:04,859 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:09:04,863 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:09:09,957 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:09:15,037 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:09:20,130 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:09:25,135 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:09:25,206 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:25,207 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:25,207 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:25,208 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:25,208 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:25,209 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:25,210 - INFO - Request body received: b'username=fizril&password=fizril2001%5C'
2025-03-28 16:09:25,210 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-28 16:09:25,211 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:25,212 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:25,239 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-28 16:09:25,677 - WARNING - Failed login attempt detected from IP: 127.0.0.1
2025-03-28 16:09:26,285 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:26,287 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:26,292 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-28 16:09:26,299 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:09:31,329 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:09:36,341 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:09:36,346 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:36,347 - WARNING - Invalid HTTP request received.
2025-03-28 16:09:36,360 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:36,364 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/endpoints/health-summary
2025-03-28 16:09:36,375 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:36,379 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:09:37,934 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:37,989 - INFO - Logged request from IP bro 127.0.0.1 to /api-management/endpoints/create
2025-03-28 16:09:38,016 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:09:38,074 - INFO - Logged request from IP bro 127.0.0.1 to /favicon.ico
2025-03-28 16:09:50,114 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:10:20,133 - INFO - Shutting down
2025-03-28 16:10:50,137 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 16:10:50,138 - INFO - Waiting for connections to close. (CTRL+C to force quit)
2025-03-28 16:10:50,139 - INFO - MUSEEEEEEEE2: False
2025-03-28 16:10:50,139 - INFO - MUSEEEEEEEE2: False
2025-03-28 16:10:50,139 - INFO - MUSEEEEEEEE2: False
2025-03-28 16:11:20,149 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-28 16:11:20,153 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-28 16:11:20,155 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 289, in dispatch
    |     traffic_log_request(client_ip, request, db)
    |     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    |     db.commit()
    |     ~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    |     trans.commit(_to_root=True)
    |     ~~~~~~~~~~~~^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in commit
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    |     self._prepare_impl()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "<string>", line 2, in _prepare_impl
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    |     self.session.flush()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    |     self._flush(objects)
    |     ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    |     with util.safe_reraise():
    |          ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    |     raise exc_value.with_traceback(exc_tb)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    |     flush_context.execute()
    |     ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    |     rec.execute(self)
    |     ~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    |     util.preloaded.orm_persistence.save_obj(
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         self.mapper,
    |         ^^^^^^^^^^^^
    |         uow.states_for_mapper_hierarchy(self.mapper, False, False),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         uow,
    |         ^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    |     ) in _organize_states_for_save(base_mapper, states, uowtransaction):
    |          ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    |     for state, dict_, mapper, connection in _connections_for_states(
    |                                             ~~~~~~~~~~~~~~~~~~~~~~~^
    |         base_mapper, uowtransaction, states
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ):
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    |     connection = uowtransaction.transaction.connection(base_mapper)
    |   File "<string>", line 2, in connection
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    |     return self._connection_for_bind(bind, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    |     conn = self._parent._connection_for_bind(
    |         bind, execution_options
    |     )
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 289, in check_endpoint_status
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 150, in log_requests
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 289, in dispatch
    traffic_log_request(client_ip, request, db)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\security.py", line 136, in traffic_log_request
    db.commit()
    ~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 68, in save_obj
    ) in _organize_states_for_save(base_mapper, states, uowtransaction):
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 223, in _organize_states_for_save
    for state, dict_, mapper, connection in _connections_for_states(
                                            ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper, uowtransaction, states
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1753, in _connections_for_states
    connection = uowtransaction.transaction.connection(base_mapper)
  File "<string>", line 2, in connection
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1039, in connection
    return self._connection_for_bind(bind, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1175, in _connection_for_bind
    conn = self._parent._connection_for_bind(
        bind, execution_options
    )
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 16:11:20,186 - ERROR - Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     )
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |         self.scope, self.receive, self.send
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    |     with collapse_excgroups():
    |          ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    |     return await check_endpoint_status(request, call_next)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    |     ).first()
    |       ~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    |     return self.limit(1)._iter().first()  # type: ignore
    |            ~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    |     result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
    |                                                   ~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |         params,
    |         ^^^^^^^
    |         execution_options={"_sa_orm_load_options": self.load_options},
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    |     return self._execute_internal(
    |            ~~~~~~~~~~~~~~~~~~~~~~^
    |         statement,
    |         ^^^^^^^^^^
    |     ...<4 lines>...
    |         _add_event=_add_event,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    |     conn = self._connection_for_bind(bind)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    |     return trans._connection_for_bind(engine, execution_options)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "<string>", line 2, in _connection_for_bind
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    |     ret_value = fn(self, *arg, **kw)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    |     conn = bind.connect()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    |     return self._connection_cls(self)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    |     self._dbapi_connection = engine.raw_connection()
    |                              ~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    |     return self.pool.connect()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    |     return _ConnectionFairy._checkout(self)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    |     fairy = _ConnectionRecord.checkout(pool)
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    |     rec = pool._do_get()
    |   File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    |     raise exc.TimeoutError(
    |     ...<4 lines>...
    |     )
    | sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 187, in __call__
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 185, in __call__
    with collapse_excgroups():
         ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 181, in block_down_endpoints
    return await check_endpoint_status(request, call_next)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\auth.py", line 284, in check_endpoint_status
    ).first()
      ~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2237, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 2106, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\engine\base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\sqlalchemy\pool\impl.py", line 168, in _do_get
    raise exc.TimeoutError(
    ...<4 lines>...
    )
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 16:11:20,194 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-28 16:11:20,194 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-28 16:11:22,278 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:11:22,281 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:12:52,306 - ERROR - Error during monitoring: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-03-28 16:12:52,307 - INFO - Finished server process [21976]
2025-03-28 16:12:52,311 - ERROR - Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 700, in lifespan
    await receive()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-03-28 16:12:52,316 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 16:12:52,316 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:12:52,319 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:12:52,514 - INFO - Stopping reloader process [23104]
2025-03-28 16:13:01,103 - INFO - Will watch for changes in these directories: ['C:\\Users\\user\\Desktop\\FYP Proto6\\venv-fastapi']
2025-03-28 16:13:01,105 - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-03-28 16:13:01,105 - INFO - Started reloader process [26524] using WatchFiles
2025-03-28 16:13:02,641 - INFO - Started server process [25252]
2025-03-28 16:13:02,644 - INFO - Waiting for application startup.
2025-03-28 16:13:02,655 - INFO - Application startup complete.
2025-03-28 16:13:05,955 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:05,955 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:06,084 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:13:06,094 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-28 16:13:11,107 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:13:16,132 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:13:16,140 - WARNING - Invalid HTTP request received.
2025-03-28 16:13:16,156 - WARNING - Invalid HTTP request received.
2025-03-28 16:13:16,157 - INFO - MUSEEEEEEEE2: False
2025-03-28 16:13:16,157 - INFO - MUSEEEEEEEE2: False
2025-03-28 16:13:16,157 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:16,158 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:16,494 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-28 16:13:16,499 - INFO - Logged request from IP bro 127.0.0.1 to /auth/token
2025-03-28 16:13:16,513 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-28 16:13:16,514 - INFO - Request body received: b'username=fizril&password=fizril2001'
2025-03-28 16:13:16,521 - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-03-28 16:13:17,344 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:17,347 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:17,406 - INFO - Logged request from IP bro 127.0.0.1 to /analytics/overview-metrics
2025-03-28 16:13:17,411 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:13:22,436 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:13:27,462 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:13:27,489 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:27,490 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:27,493 - WARNING - Invalid HTTP request received.
2025-03-28 16:13:27,494 - WARNING - Invalid HTTP request received.
2025-03-28 16:13:27,524 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:13:27,533 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:13:27,535 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:27,536 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:27,541 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:13:27,545 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:13:32,582 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:13:37,665 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:13:42,694 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:13:46,562 - INFO - 1 change detected
2025-03-28 16:13:46,563 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-28 16:13:47,715 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:13:47,716 - WARNING - Invalid HTTP request received.
2025-03-28 16:13:47,718 - INFO - Shutting down
2025-03-28 16:13:47,721 - WARNING - Invalid HTTP request received.
2025-03-28 16:13:47,721 - WARNING - Invalid HTTP request received.
2025-03-28 16:13:47,722 - WARNING - Invalid HTTP request received.
2025-03-28 16:13:47,723 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:47,723 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:47,723 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:47,723 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:13:47,837 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:13:47,842 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:13:47,845 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:13:47,848 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:13:47,853 - INFO - Waiting for connections to close. (CTRL+C to force quit)
2025-03-28 16:13:52,877 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:13:57,955 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:14:02,979 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:14:08,122 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:14:08,126 - INFO - Finished server process [25252]
2025-03-28 16:14:08,127 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 16:14:08,131 - ERROR - Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 700, in lifespan
    await receive()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-03-28 16:14:08,137 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    ~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 793, in __aexit__
    await _wait(self._tasks)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 758, in _wait
    await waiter
asyncio.exceptions.CancelledError
2025-03-28 16:14:08,142 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 188, in __call__
    await response(scope, wrapped_receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 222, in __call__
    async for chunk in self.body_iterator:
        await send({"type": "http.response.body", "body": chunk, "more_body": True})
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 170, in body_stream
    async for message in recv_stream:
    ...<5 lines>...
            break
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\abc\_streams.py", line 35, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:14:08,157 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 188, in __call__
    await response(scope, wrapped_receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 222, in __call__
    async for chunk in self.body_iterator:
        await send({"type": "http.response.body", "body": chunk, "more_body": True})
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 170, in body_stream
    async for message in recv_stream:
    ...<5 lines>...
            break
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\abc\_streams.py", line 35, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:14:08,159 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 188, in __call__
    await response(scope, wrapped_receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 222, in __call__
    async for chunk in self.body_iterator:
        await send({"type": "http.response.body", "body": chunk, "more_body": True})
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 170, in body_stream
    async for message in recv_stream:
    ...<5 lines>...
            break
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\abc\_streams.py", line 35, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 109, in receive
    await checkpoint()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\lowlevel.py", line 27, in checkpoint
    await get_async_backend().checkpoint()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2363, in checkpoint
    await sleep(0)
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\tasks.py", line 706, in sleep
    await __sleep0()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\tasks.py", line 700, in __sleep0
    yield
asyncio.exceptions.CancelledError
2025-03-28 16:14:08,184 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 188, in __call__
    await response(scope, wrapped_receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 222, in __call__
    async for chunk in self.body_iterator:
        await send({"type": "http.response.body", "body": chunk, "more_body": True})
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 170, in body_stream
    async for message in recv_stream:
    ...<5 lines>...
            break
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\abc\_streams.py", line 35, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 109, in receive
    await checkpoint()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\lowlevel.py", line 27, in checkpoint
    await get_async_backend().checkpoint()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 2363, in checkpoint
    await sleep(0)
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\tasks.py", line 706, in sleep
    await __sleep0()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\tasks.py", line 700, in __sleep0
    yield
asyncio.exceptions.CancelledError
2025-03-28 16:14:08,187 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:14:08,189 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:14:08,191 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:14:08,193 - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\protocols\http\httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 186, in __call__
    async with anyio.create_task_group() as task_group:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 819, in __aexit__
    raise exc_val
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\main.py", line 209, in detect_malicious_payload
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\streams\memory.py", line 119, in receive
    await receive_event.wait()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\anyio\_backends\_asyncio.py", line 1809, in wait
    await self._event.wait()
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
2025-03-28 16:14:08,773 - INFO - 2 changes detected
2025-03-28 16:14:08,774 - WARNING - WatchFiles detected changes in 'security.py'. Reloading...
2025-03-28 16:14:09,859 - INFO - Started server process [11528]
2025-03-28 16:14:09,862 - INFO - Waiting for application startup.
2025-03-28 16:14:09,870 - INFO - Application startup complete.
2025-03-28 16:14:09,875 - ERROR - Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\starlette\routing.py", line 700, in lifespan
    await receive()
  File "C:\Users\user\Desktop\FYP Proto6\venv-fastapi\Lib\site-packages\uvicorn\lifespan\on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\asyncio\queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-03-28 16:14:09,878 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 16:14:10,452 - INFO - 6 changes detected
2025-03-28 16:14:11,475 - INFO - Started server process [5164]
2025-03-28 16:14:11,477 - INFO - Waiting for application startup.
2025-03-28 16:14:11,485 - INFO - Application startup complete.
2025-03-28 16:14:16,643 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:14:16,648 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:14:16,902 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/open-endpoints
2025-03-28 16:14:16,915 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/cors
2025-03-28 16:14:16,919 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:14:16,919 - WARNING - Failed to process payload: 'NoneType' object has no attribute 'items'
2025-03-28 16:14:17,048 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/sql-injection
2025-03-28 16:14:17,055 - INFO - Logged request from IP bro 127.0.0.1 to /security/vulnerability-scan/comprehensive
2025-03-28 16:14:22,138 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:14:22,138 - INFO - Shutting down
2025-03-28 16:14:27,175 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:14:32,198 - WARNING - CORS check error for /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:14:37,221 - WARNING - Error scanning /api-management/endpoints/create: HTTPSConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=5)
2025-03-28 16:14:37,228 - INFO - Waiting for connections to close. (CTRL+C to force quit)
2025-03-28 16:14:37,331 - INFO - Waiting for application shutdown.
2025-03-28 16:14:37,332 - INFO - Monitoring task cancelled. Exiting...
2025-03-28 16:14:37,332 - INFO - Application shutdown complete.
2025-03-28 16:14:37,332 - INFO - Finished server process [5164]
2025-03-28 16:14:37,550 - INFO - Stopping reloader process [26524]
